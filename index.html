<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Performance Evaluation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
        integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* General styles - REVERTED to original formatting */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            font-size: 10px; /* Original Base font size */
            overflow: auto;
            height: 100vh;
        }
        h1, h2, h3 { color: #343a40; text-align: center; }
        a { color: #007bff; text-decoration: none; }
        a:hover { text-decoration: underline; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; } /* Original padding */
        th { background-color: #f2f2f2; font-weight: bold; }
        .button { background-color: #007bff; color: white; padding: 10px 16px; border: none; border-radius: 5px; cursor: pointer; }
        .button:hover { background-color: #0056b3; }
        input[type="text"], input[type="email"], input[type="date"], input[type="password"], textarea, select { width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ced4da; border-radius: 4px; box-sizing: border-box; font-size: 12px; } /* Original padding & font-size */
        textarea { resize: vertical; }
        .container { width: 85%; max-width: 1200px; margin: 30px auto; background-color: white; padding: 25px; border-radius: 12px; box-shadow: 0 0 20px rgba(0, 0, 0, 0.1); }
        /* Welcome Page Styles - Original formatting */
        #welcome-page { position: relative; width: 100%; height: 100vh; background: linear-gradient(to bottom, #B0C4DE, #778899); overflow: hidden; }
        #login-container { background-color: rgba(255, 255, 255, 0.9); padding: 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); width: 350px; text-align: center; margin: 0 auto; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10; }
        .login-logo { margin-bottom: 20px; } .login-logo img { max-width: 350px; height: auto; }
        .login-input-group { margin-bottom: 20px; text-align: left; } .login-input-group label { display: block; margin-bottom: 6px; font-weight: bold; color: #495057; font-size: 15px; padding: 7px; }
        .login-input-group input[type="text"], .login-input-group input[type="password"] { width: calc(100% - 16px); padding: 10px; border: 1px solid #ced4da; border-radius: 4px; box-sizing: border-box; font-size: 14px; transition: border-color 0.2s ease-in-out; }
        .login-input-group input[type="text"]:focus, .login-input-group input[type="password"]:focus { border-color: #80bdff; outline: 0; box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25); }
        .login-button { background-color: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; width: 100%; transition: background-color 0.3s ease; }
        .login-button:hover { background-color: #0056b3; }
        #login-message { margin-top: 15px; font-size: 14px; color: red; } #login-message.success { color: green; }
        .welcome-container { background-color: rgba(255, 255, 255, 0.6); padding: 30px; border-radius: 15px; text-align: center; position: absolute; z-index: 1; box-shadow: 0 8px 18px rgba(0, 0, 0, 0.35); display: flex; flex-direction: column; align-items: center; justify-content: center; height: auto; border: 1px solid rgba(255, 255, 255, 0.4); top: 50%; left: 50%; transform: translate(-50%, -50%); display: none; }
        .welcome-message { font-size: 2.5em; margin-bottom: 20px; color: #545F66; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.15); }
        .proceed-button { padding: 15px 30px; background-color: #52D197; color: white; border: none; border-radius: 12px; cursor: pointer; text-decoration: none; font-size: 1.2em; transition: background-color 0.3s ease; }
        .proceed-button:hover { background-color: #3CB371; } .proceed-button a { color: white; text-decoration: none; }
        #welcome-page::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url(Background.jpeg); opacity: 0.8; z-index: 0; }
        .background-panel { position: absolute; width: 60%; height: 60%; overflow: hidden; transform-origin: top left; opacity: 0.8; border: 2px solid white; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); display: block; z-index: 1; }
        .background-panel img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease; }
        .background-panel:hover img { transform: scale(1.1); }
        #panel1 { top: -10%; left: -15%; width: 70%; height: 60%; transform: rotate(-8deg); } #panel2 { top: -5%; right: -20%; width: 60%; height: 50%; transform: rotate(6deg); }
        #panel3 { bottom: -15%; left: -15%; width: 55%; height: 55%; transform: rotate(5deg); } #panel4 { bottom: -10%; right: -25%; width: 55%; height: 55%; transform: rotate(-5deg); }

        /* Evaluation Form Container Styles - Changed ID */
        #evaluation-form-container { width: 794px; margin: 20px auto; background-color: white; padding: 5px; border: 3px solid black; box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2); box-sizing: border-box; display: none; outline: 2px solid #007bff; }
        .ac-header-container { display: flex; justify-content: space-between; align-items: center; border: 5px solid black; padding: 3px; background-color: #004085; color: white; font-weight: bold; text-align: center; }
        /* Changed ID */
        #form-header-title { font-size: 16px; flex-grow: 1; text-align: center; color: white; }
        .ac-review-date { font-size: 12px; padding: 5px 10px; border: 2px solid white; border-radius: 5px; text-align: center; }
        .ac-section-header { font-size: 11px; font-weight: bold; padding: 3px; margin-top: 1px; margin-bottom: 1px; background-color: #d98e4f; color: white; border: 2px solid black; text-align: center; }
        .ac-table { width: 100%; border-collapse: collapse; margin-bottom: 1px; }
        .ac-table, .ac-table th, .ac-table td { border: 1px solid black; padding: 3px; font-size: 10px; }
        .ac-table th { background-color: #004085; color: white; font-weight: bold; text-align: left; padding: 4px; }
        .ac-table td { vertical-align: middle; word-break: break-word; position: relative; }
        /* Employee Detail Table Column Widths */
        .ac-table:first-of-type { table-layout: fixed; width: 100%; }
        .ac-table:first-of-type td:nth-child(1), .ac-table:first-of-type td:nth-child(3) { width: 18%; font-weight: bold; color: #004085; padding-right: 5px; vertical-align: middle; }
        .ac-table:first-of-type td:nth-child(2), .ac-table:first-of-type td:nth-child(4) { width: 32%; vertical-align: middle; }
        /* Adjusted input width calculation */
        .ac-table:first-of-type td:nth-child(2) input[type="text"],
        .ac-table:first-of-type td:nth-child(2) input[type="email"],
        .ac-table:first-of-type td:nth-child(4) input[type="text"],
        .ac-table:first-of-type td:nth-child(4) input[type="email"] {
             width: calc(100% - 10px);
             box-sizing: border-box;
             margin-bottom: 0;
             padding: 5px;
             font-size: 10px;
             border: 1px solid black;
        }
        .ac-table select, .ac-table textarea { width: calc(100% - 8px); padding: 6px; border: 1px solid black; border-radius: 5px; box-sizing: border-box; margin-bottom: 0; }
        .ac-table:first-of-type { font-size: 10px; }

        /* --- Rating Box Border & Highlight --- */
        .metric-rating-box {
            border: 1px solid #c200ff; /* Default purple border */
            padding: 5px; margin: 5px 0; width: 100%; border-radius: 5px; box-sizing: border-box; margin-bottom: 10px;
        }
        input.highlighted, select.highlighted, textarea.highlighted,
        .metric-rating-box.highlighted /* Highlight the container */
        {
            border-color: red !important; /* Highlight border */
            box-shadow: 0 0 5px red;
        }
        /* --- End Rating Box --- */

        .ac-review-date.highlighted { border: 2px solid red !important; box-shadow: 0 0 5px red; }
        input:required:invalid, textarea:required:invalid, input[type="date"]:required:invalid { box-shadow: none; border-color: #ccc; }
        input:required, textarea:required, input[type="date"]:required { border: 1px solid #ccc; padding: 8px; }
        .ac-metric-title { background-color: #ffa700; color: white; padding: 2px; font-weight: bold; margin-top: 1px; border-radius: 1px; border: 2px solid black; font-size: 12px; }
        label { font-weight: bold; color: #004085; } .ac-bold-text { font-weight: bold; }
        .ac-download-button { background-color: #4CAF50; border: none; color: white; padding: 12px 24px; text-align: center; text-decoration: none; display: inline-block; font-size: 14px; margin: 15px auto; cursor: pointer; border-radius: 5px; display: block; }
        .ac-comments-container { display: flex; justify-content: space-evenly; } .ac-comments-container div { width: 48%; }
        .placeholder-input::placeholder { color: #999; } .placeholder-input { width: calc(100% - 12px); padding: 6px; margin-bottom: 7px; box-sizing: content-box; height: 30px; }
        .approval-signature-table { width: 100%; table-layout: fixed; border-collapse: collapse; margin-bottom: 10px; }
        .approval-signature-table th, .approval-signature-table td { border: 1px solid black; padding: 8px; text-align: center; box-sizing: border-box; vertical-align: top; word-break: break-word; position: relative; }
        .approval-signature-table .placeholder-input { width: calc(100% - 16px); margin: 0 auto; text-align: center; padding: 8px; box-sizing: border-box; border: 1px solid #ccc; font-size: 11px; height: auto; white-space: normal; margin-bottom: 6px; }
        .approval-signature-table th { background-color: darksalmon; font-weight: bold; font-size: 10px; }
        .approval-signature-table td { font-size: 10px; }
        .performance-feedback>div { margin-bottom: 1px; }
        .ac-review-date input[type="date"] { display: block; margin: 5px auto 0; border: 1px solid #ced4da; padding: 8px; box-sizing: border-box; }
        #suggestions, .suggestions { display: none !important; /* Hide suggestion boxes */ }

        /* --- Rating Option Layout --- */
        .rating-container { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .rating-scale { display: flex; justify-content: space-around; align-items: center; font-size: 10px; }
        .rating-option {
            display: flex;
            flex-direction: row; /* SIDE-BY-SIDE */
            align-items: center; /* Vertically align items */
            justify-content: center;
            cursor: pointer; box-sizing: border-box; padding: 5px; border-radius: 5px; transition: background-color 0.2s, color 0.2s; width: auto; white-space: nowrap; margin: 0 2px;
        }
        .rating-option:hover { background-color: #f0f0f0; }
        .rating-option.selected { background-color: #ffc107; color: black; font-weight: bold; }
        .rating-number {
            width: 24px; height: 24px; border: 1px solid #999; border-radius: 4px; display: flex; align-items: center; justify-content: center;
            margin-right: 5px; /* Space between number and text */
        }
        input[type="radio"] { display: none; }
        /* --- End Rating Option Layout --- */

        .required-field::after { content: " *"; color: red; }
        .suggestion-item { padding: 5px 8px; cursor: pointer; white-space: nowrap; font-size: 11px; }
        .suggestion-item:hover { background-color: #f0f0f0; }
        .ac-table:first-of-type td { padding: 3px; }
        .approval-signature-table td { padding: 8px; }
        .approval-signature-table .placeholder-input { width: calc(100% - 16px); margin-bottom: 6px; padding: 8px;}
        .rating-container label.rating-option { font-size: 10px; color: #555; }
        .rating-container label.rating-option:has(input[type="radio"]:checked) { color: #007bff; font-weight: bold; }
        .rating-container label.rating-option.selected { background-color: #ffc107; color: black; }
        .ac-comments-container div label { font-weight: bold; color: #004085; display: block; margin-bottom: 5px; }
        .ac-comments-container textarea { width: calc(100% - 16px); padding: 8px; margin-bottom: 7px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; resize: vertical; }
        /* Evaluation Page Grid Styles */
        #evaluation-page { background: linear-gradient(to bottom, #f0f4f8, #e8ecf1); padding: 30px 0; display:none; } /* Initially hidden */
        #evaluation-page .container { width: 90%; max-width: 1200px; margin: 30px auto; background-color: rgba(255, 255, 255, 0.9); padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); position: relative; overflow: hidden; }
        #evaluation-page .container::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url("data:image/svg+xml,%3Csvg width='42' height='48' viewBox='0 0 42 48' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23e0e5ea' fill-opacity='0.4' fill-rule='evenodd'%3E%3Cpath d='M12 12h18v12h-18z'/%3E%3C/g%3E%3C/svg%3E"); opacity: 0.5; z-index: -1; }
        #evaluation-page h1 { color: #333; text-align: center; margin-bottom: 30px; font-size: 2.5em; }
        .position-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; padding: 20px; }
        .position-card { display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: #fff; border-radius: 8px; padding: 15px; text-align: center; text-decoration: none; color: #343a40; transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08); min-height: 100px; border: 1px solid #ced4da; font-weight: 500; font-size: 14px; }
        .position-card:hover { transform: translateY(-2px); box-shadow: 0 3px 7px rgba(0, 0, 0, 0.12); background-color: #f8f9fa; }
        .position-icon { font-size: 24px; margin-bottom: 8px; color: #6c757d; }

        /* Generic Evaluation Form Container */
         #evaluation-form-container { display: none; } /* Initially hidden */

    </style>
</head>

<body>

    <!-- WELCOME PAGE HTML -->
    <div id="welcome-page">
         <div id="login-container">
             <div class="login-logo"><img src="logo.png" alt="Al Tasnim Group Logo"></div>
             <div class="login-input-group"><label for="username">User Name</label><input type="text" id="username" name="username" required></div>
             <!-- Password input now has event listener added via JS -->
             <div class="login-input-group"><label for="password">Password</label><input type="password" id="password" name="password" required></div>
             <button type="button" class="login-button" onclick="authenticateUser()">Login</button>
             <div id="login-message"></div>
         </div>
         <div class="background-panel" id="panel1"><img src="Pannel1.jpg" alt="Construction Machinery"></div>
         <div class="background-panel" id="panel2"><img src="Pannel2.jpg" alt="Construction Workers"></div>
         <div class="background-panel" id="panel3"><img src="Pannel3.jpeg" alt="Worker Welding"></div>
         <div class="background-panel" id="panel4"><img src="https://images.unsplash.com/photo-1591639831738-c48204e0933c?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8MHx8fGVuffA%3D%3D" alt="Blueprints"></div>
         <div id="welcome-message-container" class="welcome-container" style="display:none;">
             <h1 class="welcome-message">Welcome to Employee Performance Evaluation!</h1><a href="#" class="proceed-button" onclick="showEvaluationPage()">Proceed to Evaluation</a>
         </div>
    </div>

    <!-- EVALUATION PAGE HTML -->
     <div id="evaluation-page">
         <div class="container">
             <h1>Employee Performance Evaluation</h1>
             <div class="position-grid">
                 <!-- UPDATED onclick handlers -->
                 <a href="#" onclick="showEvaluationFormByType('AC Technician'); return false;" class="position-card"><i class="fas fa-wrench position-icon"></i>AC Technician</a>
                 <a href="#" onclick="showEvaluationFormByType('Dispatch Officer'); return false;" class="position-card"><i class="fas fa-headset position-icon"></i>Dispatch Officer</a>
                 <a href="#" onclick="showEvaluationFormByType('Electrical Engineer'); return false;" class="position-card"><i class="fas fa-bolt position-icon"></i>Electrical Engineer</a>
                 <a href="#" onclick="showEvaluationFormByType('Electrician Industrial'); return false;" class="position-card"><i class="fas fa-industry position-icon"></i>Electrician Industrial</a>
                 <a href="#" onclick="showEvaluationFormByType('HSE Advisor'); return false;" class="position-card"><i class="fas fa-shield-alt position-icon"></i>HSE Advisor</a>
                 <a href="#" onclick="showEvaluationFormByType('IT Support Executive'); return false;" class="position-card"><i class="fas fa-desktop position-icon"></i>IT Support Executive</a>
                 <a href="#" onclick="showEvaluationFormByType('Permit Applicant'); return false;" class="position-card"><i class="fas fa-file-alt position-icon"></i>Permit Applicant</a>
                 <a href="#" onclick="showEvaluationFormByType('Permit Holder'); return false;" class="position-card"><i class="fas fa-check-circle position-icon"></i>Permit Holder</a>
                 <a href="#" onclick="showEvaluationFormByType('Pipe Fitter'); return false;" class="position-card"><i class="fas fa-tools position-icon"></i>Pipe Fitter</a>
                 <a href="#" onclick="showEvaluationFormByType('Quality Control'); return false;" class="position-card"><i class="fas fa-check position-icon"></i>Quality Control</a>
                 <a href="#" onclick="showEvaluationFormByType('Quantity Surveyor'); return false;" class="position-card"><i class="fas fa-calculator position-icon"></i>Quantity Surveyor</a>
                 <a href="#" onclick="showEvaluationFormByType('Site Engineer - Electrical'); return false;" class="position-card"><i class="fas fa-plug position-icon"></i>Site Engineer - Electrical</a>
                 <a href="#" onclick="showEvaluationFormByType('Site Engineer'); return false;" class="position-card"><i class="fas fa-hard-hat position-icon"></i>Site Engineer</a>
                 <a href="#" onclick="showEvaluationFormByType('Stores Engineer - General'); return false;" class="position-card"><i class="fas fa-warehouse position-icon"></i>Stores Engineer - General</a>
                 <a href="#" onclick="showEvaluationFormByType('Supervisor - Security'); return false;" class="position-card"><i class="fas fa-user-shield position-icon"></i>Supervisor - Security</a>
             </div>
              <button onclick="showWelcomeMessageFromEval()" style="display: block; margin: 20px auto; padding: 10px 20px; background-color: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">Back to Welcome</button>
         </div>
     </div>

    <!-- GENERIC Evaluation Form Container -->
    <div id="evaluation-form-container" class="ac-technician-container"> <!-- Keep original styling class -->
        <div id="form-container">
            <div class="ac-header-container">
                <!-- Title will be set by JS -->
                <h2 id="form-header-title" class="ac-header-title">EMPLOYEE PERFORMANCE EVALUATION FORM</h2>
                <div class="ac-review-date required-field">Review Date: <input type="date" id="review-date-header" class="required" /></div>
            </div>
            <div class="ac-section-header" id="personal-details">EMPLOYEE DETAILS</div>
            <table class="ac-table">
                <tr>
                    <td class="ac-bold-text required-field">Employee No</td><td><input type="text" id="emp-number" class="required" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '');"/><div id="suggestions" class="suggestions"></div></td>
                    <td class="ac-bold-text required-field">Employee Name</td><td><input type="text" id="emp-name" class="required" readonly /></td>
                </tr>
                <tr>
                    <td class="ac-bold-text">Position</td><td><input type="text" id="position-text" readonly /></td>
                    <td class="ac-bold-text">Employee Group</td><td><input type="text" id="emp-group" readonly /></td>
                </tr>
                <tr>
                    <td class="ac-bold-text">Division</td><td><input type="text" id="division-text" readonly /></td>
                    <td class="ac-bold-text">Department</td><td><input type="text" id="department-text" readonly /></td>
                </tr>
                <tr>
                    <td class="ac-bold-text required-field">Email ID</td><td><input type="text" id="email" class="required" maxlength="40" /></td>
                    <td class="ac-bold-text required-field">Contact No</td><td><input type="text" id="contact" class="required" maxlength="8" oninput="this.value = this.value.replace(/[^0-9NA]/g, '').toUpperCase();" /></td>
                </tr>
                <tr>
                    <td class="ac-bold-text required-field">Reviewer ID</td>
                    <td><input type="text" id="reviewer-number" class="required" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '');"/><div id="suggestions-reviewer" class="suggestions"></div></td>
                    <td class="ac-bold-text required-field">Reviewer Name</td><td><input type="text" id="reviewer-name" class="required" readonly /></td>
                </tr>
            </table>
            <div class="ac-section-header" id="performance-metrics-header">PERFORMANCE METRICS</div>
            <div id="performance-metrics"><!-- Metrics generated by JS --></div>
            <div class="ac-section-header" id="overall-performance-header">OVERALL PERFORMANCE</div>
            <p id="overall-performance">Please rate all metrics.</p>
            <div class="ac-section-header required-field">OVERALL REMARKS</div>
            <textarea rows="4" id="remarks" class="required"></textarea>
            <div class="ac-section-header">APPROVAL SIGNATURES</div>
            <table class="approval-signature-table">
                <thead><tr><th>EMPLOYEE</th><th>FIRST WITNESS</th><th>SECOND WITNESS</th></tr></thead>
                <tbody><tr>
                    <td><input type="text" id="employee-number-signature" placeholder="EMPLOYEE NUMBER" class="placeholder-input" readonly /><input type="text" id="employee-name-signature" placeholder="EMPLOYEE NAME" class="placeholder-input" readonly /><input type="text" id="position-signature" placeholder="POSITION / DESIGNATION" class="placeholder-input" readonly /><input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" /></td>
                    <td><input type="text" id="employee-number-2" placeholder="EMPLOYEE NUMBER" class="placeholder-input" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '');"/><div id="suggestions-2" class="suggestions"></div><input type="text" id="employee-name-2" placeholder="EMPLOYEE NAME" class="placeholder-input" readonly /><input type="text" id="position-2" placeholder="POSITION / DESIGNATION" class="placeholder-input" readonly /><input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" /></td>
                    <td><input type="text" id="employee-number-3" placeholder="EMPLOYEE NUMBER" class="placeholder-input" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '');"/><div id="suggestions-3" class="suggestions"></div><input type="text" id="employee-name-3" placeholder="EMPLOYEE NAME" class="placeholder-input" readonly /><input type="text" id="position-3" placeholder="POSITION / DESIGNATION" class="placeholder-input" readonly /><input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" /></td>
                </tr></tbody>
            </table>
            <table class="approval-signature-table">
                <thead><tr><th>REVIEWER</th><th>HOD</th></tr></thead>
                <tbody><tr>
                    <td><input type="text" id="reviewer-number-signature" placeholder="EMPLOYEE NUMBER" class="placeholder-input" readonly /><input type="text" id="reviewer-name-signature" placeholder="EMPLOYEE NAME" class="placeholder-input" readonly /><input type="text" id="reviewer-position-signature" placeholder="POSITION / DESIGNATION" class="placeholder-input" readonly /><input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" /></td>
                    <td><input type="text" id="hod-number" placeholder="EMPLOYEE NUMBER" class="placeholder-input" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '');"/><div id="suggestions-hod" class="suggestions"></div><input type="text" id="hod-name" placeholder="EMPLOYEE NAME" class="placeholder-input" readonly /><input type="text" id="hod-position" placeholder="POSITION / DESIGNATION" class="placeholder-input" readonly /><input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" /></td>
                </tr></tbody>
            </table>
            <button class="ac-download-button" onclick="downloadAndSave()">Download PDF & Save Data</button>
             <button onclick="showEvaluationPage()" style="display: block; margin: -5px auto 15px auto; padding: 10px 20px; background-color: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">Back to Evaluation List</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
    <script>
        let currentFormType = null; // Stores the type of the currently active form

         // --- METRICS DATA STRUCTURE (WITH DETAILED HTML FORMATTING) ---
         const allMetricsData = {
             "AC Technician": [ // Already formatted
                { title: "1. TECHNICAL KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>HVAC Systems Understanding:</b> Knowledge of various AC systems, including residential, commercial, and industrial units.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Diagnostics and Troubleshooting:</b> Ability to diagnose issues accurately using appropriate tools and techniques.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Electrical Knowledge:</b> Understanding of electrical components and wiring in HVAC systems, including capacitors, relays, and circuit boards.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Refrigeration Knowledge:</b> Familiarity with refrigeration cycles, refrigerants, and their proper handling and charging procedures.</div>` },
                { title: "2. HANDS-ON SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Installation Skills:</b> Competence in installing AC units, including proper setup, connections, and system configuration.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Repair Skills:</b> Proficiency in repairing faulty components, including compressors, fans, coils, thermostats, and wiring.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Maintenance Skills:</b> Ability to perform routine maintenance tasks such as cleaning filters, coils, and condensers, checking refrigerant levels, and ensuring system efficiency.</div>` },
                { title: "3. PROBLEM-SOLVING ABILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Diagnosing Complex Issues:</b> Ability to identify and troubleshoot complex mechanical or electrical problems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficient Solutions:</b> Ability to devise practical, cost-effective solutions to fix problems or improve system performance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adaptability:</b> Adjusting solutions based on the specific needs of the environment (e.g., residential vs. commercial setups).</div>` },
                { title: "4. ATTENTION TO DETAIL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Precision:</b> Ensuring all installations, repairs, and maintenance are completed accurately and to manufacturer specifications.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Compliance:</b> Adhering to safety guidelines and protocols, such as handling refrigerants safely, working with electricity, and ensuring proper ventilation.</div>` },
                { title: "5. CUSTOMER SERVICE SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Communication:</b> Explaining technical issues and solutions to customers in an understandable and professional manner.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professionalism:</b> Maintaining a courteous, friendly, and respectful demeanor when interacting with customers, whether on site or over the phone.</div><div style="border: 1px solid #ddd; padding: 2px; margin:0; margin-bottom: 3px;"><b>Customer Education:</b> Offering advice on system maintenance, energy-saving tips, and how to operate AC units properly.</div>` },
                { title: "6. TIME MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficiency:</b> Completing tasks within the expected time frame, ensuring minimal disruption to the customerâ€™s daily activities.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Prioritization:</b> Managing multiple service calls, balancing urgent repairs with routine maintenance without compromising quality.</div>` },
                { title: "7. KNOWLEDGE OF CODES AND REGULATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Local Codes and Standards:</b> Knowledge of local, state, and federal regulations regarding HVAC systems, such as installation codes, refrigerant handling, and energy efficiency standards.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Permit Requirements:</b> Understanding when and how to obtain necessary permits for installation or repairs.</div>` },
                { title: "8. PHYSICAL AND MANUAL DEXTERITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Physical Stamina:</b> Ability to work in challenging physical environments (e.g., rooftops, basements, attics) and handle heavy equipment.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Precision Handling:</b> Skill in using tools such as wrenches, pressure gauges, thermometers, and soldering tools.</div>` },
                { title: "9. SAFETY AWARENESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Workplace Safety:</b> Consistently following safety protocols, such as wearing personal protective equipment (PPE), handling hazardous materials properly, and ensuring workspaces are safe.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Hazard Prevention:</b> Recognizing and mitigating potential safety hazards, such as electrical risks, refrigerant leaks, or improper ventilation.</div>` },
                { title: "10. TROUBLESHOOTING EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Speed:</b> The ability to identify problems and fix them quickly, minimizing downtime for the customer.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Comprehensive Troubleshooting:</b> Not only fixing the immediate issue but also identifying any other potential problems or areas for improvement.</div>` },
                { title: "11. QUALITY OF WORK", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Durability of Work:</b> Ensuring repairs and installations are durable, minimizing the need for repeat visits or fixes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Attention to Detail:</b> Thoroughness in performing repairs and maintenance, ensuring all components are functioning properly.</div>` },
                { title: "12. ADAPTABILITY AND CONTINUED LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Staying Current:</b> Keeping up to date with the latest AC technologies, refrigerants, and industry trends.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Certifications:</b> Having relevant certifications such as EPA 608 (for refrigerant handling), NATE (North American Technician Excellence), or HVACR certifications that demonstrate competence and knowledge.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training and Development:</b> Willingness to participate in ongoing training or workshops to enhance skills and knowledge.</div>` },
                { title: "13. PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Satisfaction:</b> Positive feedback from clients regarding service quality, communication, and reliability.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>First-Time Fix Rate:</b> The percentage of issues resolved on the first visit.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Work Completion Rate:</b> Successful completion of jobs without the need for rework.</div>` }
            ],
             "Dispatch Officer": [
                { title: "1. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clarity and Efficiency:</b> Ability to provide clear, concise, and accurate information to drivers, clients, or team members.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Listening Skills:</b> Actively listens to instructions, requests, and information to ensure accurate understanding and response.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Multitasking in Communication:</b> Managing multiple communication channels (radio, phone, email) without errors.</div>`},
                { title: "2. ORGANIZATIONAL SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Time Management:</b> Effectively prioritizing tasks to ensure timely deliveries or dispatches.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Documentation:</b> Accurately recording and maintaining logs, reports, and other relevant paperwork.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Scheduling:</b> Ability to create and adjust schedules efficiently to maximize resources and meet operational demands.</div>`},
                { title: "3. PROBLEM-SOLVING ABILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quick Thinking:</b> Ability to handle unforeseen challenges (e.g., delays, accidents) with a calm and logical approach.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Decision Making:</b> Making informed and practical decisions quickly, especially under pressure.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adaptability:</b> Adjusting to changes or emergencies without compromising service or safety.</div>`},
                { title: "4. ATTENTION TO DETAIL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy:</b> Ensuring dispatches are carried out correctly, including addresses, times, routes, and special instructions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Monitoring:</b> Keeping track of drivers, deliveries, and schedules, ensuring that everything is progressing as planned.</div>`},
                { title: "5. TECHNOLOGICAL PROFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Software Use:</b> Familiarity with dispatching software and tools used for tracking shipments, vehicles, or deliveries.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>GPS and Routing Systems:</b> Ability to use navigation systems or route optimization tools to guide drivers effectively.</div>`},
                { title: "6. KNOWLEDGE OF SAFETY REGULATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Ensuring that dispatches are made in accordance with safety and regulatory guidelines, especially regarding transport laws, driver hours, and vehicle maintenance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Management:</b> Identifying potential safety hazards and taking preventive measures.</div>`},
                { title: "7. CUSTOMER SERVICE SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Interaction:</b> Professionalism in dealing with customers, addressing complaints, and providing updates.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Problem Resolution:</b> Handling customer service issues that may arise during dispatch, such as delays or route changes.</div>`},
                { title: "8. TEAM COLLABORATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cooperation:</b> Working effectively with other team members, drivers, and departments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Leadership:</b> Guiding the dispatch team or taking charge when necessary, especially during busy times or emergencies.</div>`},
                { title: "9. STRESS MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Composure Under Pressure:</b> Ability to stay calm and focused when handling multiple tasks or responding to emergencies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Managing conflicts within the team or with customers effectively.</div>`},
                { title: "10. PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Timeliness:</b> Meeting deadlines for dispatch and deliveries consistently.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy:</b> Minimizing errors in dispatch and delivery details, including addresses, times, and special requirements.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Satisfaction:</b> Maintaining a high level of customer satisfaction, measured through feedback and service consistency.</div>`}
            ],
            "Electrical Engineer": [
                 { title: "1. TECHNICAL COMPETENCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Knowledge of Electrical Engineering Principles:</b> Proficiency in core concepts such as circuit theory, power systems, electromagnetism, and control systems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Application of Theory to Practice:</b> Ability to apply theoretical knowledge to solve practical engineering problems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Use of Engineering Software:</b> Competency in using simulation, design, and analysis software (e.g., AutoCAD, MATLAB, ETAP).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Design Skills:</b> Ability to design electrical systems according to specifications.</div>`},
                 { title: "2. PROBLEM-SOLVING ABILITIES", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Innovative Solutions:</b> Ability to propose innovative, cost-effective solutions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Troubleshooting and Diagnostics:</b> Skill in diagnosing and troubleshooting electrical systems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Root Cause Analysis:</b> Capacity to identify the root cause of electrical failures.</div>`},
                 { title: "3. PROJECT MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Planning and Execution:</b> Ability to plan, schedule, and manage projects.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Management:</b> Efficient management of resources.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quality Control:</b> Ensuring work meets required quality standards and regulatory compliance.</div>`},
                 { title: "4. SAFETY AND COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Safety Standards:</b> Knowledge and adherence to electrical safety standards (e.g., NEC, IEC).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Regulatory Compliance:</b> Understanding and compliance with local and national regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Assessment and Mitigation:</b> Ability to identify electrical hazards and implement mitigation measures.</div>`},
                 { title: "5. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Documentation:</b> Ability to prepare clear and accurate technical documentation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Collaboration:</b> Ability to work effectively in multidisciplinary teams.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Interaction:</b> Proficiency in presenting technical solutions to clients.</div>`},
                 { title: "6. LEADERSHIP AND TEAMWORK", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Leadership Skills:</b> Ability to lead and mentor junior engineers (if applicable).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration:</b> Effective collaboration with other departments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Ability to handle conflicts professionally.</div>`},
                 { title: "7. ADAPTABILITY AND LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Continuous Learning:</b> Willingness to stay updated with latest trends and technologies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Flexibility in Problem-Solving:</b> Ability to adapt to changing requirements.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professional Development:</b> Participation in training and workshops.</div>`},
                 { title: "8. EFFICIENCY AND PRODUCTIVITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Time Management:</b> Ability to prioritize tasks and meet deadlines.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Efficiency:</b> Ability to balance cost constraints with technical requirements.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Output and Results:</b> Ability to complete tasks and projects efficiently.</div>`},
                 { title: "9. INNOVATION AND INITIATIVE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Creative Problem-Solving:</b> Ability to think outside the box.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Initiative:</b> Proactiveness in identifying potential issues and suggesting improvements.</div>`},
                 { title: "10. CUSTOMER OR STAKEHOLDER SATISFACTION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Satisfaction:</b> Ability to meet client expectations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Internal Stakeholder Satisfaction:</b> Ensuring electrical solutions meet internal requirements.</div>`},
                 { title: "11. ETHICS AND PROFESSIONALISM", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Integrity:</b> Demonstrating honesty, transparency, and accountability.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professionalism:</b> Adhering to engineering ethics and maintaining confidentiality.</div>`},
                 { title: "12. PERFORMANCE METRICS AND KEY PERFORMANCE INDICATORS (KPIS)", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Completion:</b> On-time and within-budget delivery.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Error Rate:</b> Frequency of errors or rework.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Feedback:</b> Evaluating feedback from clients/stakeholders.</div>`}
            ],
            "Electrician Industrial": [
                { title: "1. TECHNICAL KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Electrical Systems Understanding:</b> Proficiency in industrial electrical systems and equipment.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Wiring and Circuitry:</b> Ability to install, repair, and maintain wiring/circuits.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Blueprint Reading:</b> Ability to read technical drawings and wiring diagrams.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Power Distribution:</b> Knowledge of power distribution systems.</div>`},
                { title: "2. INSTALLATION AND MAINTENANCE SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Electrical Installations:</b> Skill in installing systems and equipment.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Preventive Maintenance:</b> Ability to carry out routine maintenance and inspections.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Troubleshooting and Repairs:</b> Skill in diagnosing and repairing electrical issues quickly.</div>`},
                { title: "3. SAFETY AND COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Protocols:</b> Adherence to safety regulations (LOTO, PPE).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance with Standards:</b> Knowledge of electrical codes (NEC, IEC).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Hazardous Environment Awareness:</b> Ability to identify and mitigate risks.</div>`},
                { title: "4. TROUBLESHOOTING AND DIAGNOSTICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Systematic Approach:</b> Ability to use logical methods for troubleshooting.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Diagnostic Tools:</b> Proficiency with multimeters, thermal cameras, etc.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Root Cause Analysis:</b> Skill in identifying the root cause of failures.</div>`},
                { title: "5. ELECTRICAL EQUIPMENT AND CONTROLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Motor Control Systems:</b> Expertise with MCCs, PLCs, VFDs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Control Systems:</b> Familiarity with manual/automated control systems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Calibration and Testing:</b> Ability to calibrate and test systems.</div>`},
                { title: "6. PROBLEM-SOLVING AND EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quick Decision-Making:</b> Ability to make decisions under pressure.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Work Efficiency:</b> Completing tasks timely and efficiently.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Management:</b> Effective use of materials and tools.</div>`},
                { title: "7. TIME MANAGEMENT AND TASK PRIORITIZATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Task Prioritization:</b> Ability to prioritize critical repairs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Meeting Deadlines:</b> Completing work within designated time frames.</div>`},
                { title: "8. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting:</b> Ability to document work clearly.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Collaboration:</b> Working effectively with others.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Ability to explain technical issues clearly.</div>`},
                { title: "9. EXPERIENCE AND KNOWLEDGE OF PLANT-SPECIFIC SYSTEMS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Plant-Specific Equipment:</b> Familiarity with plant equipment.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Industrial Electrical Maintenance:</b> Experience with plant-specific procedures.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Energy Efficiency:</b> Knowledge of energy-saving technologies.</div>`},
                { title: "10. ADAPTABILITY AND CONTINUOUS LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adaptability to Change:</b> Ability to adapt to new technology/protocols.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ongoing Education:</b> Willingness to stay current.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Learning from Experience:</b> Applying lessons learned.</div>`},
                { title: "11. LEADERSHIP AND SUPERVISION (IF APPLICABLE)", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Leadership:</b> Ability to manage/mentor junior staff.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Delegation:</b> Effectively delegating tasks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training:</b> Providing training and support.</div>`},
                { title: "12. PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Downtime Reduction:</b> Effectiveness in minimizing equipment downtime.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Work Quality:</b> High standards of electrical work.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer (Internal) Satisfaction:</b> Delivering quality electrical support.</div>`},
                { title: "13. ENERGY EFFICIENCY AND COST MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Energy Management:</b> Identifying areas for energy efficiency.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost-Effectiveness:</b> Ensuring work is carried out cost-effectively.</div>`}
            ],
            "HSE Advisor": [
                 { title: "1. KNOWLEDGE OF HSE REGULATIONS AND STANDARDS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Legal Compliance:</b> Understanding and application of HSE regulations (OSHA, EPA).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Industry Standards:</b> Knowledge of ISO 45001, ISO 14001.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Regulations:</b> Awareness of waste management, emissions control.</div>`},
                 { title: "2. RISK ASSESSMENT AND HAZARD IDENTIFICATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Analysis:</b> Ability to conduct thorough risk assessments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Mitigation Measures:</b> Expertise in recommending control measures (PPE, procedures).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Job Safety Analysis (JSA):</b> Ability to conduct and guide JSA.</div>`},
                 { title: "3. SAFETY TRAINING AND AWARENESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training Program Development:</b> Ability to develop and deliver safety training.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ongoing Education:</b> Organizing drills, campaigns, refreshers.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Tailored Training:</b> Customizing training for specific needs.</div>`},
                 { title: "4. SAFETY AUDITS AND INSPECTIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Site Inspections:</b> Regularly conducting audits/inspections.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Audit Readiness:</b> Maintaining records for external/internal audits.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Non-Compliance Tracking:</b> Monitoring and addressing non-compliance.</div>`},
                 { title: "5. INCIDENT INVESTIGATION AND REPORTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accident Investigation:</b> Leading/supporting investigations for root causes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Reporting:</b> Ensuring timely and accurate reporting.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Data Analysis:</b> Analyzing incident data for trends and prevention.</div>`},
                 { title: "6. EMERGENCY RESPONSE PLANNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Emergency Procedures:</b> Developing and maintaining response plans.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Crisis Management:</b> Leading/supporting emergency response.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Drills and Simulations:</b> Organizing regular drills.</div>`},
                 { title: "7. ENVIRONMENTAL PROTECTION AND SUSTAINABILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainability Initiatives:</b> Promoting responsible practices (waste, resources).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Risk Management:</b> Identifying/mitigating environmental risks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Green Certifications:</b> Promoting/working towards certifications (ISO 14001).</div>`},
                 { title: "8. COMMUNICATION AND COLLABORATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Communicating HSE policies clearly.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Stakeholder Engagement:</b> Collaborating with teams, regulators, clients.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting and Documentation:</b> Producing clear, detailed reports.</div>`},
                 { title: "9. LEADERSHIP AND INFLUENCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Promoting a Safety Culture:</b> Leading by example.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Influence and Advocacy:</b> Encouraging safe practices.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Handling safety conflicts professionally.</div>`},
                 { title: "10. TRAINING, CERTIFICATIONS, AND PROFESSIONAL DEVELOPMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Relevant Certifications:</b> Holding NEBOSH, IOSH, OSHA certs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Continuous Learning:</b> Engaging in ongoing professional development.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professional Affiliations:</b> Active membership in HSE organizations.</div>`},
                 { title: "11. TEAMWORK AND INTERPERSONAL SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration with Teams:</b> Working effectively with other departments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Interpersonal Skills:</b> Building strong relationships.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Motivating Others:</b> Inspiring safe work practices.</div>`},
                 { title: "12. PERFORMANCE TRACKING AND CONTINUOUS IMPROVEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Performance Metrics:</b> Monitoring KPIs (accident rates, near misses).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Continuous Improvement:</b> Identifying and implementing improvements.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Feedback Loops:</b> Using feedback to improve systems.</div>`},
                 { title: "13. ETHICS AND PROFESSIONALISM", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Integrity:</b> Acting with honesty and transparency.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Commitment to Compliance:</b> Demonstrating full compliance adherence.</div>`},
                 { title: "14. ADAPTABILITY AND CRISIS MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Dealing with Unforeseen Issues:</b> Adapting to changing conditions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Problem Solving in High-Pressure Situations:</b> Calmly managing emergencies.</div>`}
            ],
           "IT Support Executive": [
                 { title: "1. TECHNICAL KNOWLEDGE AND SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Hardware/Software Expertise:</b> Troubleshooting servers, network devices, endpoints.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Operating Systems:</b> Administering Windows, Linux, macOS.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Networking Knowledge:</b> Understanding IP, DNS, DHCP, VPN, firewalls.</div>`},
                 { title: "2. PROBLEM-SOLVING AND TROUBLESHOOTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Issue Resolution:</b> Diagnosing and resolving complex technical issues.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Root Cause Analysis:</b> Identifying underlying causes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Troubleshooting Methodology:</b> Using systematic methods.</div>`},
                 { title: "3. SYSTEM ADMINISTRATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Backup and Recovery:</b> Ensuring robust backup/restore strategies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Patch Management:</b> Regular updating and patching.</div>`},
                 { title: "4. SECURITY AND COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Security Practices:</b> Implementing firewalls, antivirus, encryption.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Access Control:</b> Managing user permissions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Adherence to security standards (GDPR, HIPAA).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Response:</b> Managing security breaches.</div>`},
                 { title: "5. INFRASTRUCTURE MONITORING AND OPTIMIZATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>System Monitoring:</b> Proactively monitoring infrastructure health.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Performance Tuning:</b> Optimizing system/network performance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Capacity Planning:</b> Assessing resource needs.</div>`},
                 { title: "6. SUPPORT AND SERVICE MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Management:</b> Handling service tickets efficiently.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>User Support:</b> Providing technical assistance to end users.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Documentation:</b> Creating/maintaining system documentation.</div>`},
                 { title: "7. PROJECT MANAGEMENT AND COORDINATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Implementation:</b> Assisting/leading IT infrastructure projects.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration:</b> Working with other teams.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Vendor Management:</b> Coordinating with third-party vendors.</div>`},
                 { title: "8. CUSTOMER SERVICE AND COMMUNICATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Explaining technical issues clearly.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Interaction:</b> Providing excellent customer service.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training and Knowledge Sharing:</b> Educating users/colleagues.</div>`},
                 { title: "9. TIME MANAGEMENT AND EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Task Prioritization:</b> Managing multiple requests effectively.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficiency:</b> Completing tasks without compromising quality.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Deadline Adherence:</b> Meeting project deadlines.</div>`},
                 { title: "10. ADAPTABILITY AND CONTINUOUS LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Learning Agility:</b> Staying updated with emerging tech.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Certification and Training:</b> Pursuing relevant certifications (CompTIA, MCSA, CCNA).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adaptability:</b> Adapting to new tools/technologies.</div>`},
                 { title: "11. VENDOR AND CONTRACT MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Vendor Relationships:</b> Managing vendor interactions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Contract Management:</b> Ensuring adherence to SLAs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Management:</b> Managing procurement/support costs.</div>`},
                 { title: "12. PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>System Uptime:</b> Maintaining high system availability.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Response Time:</b> Meeting support ticket response targets.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>End-User Satisfaction:</b> Monitoring user feedback.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Issue Resolution Time:</b> Average time to resolve issues.</div>`},
                 { title: "13. LEADERSHIP AND INITIATIVE (IF APPLICABLE)", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Leadership:</b> Guiding IT support staff.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Taking Initiative:</b> Proactively suggesting improvements.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Mentoring:</b> Helping junior team members.</div>`}
            ],
            "Permit Applicant": [
                 { title: "1. COMPLIANCE WITH REQUIREMENTS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Zoning/Land Use:</b> Ensuring project aligns with local laws.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Impact:</b> Compliance with environmental regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Health & Safety Standards:</b> Adherence to H&S regulations.</div>`},
                 { title: "2. FINANCIAL STABILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ability to Pay Fees:</b> Ensuring applicant can cover permit fees.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Financial Responsibility:</b> Verifying resources to complete the project.</div>`},
                 { title: "3. EXPERIENCE AND QUALIFICATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Technical Expertise:</b> Demonstrating necessary technical skills (if required).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Past Compliance Record:</b> History of compliance.</div>`},
                 { title: "4. PUBLIC SAFETY AND WELFARE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Impact on Public Safety:</b> Ensuring project poses no threat.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Community Impact:</b> Assessing effects on noise, traffic, etc.</div>`},
                 { title: "5. APPLICATION COMPLETENESS AND ACCURACY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Proper Documentation:</b> Submitting all required documents.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy of Information:</b> Verifying provided information.</div>`},
                 { title: "6. DURATION AND SCOPE OF THE PERMIT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Timeline:</b> Adherence to projected timeline.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance Monitoring:</b> Willingness to comply with monitoring.</div>`},
                 { title: "7. PUBLIC ENGAGEMENT (IF APPLICABLE)", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Community Consultation:</b> Engaging with the local community.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Public Comments:</b> Consideration of public feedback.</div>`},
                 { title: "8. ENVIRONMENTAL CONSIDERATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainability Practices:</b> Incorporating sustainable methods.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Permitting for Environmental Factors:</b> Compliance with specific environmental rules.</div>`},
                 { title: "9. RISK ASSESSMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk to Environment/Property:</b> Assessment of potential risks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Contingency Plans:</b> Providing plans for high-risk activities.</div>`}
            ],
            "Permit Holder": [
                { title: "1. COMPLIANCE WITH REGULATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Knowledge of Laws:</b> Understanding relevant legal/safety/environmental rules.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Conditions:</b> Strictly following all permit conditions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Compliance:</b> Complying with environmental protection laws.</div>`},
                { title: "2. SAFETY MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Protocols:</b> Implementing and enforcing safety measures.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Hazard ID & Risk Assessment:</b> Identifying hazards and mitigation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Emergency Procedures:</b> Ensuring proper emergency preparedness.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Reporting:</b> Prompt reporting and corrective actions.</div>`},
                { title: "3. DOCUMENTATION AND RECORD KEEPING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accurate Documentation:</b> Maintaining records of permit activities.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Audit Readiness:</b> Keeping documents organized for inspection.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting Obligations:</b> Timely submission of required reports.</div>`},
                { title: "4. OPERATIONAL COMPETENCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Technical Knowledge:</b> Understanding operations covered by the permit.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Supervision and Oversight:</b> Managing operations and contractors effectively.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Management:</b> Efficient use of materials, equipment, personnel.</div>`},
                { title: "5. TRAINING AND COMPETENCE OF PERSONNEL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Qualified Workforce:</b> Ensuring personnel are trained/certified.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ongoing Training:</b> Providing continuous training.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Competency in Permit Requirements:</b> Ensuring understanding of permit conditions.</div>`},
                { title: "6. PERFORMANCE MONITORING AND REPORTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Inspection and Monitoring:</b> Regularly checking work for compliance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Corrective Actions:</b> Taking timely action on deviations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Performance Reviews:</b> Ongoing evaluation against permit objectives.</div>`},
                { title: "7. ENVIRONMENTAL AND SOCIAL RESPONSIBILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainability Efforts:</b> Implementing waste management, conservation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Community Impact:</b> Minimizing negative effects on communities/ecosystems.</div>`},
                { title: "8. TIMELINESS AND PROJECT MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Deadlines:</b> Conducting activities within permit timeframes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Execution:</b> Effective management to complete projects on plan/budget.</div>`},
                { title: "9. COMMUNICATION WITH AUTHORITIES", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Engagement with Regulators:</b> Maintaining professional relationship.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Transparency:</b> Being open about operations and issues.</div>`},
                { title: "10. HISTORY OF COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Past Performance:</b> Track record of compliance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Violation History:</b> Low or non-existent history of violations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Corrective Actions Taken:</b> Demonstrated ability to fix past issues.</div>`},
                { title: "11. ETHICS AND PROFESSIONALISM", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Integrity:</b> Operating in good faith and adhering to law.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professionalism in Operations:</b> Conducting activities ethically.</div>`}
            ],
            "Pipe Fitter": [
                 { title: "1. TECHNICAL SKILLS & KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Pipe Fitting Techniques:</b> Ability to read blueprints, schematics.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Welding Skills:</b> Proficiency in TIG, MIG, stick welding.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cutting and Bending:</b> Skill in cutting, threading, bending pipes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Pipe Sizing:</b> Understanding sizes, materials, design.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Installation Process:</b> Knowledge of alignment, leveling, securing.</div>`},
                 { title: "2. KNOWLEDGE OF STANDARDS & CODES", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Regulations Compliance:</b> Familiarity with ASME, API, ANSI.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Standards:</b> Adherence to safety protocols, PPE use.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Compliance:</b> Understanding environmental requirements.</div>`},
                 { title: "3. PROBLEM-SOLVING & TROUBLESHOOTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Identifying Issues:</b> Ability to find alignment problems, leaks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Corrective Action:</b> Quick and effective problem-solving.</div>`},
                 { title: "4. QUALITY OF WORK", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Precision and Accuracy:</b> High precision in cutting, fitting, assembly.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Leak-Free Installations:</b> Ensuring no leaks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Durability and Strength:</b> Ensuring installation meets pressure/temp needs.</div>`},
                 { title: "5. TIME MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficiency:</b> Completing tasks timely without compromising quality/safety.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Milestones:</b> Ability to meet deadlines.</div>`},
                 { title: "6. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Collaboration:</b> Working well with others.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting:</b> Providing clear work reports.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Instructional Ability:</b> Ability to mentor/train others.</div>`},
                 { title: "7. SAFETY RECORD", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Workplace Safety:</b> Proven track record of following safety protocols.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Inspections:</b> Participation in inspections/hazard assessments.</div>`},
                 { title: "8. EXPERIENCE AND CERTIFICATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Relevant Experience:</b> Years of experience with flowline/piping systems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Certifications:</b> Holding NCCER or similar qualifications.</div>`},
                 { title: "9. PHYSICAL CONDITION AND STAMINA", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Physical Fitness:</b> Strength/endurance for demanding tasks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Stamina and Dexterity:</b> Ability for repetitive tasks/extended hours.</div>`},
                 { title: "10. ADAPTABILITY AND LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adaptability to New Technologies:</b> Willingness to learn new methods.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Continuous Improvement:</b> Commitment to ongoing development.</div>`}
            ],
            "Quality Control": [
                 { title: "1. ACCURACY AND PRECISION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Consistency in results:</b> QC should consistently ensure that products or services meet defined specifications.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Error detection:</b> A good QC system is effective at identifying and addressing defects, inconsistencies, or non-conformities.</div>`},
                 { title: "2. ADHERENCE TO STANDARDS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Aligning with ISO, industry, gov regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Documentation:</b> Ensuring procedures are documented and followed.</div>`},
                 { title: "3. EFFICIENCY OF PROCESSES", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Timeliness:</b> QC process not causing delays.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource utilization:</b> Optimal use of manpower, tools, materials.</div>`},
                 { title: "4. DEFECT DETECTION & PREVENTION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Prevention focus:</b> Proactively identifying root causes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Types of defects caught:</b> Effectiveness in identifying various defects.</div>`},
                 { title: "5. TRAINING AND EXPERTISE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Skills of QC personnel:</b> Competency in applying QC measures.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ongoing development:</b> Support for learning and certification.</div>`},
                 { title: "6. DOCUMENTATION AND REPORTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy of records:</b> Clear records of inspections, tests, actions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Transparency & traceability:</b> Documentation allows traceability.</div>`},
                 { title: "7. CUSTOMER SATISFACTION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Feedback incorporation:</b> Tracking and using customer feedback.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Post-delivery performance:</b> Monitoring product/service performance.</div>`},
                 { title: "8. CORRECTIVE & PREVENTIVE ACTIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Root cause analysis:</b> Identifying underlying causes of defects.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Follow-up actions:</b> Taking steps to prevent recurrence.</div>`},
                 { title: "9. CONTINUOUS IMPROVEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Process improvement:</b> Regular review of QC process.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Metrics and KPIs:</b> Establishing and measuring quality KPIs.</div>`},
                 { title: "10. COST-EFFECTIVENESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost of quality:</b> Evaluating costs of prevention, detection, failure.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Return on investment (ROI):</b> QC showing positive ROI.</div>`}
            ],
            "Quantity Surveyor": [
                 { title: "1. TECHNICAL KNOWLEDGE & EXPERTISE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Estimation:</b> Accurate cost estimates from drawings/specs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Bill of Quantities (BOQ):</b> Preparing/managing BOQs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Construction Techniques:</b> Understanding methods and cost implications.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Contractual Knowledge:</b> Strong grasp of NEC, FIDIC, JCT.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Value Engineering:</b> Optimizing costs while maintaining quality.</div>`},
                 { title: "2. PROJECT MANAGEMENT & COORDINATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Budget Management:</b> Managing and controlling project budgets.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Monitoring & Reporting:</b> Tracking costs and reporting variances.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cash Flow Forecasting:</b> Managing project cash flow.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Tendering & Procurement:</b> Managing bids and contractor selection.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Management:</b> Identifying and managing financial risks.</div>`},
                 { title: "3. ANALYTICAL & PROBLEM-SOLVING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Analysis:</b> Analyzing cost reports for savings/discrepancies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Dispute Resolution:</b> Skill in resolving cost/contract disputes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Problem-Solving:</b> Addressing cost overruns, variations effectively.</div>`},
                 { title: "4. COMMUNICATION & INTERPERSONAL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration:</b> Working with architects, engineers, contractors.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Communication:</b> Clearly communicating cost info.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Negotiation Skills:</b> Managing variations and claims.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Presentation Skills:</b> Presenting cost reports.</div>`},
                 { title: "5. ATTENTION TO DETAIL & ACCURACY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy:</b> Meticulous measurement and calculation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Consistency & Precision:</b> Ensuring reports are precise.</div>`},
                 { title: "6. KNOWLEDGE OF STANDARDS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Building Codes:</b> Familiarity with relevant codes/regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Health & Safety:</b> Understanding H&S cost implications.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainability:</b> Knowledge of green practices and costs.</div>`},
                 { title: "7. EXPERIENCE & QUALIFICATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Educational Background:</b> Relevant degree (QS, Civil Eng).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professional Experience:</b> Demonstrated history in QS roles.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>CPD:</b> Commitment to ongoing learning.</div>`},
                 { title: "8. SOFTWARE PROFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Estimation Software:</b> Familiarity with tools (CostX, Procore).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Excel & Data Management:</b> Advanced Excel skills.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>BIM:</b> Knowledge of using BIM for cost estimation.</div>`},
                 { title: "9. LEADERSHIP & MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Leadership:</b> Ability to manage/mentor junior staff.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Decision-Making:</b> Strong financial/contractual decisions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client-Focused Mindset:</b> Meeting client requirements.</div>`},
                 { title: "10. ETHICS & PROFESSIONAL INTEGRITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Transparency & Honesty:</b> Acting with integrity.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ethical Behavior:</b> Adherence to professional standards.</div>`},
                 { title: "11. TIME MANAGEMENT & EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Timelines:</b> Meeting deadlines for reports, tenders.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Multitasking:</b> Handling multiple projects effectively.</div>`},
                 { title: "12. ADAPTABILITY & CONTINUOUS IMPROVEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adapting to Changes:</b> Managing scope/budget changes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Innovation:</b> Seeking innovative cost management methods.</div>`}
            ],
            "Site Engineer - Electrical": [
                 { title: "1. TECHNICAL KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Electrical Systems Understanding:</b> Proficiency in designing, installing, testing, and maintaining electrical systems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Codes & Standards:</b> Knowledge of NEC, IEC.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Circuit Design & Analysis:</b> Ability to calculate load requirements, cable sizes.</div>`},
                 { title: "2. PROBLEM-SOLVING & TROUBLESHOOTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Diagnostics:</b> Capability to quickly diagnose electrical faults.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Practical Application:</b> Applying theory to real-world problems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Troubleshooting Skills:</b> Efficiently identifying and resolving malfunctions.</div>`},
                 { title: "3. PROJECT MANAGEMENT & PLANNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Scheduling & Coordination:</b> Managing timelines, coordinating teams.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Allocation:</b> Ensuring resource availability.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Progress Monitoring:</b> Assessing progress and adjusting.</div>`},
                 { title: "4. QUALITY CONTROL AND SAFETY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Safety Standards:</b> Ensuring work follows safety protocols.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quality Assurance:</b> Ensuring installations meet high standards.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Inspection and Testing:</b> Verifying compliance.</div>`},
                 { title: "5. DESIGN AND TECHNICAL DRAWINGS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Interpretation of Drawings:</b> Ability to read electrical drawings/blueprints.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Design Modifications:</b> Making necessary adjustments on site.</div>`},
                 { title: "6. BUDGET AND COST CONTROL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Estimation:</b> Ability to estimate costs for electrical works.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Control:</b> Monitoring expenditures against budget.</div>`},
                 { title: "7. TEAM LEADERSHIP AND COLLABORATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Supervision:</b> Leading electrical teams on-site.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration:</b> Working closely with other engineers/contractors.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Handling site conflicts professionally.</div>`},
                 { title: "8. DOCUMENTATION AND REPORTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Record Keeping:</b> Maintaining accurate work records.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting:</b> Providing regular progress reports.</div>`},
                 { title: "9. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Effectively communicating technical information.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting and Documentation:</b> Preparing clear reports/documents.</div>`},
                 { title: "10. REGULATORY AND COMPLIANCE KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Ensuring work meets local regulations/codes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Permit and License Management:</b> Handling necessary permits.</div>`},
                 { title: "11. ADAPTABILITY AND FLEXIBILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Responding to Changes:</b> Adapting to changing conditions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Handling Unforeseen Issues:</b> Dealing with unexpected problems.</div>`},
                 { title: "12. CLIENT INTERACTION AND CUSTOMER FOCUS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Orientation:</b> Engaging professionally with clients.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Satisfaction:</b> Meeting client expectations.</div>`},
                 { title: "13. TIME MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficient Task Management:</b> Completing tasks on time.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Handling Deadlines:</b> Meeting project deadlines.</div>`},
                 { title: "14. SUSTAINABILITY AND ENERGY EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Energy-Efficient Solutions:</b> Knowledge of efficient solutions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainable Practices:</b> Incorporating green practices.</div>`},
                 { title: "15. CONTINUOUS LEARNING AND DEVELOPMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Technical Upgrades:</b> Staying updated on trends/tech.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professional Development:</b> Pursuing certifications/training.</div>`}//,
                 //{ title: "16. PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;">Project Completion Rate: Ability to meet deadlines and complete projects within the estimated timeline.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;">Quality of Work: Consistency in delivering high-quality electrical installations and maintenance work, with minimal rework or corrections needed.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;">Client Feedback: Positive client feedback related to the electrical systems installed, including functionality, safety, and overall satisfaction.</div>`} // Commented out 16th metric as sheet only goes to 15
            ],
            "Site Engineer": [
                 { title: "1. TECHNICAL KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Understanding of Engineering Principles:</b> Strong knowledge (Civil, Mech, Elec).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Knowledge of Construction Methods:</b> Understanding techniques, materials.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Blueprint Interpretation:</b> Ability to read plans/specs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Problem-Solving:</b> Troubleshooting site issues.</div>`},
                 { title: "2. PROJECT MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Planning & Scheduling:</b> Managing daily operations, timelines.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Management:</b> Efficient use of labor, materials.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Budget Control:</b> Managing costs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quality Control:</b> Ensuring work meets standards.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Management:</b> Identifying/mitigating risks.</div>`},
                 { title: "3. SAFETY AND COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Standards:</b> Adherence to safety regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Assessment:</b> Conducting safety assessments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Ensuring project meets codes/laws.</div>`},
                 { title: "4. LEADERSHIP & TEAM MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Coordination:</b> Leading workers and subcontractors.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Decision Making:</b> Making informed decisions quickly.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Managing site conflicts.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Delegation:</b> Delegating tasks effectively.</div>`},
                 { title: "5. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Communicating with teams, clients, management.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting:</b> Providing accurate progress reports.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Stakeholder Interaction:</b> Interfacing with clients, suppliers.</div>`},
                 { title: "6. TECHNICAL TOOLS PROFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Engineering Software:</b> Proficiency in AutoCAD, MS Project, etc.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Data Management:</b> Organizing project documentation.</div>`},
                 { title: "7. ATTENTION TO DETAIL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy in Execution:</b> Ensuring work follows specs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quality Assurance:</b> Regularly inspecting work.</div>`},
                 { title: "8. ADAPTABILITY & PROBLEM-SOLVING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Handling Challenges:</b> Adapting to changing conditions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Innovation:</b> Proposing efficiency improvements.</div>`},
                 { title: "9. TIME MANAGEMENT & EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Deadline Adherence:</b> Ensuring project completion on time.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficiency:</b> Maintaining productivity.</div>`},
                 { title: "10. ENVIRONMENTAL AWARENESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainable Practices:</b> Awareness of eco-friendly methods.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Compliance:</b> Ensuring regulations are followed.</div>`},
                 { title: "11. CLIENT & STAKEHOLDER MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Requirements:</b> Ensuring needs are met.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Change Management:</b> Managing scope/cost changes.</div>`},
                 { title: "12. ETHICS AND PROFESSIONALISM", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Integrity:</b> Displaying honesty.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professionalism:</b> Maintaining professional demeanor.</div>`},
                 { title: "13. PREVIOUS EXPERIENCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Track Record:</b> Evaluation of past projects.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>References:</b> Positive feedback.</div>`},
                 { title: "14. CONTINUOUS LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ongoing Education:</b> Staying updated.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Certifications:</b> Holding relevant certs (PMP, LEED).</div>`}
            ],
            "Stores Engineer - General": [
                 { title: "1. TECHNICAL KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Inventory Management:</b> Knowledge of systems, procedures.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Materials/Equipment:</b> Familiarity with industry items.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Warehousing:</b> Understanding layout, storage methods.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Technology:</b> Proficiency with barcode/RFID/WMS.</div>`},
                 { title: "2. ORGANIZATIONAL SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Inventory Control:</b> Implementing accurate tracking.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Stock Replenishment:</b> Forecasting and managing stock levels.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Procurement Coordination:</b> Managing sourcing and purchasing.</div>`},
                 // Copied from Site Engineer - Electrical for missing sections, REVIEW if correct
                 { title: "3. HSE & COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Scheduling & Coordination:</b> Ability to manage project timelines and coordinate activities.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Allocation:</b> Ensuring adequate resources are available.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Progress Monitoring:</b> Regularly assessing progress.</div>`}, // Needs review
                 { title: "4. PROBLEM-SOLVING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Safety Standards:</b> Ensuring work follows safety protocols.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quality Assurance:</b> Ensuring installations meet high standards.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Inspection and Testing:</b> Verifying compliance.</div>`}, // Needs review
                 { title: "5. QUALITY CONTROL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Interpretation of Drawings:</b> Ability to read relevant drawings/docs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Design Modifications:</b> Making necessary adjustments.</div>`}, // Needs review
                 { title: "6. COMMUNICATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Estimation:</b> Ability to estimate costs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Control:</b> Monitoring expenditures.</div>`}, // Needs review
                 { title: "7. PROJECT MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Supervision:</b> Leading store staff.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration:</b> Working with other departments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Handling conflicts.</div>`}, // Needs review
                 { title: "8. TECH PROFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Record Keeping:</b> Maintaining accurate records.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting:</b> Providing regular reports.</div>`}, // Needs review
                 { title: "9. LEADERSHIP (If applicable)", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Communicating effectively.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting and Documentation:</b> Preparing reports.</div>`}, // Needs review
                 { title: "10. EXPERIENCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Ensuring work meets regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Permit and License Management:</b> Handling permits.</div>`}, // Needs review
                 { title: "11. EFFICIENCY & COST CONTROL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Responding to Changes:</b> Adapting to site conditions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Handling Unforeseen Issues:</b> Dealing with problems.</div>`}, // Needs review
                 { title: "12. ADAPTABILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Orientation:</b> Engaging professionally.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Satisfaction:</b> Meeting expectations.</div>`}, // Needs review
                 { title: "13. STORES KPI", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>KNOWLEDGE IN STORES KPI TIMELINE ALONG WITH NECESSARY COMPLIANCE</b></div>`},
                 { title: "14. SCRAP MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>KNOWLEDGE IN SCRAP MANAGEMENT , SCRAP SEGREGATION AND MAINTAINING THE INVENTORY BASED ON THE TYPE OF SCRAP</b></div>`}
            ],
            "Supervisor - Security": [
                 { title: "1. LEADERSHIP & TEAM MGMT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Supervision:</b> Ability to manage and oversee a security team.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Motivation:</b> Ability to motivate security staff.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training and Development:</b> Providing ongoing training.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Handling interpersonal issues.</div>`},
                 { title: "2. SECURITY KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Security Procedures:</b> Knowledge of protocols (access control, surveillance).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Assessment:</b> Assessing and mitigating security risks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Emergency Response:</b> Managing and responding to emergencies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Systems Management:</b> Understanding CCTV, alarms, access control.</div>`},
                 { title: "3. DECISION-MAKING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Crisis Management:</b> Making sound decisions under pressure.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Problem-Solving:</b> Identifying and resolving security issues.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Judgment and Discretion:</b> Exercising sound judgment.</div>`},
                 { title: "4. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Reporting:</b> Providing detailed reports.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Briefing & Coordination:</b> Communicating with other dept/agencies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Interpersonal Communication:</b> Engaging professionally.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict De-escalation:</b> Handling confrontations.</div>`},
                 { title: "5. SURVEILLANCE & MONITORING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Monitoring Systems:</b> Ensuring continuous monitoring.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Patrol Oversight:</b> Supervising patrols.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Documentation:</b> Ensuring proper recording.</div>`},
                 { title: "6. COMPLIANCE & LEGAL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Regulatory Compliance:</b> Knowledge of relevant laws.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Policies:</b> Ensuring compliance with company policy.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Confidentiality:</b> Maintaining strict confidentiality.</div>`},
                 { title: "7. OPERATIONAL EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Scheduling:</b> Efficiently scheduling personnel.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Control:</b> Operating within budget.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Process Improvement:</b> Identifying efficiency improvements.</div>`},
                 { title: "8. PHYSICAL FITNESS & READINESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Physical Fitness:</b> Ensuring team capability.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Equipment Handling:</b> Proficiency with security gear.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Health & Safety:</b> Focus on team safety.</div>`},
                 { title: "9. CUSTOMER SERVICE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Interaction:</b> Professional interaction.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Proactive Measures:</b> Engaging clients on concerns.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Satisfaction:</b> Monitoring stakeholder satisfaction.</div>`},
                 { title: "10. PERFORMANCE MONITORING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>KPIs:</b> Tracking security metrics.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Reporting:</b> Ensuring prompt reporting/investigation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Security Audits:</b> Conducting regular audits.</div>`},
                 { title: "11. ADAPTABILITY & LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adapting Environments:</b> Adjusting strategies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Continuous Learning:</b> Staying updated.</div>`},
                 { title: "12. TECHNOLOGY PROFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Tech Management:</b> Operating/troubleshooting security tech.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Tech Integration:</b> Understanding new tech benefits.</div>`},
                 { title: "13. EMERGENCY PREPAREDNESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Emergency Drills:</b> Overseeing effective drills.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Command:</b> Leading emergency response.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Assessment:</b> Assessing emergency risks.</div>`},
                 { title: "14. INTEGRITY & PROFESSIONALISM", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ethics & Accountability:</b> High integrity.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Trustworthiness:</b> Demonstrating honesty/discretion.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professional Development:</b> Continuing self-improvement.</div>`},
                 { title: "15. KEY PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Response Time:</b> Speed of incident handling.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Frequency:</b> Monitoring/reducing incidents.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Staff Retention:</b> Retaining qualified staff.</div>`}
             ]
             // Add other roles here...
         };

        // Show/Hide page functions (Unchanged)
        function showWelcomeMessageFromEval() { document.getElementById('evaluation-page').style.display = 'none'; document.getElementById('welcome-page').style.display = 'block'; document.getElementById('login-container').style.display = 'block'; document.getElementById('welcome-message-container').style.display = 'none'; document.querySelectorAll('.background-panel').forEach(p => p.style.display = 'block'); }
        function showEvaluationPage() { document.getElementById('welcome-page').style.display = 'none'; document.getElementById('evaluation-form-container').style.display = 'none'; document.getElementById('evaluation-page').style.display = 'block'; }

        // UPDATED: Function to show the correct form based on type
        function showEvaluationFormByType(formType) {
            console.log("Showing form for:", formType);
            currentFormType = formType; // Set the global variable

            // Hide other pages
            document.getElementById('evaluation-page').style.display = 'none';
            document.getElementById('welcome-page').style.display = 'none';

            // Set form title
            const titleElement = document.getElementById('form-header-title');
            if(titleElement) {
                titleElement.textContent = `EMPLOYEE PERFORMANCE EVALUATION FORM - ${formType.toUpperCase()}`;
            }

            // Clear previous form data
            clearAllFormInputs();

            // Render the correct metrics
            renderMetrics(formType);

             // Reset Overall Performance text
            if(overallPerformanceText) {
                 overallPerformanceText.textContent = "Please rate all metrics.";
            }

            // Show the form container
            document.getElementById('evaluation-form-container').style.display = 'block';
        }

         // --- Helper function to clear ALL form inputs when switching forms ---
        function clearAllFormInputs() {
            // Clear basic employee details triggered by emp-number change
             document.getElementById("emp-number").value = '';
            clearEmployeeFields(); // This clears most fields including reviewer/witness/hod

            // Explicitly clear date and remarks as they are not cleared by clearEmployeeFields
            document.getElementById("review-date-header").value = '';
            document.getElementById("remarks").value = '';

            // Clear any selected radio buttons and comments from metrics section
            const metricsDiv = document.getElementById("performance-metrics");
            if (metricsDiv) {
                metricsDiv.querySelectorAll('input[type="radio"]').forEach(radio => radio.checked = false);
                metricsDiv.querySelectorAll('.rating-option.selected').forEach(opt => opt.classList.remove('selected'));
                metricsDiv.querySelectorAll('textarea').forEach(textarea => textarea.value = '');
            }
            resetHighlightedFields(); // Clear any validation highlights
        }


        // --- Metrics Rendering (Accepts formType) ---
        const metricsContainer = document.getElementById("performance-metrics");
        const overallPerformanceText = document.getElementById("overall-performance");
        const ratingDescriptions = { 1: "Poor", 2: "Average", 3: "Good", 4: "Very Good", 5: "Excellent" };

        function renderMetrics(formType) {
            metricsContainer.innerHTML = ''; // Clear previous metrics
            const currentMetrics = allMetricsData[formType] || []; // Get metrics for the type, default to empty array

            if (currentMetrics.length === 0 && formType) {
                console.warn("No metrics found for form type:", formType);
                metricsContainer.innerHTML = "<p style='color: red; text-align: center;'>Metrics definition not found for this position.</p>";
                return; // Stop if no metrics defined
            }

            currentMetrics.forEach((metric, index) => {
                const metricDiv = document.createElement("div");
                metricDiv.classList.add("performance-feedback");
                let ratingOptionsHTML = "";
                for (let i = 1; i <= 5; i++) {
                    // Unique IDs and names for each metric in the form
                    const radioId = `rating-${formType.replace(/\s+/g, '-')}-${index}-${i}`;
                    const radioName = `rating-${formType.replace(/\s+/g, '-')}-${index}`;
                    ratingOptionsHTML += `
                        <label class="rating-option" for="${radioId}">
                            <input type="radio" name="${radioName}" value="${i}" id="${radioId}">
                            <div class="rating-number">${i}</div>
                            <span class="rating-text">${ratingDescriptions[i]}</span>
                        </label>`;
                }
                // Unique IDs for comments
                const commentId = `comments-${formType.replace(/\s+/g, '-')}-${index}`;
                const hrCommentId = `hr-comments-${formType.replace(/\s+/g, '-')}-${index}`;

                // Use the structured HTML from the metrics data
                metricDiv.innerHTML = `
                    <div class="ac-metric-title"><b>${metric.title}</b></div>
                    <div class="metric-details-container">${metric.details}</div> <!-- Container for formatted details -->
                    <div class="metric-rating-box">
                        <div class="rating-scale">${ratingOptionsHTML}</div>
                    </div>
                    <div style="margin-top: 20px;">
                        <div class="ac-comments-container">
                            <div>
                                <label for="${commentId}" class="required-field"><b>Employee Comments:</b></label>
                                <textarea id="${commentId}" rows="4" placeholder="Enter your comments here..." class="required"></textarea>
                            </div>
                            <div>
                                <label for="${hrCommentId}"><b>HR Comments:</b></label>
                                <textarea id="${hrCommentId}" rows="4" placeholder="Enter HR comments here..."></textarea>
                            </div>
                        </div>
                    </div>`;
                metricsContainer.appendChild(metricDiv);
            });
        }


        // --- Rating Click Listener (Unchanged) ---
        metricsContainer.addEventListener("click", function(event) {
            const clickedLabel = event.target.closest('.rating-option');
            if (clickedLabel) {
                const radioInput = clickedLabel.querySelector('input[type="radio"]');
                if (radioInput) {
                    if (!radioInput.checked) { radioInput.checked = true; }
                    const ratingScale = clickedLabel.closest('.rating-scale');
                    if (ratingScale) {
                        const allLabelsInGroup = ratingScale.querySelectorAll('.rating-option');
                        allLabelsInGroup.forEach(label => {
                            const input = label.querySelector('input[type="radio"]');
                            if (input) { label.classList.toggle('selected', input.checked); }
                        });
                    }
                    updateOverallPerformance(); // Call update on click
                }
            }
        });

        // --- Update Overall Performance (Uses currentFormType) ---
        function updateOverallPerformance() {
             if (!currentFormType || !allMetricsData[currentFormType]) {
                 overallPerformanceText.textContent = "Please select a form type.";
                 return;
             }
             const currentMetrics = allMetricsData[currentFormType];
             const ratings = [];
             currentMetrics.forEach((metric, index) => {
                 const radioName = `rating-${currentFormType.replace(/\s+/g, '-')}-${index}`;
                 const selectedRating = document.querySelector(`#evaluation-form-container input[name="${radioName}"]:checked`);
                 if (selectedRating) {
                     ratings.push(parseInt(selectedRating.value));
                 }
             });

             if (ratings.length === currentMetrics.length && currentMetrics.length > 0) {
                 const average = ratings.reduce((a, b) => a + b, 0) / ratings.length;
                 const roundedAverage = Math.round(average);
                 overallPerformanceText.textContent = `Performance Rating: ${ratingDescriptions[roundedAverage]}`;
             } else if (currentMetrics.length > 0) {
                 overallPerformanceText.textContent = "Please rate all metrics.";
             } else {
                 overallPerformanceText.textContent = "No metrics defined for this form.";
             }
         }


        // --- SAVE PROCESS FUNCTIONS ---
        function downloadAndSave() {
            if (!validateForm()) { return; }
            console.log("Collecting Data before PDF generation...");
            const formData = collectFormData(); // Use UPDATED function below
             if (!formData) { console.error("Failed to collect form data."); alert("An error occurred collecting form data."); return; }
            downloadPDF_noCallback(function() {
                 console.log("PDF process finished. Sending data...");
                 sendDataToSheet(formData); // Use UPDATED function below
             });
        }

        // --- UPDATED collectFormData with Enhanced Logging ---
        function collectFormData() {
            console.log("--- Starting collectFormData ---");
            if (!currentFormType) {
                console.error("Cannot collect data: currentFormType is not set.");
                alert("Error: Form type is not selected.");
                return null;
            }
             const MAX_METRICS = 15; // Define the maximum number of metrics across all forms
            console.log("Current Form Type:", currentFormType);

            try {
                const formData = {
                    // --- Basic Fields ---
                    "Form Name": `${currentFormType} Performance Evaluation`, // Dynamic Form Name
                    "Review Date": document.getElementById("review-date-header").value,
                    "Employee ID": document.getElementById("emp-number").value,
                    "Employee Name": document.getElementById("emp-name").value,
                    "Position Text": document.getElementById("position-text").value,
                    "Employee Group": document.getElementById("emp-group").value,
                    "Division Text": document.getElementById("division-text").value, // Key used in JS
                    "Department Text": document.getElementById("department-text").value, // Key used in JS
                    "Email ID": document.getElementById("email").value,
                    "Contact Number": document.getElementById("contact").value,
                    "Reviewer Emp ID": document.getElementById("reviewer-number").value,
                    "Reviewer Name": document.getElementById("reviewer-name").value,
                 };
                console.log("Collected basic fields.");

                const currentMetrics = allMetricsData[currentFormType] || [];
                const numCurrentMetrics = currentMetrics.length;
                console.log(`Metrics for this form: ${numCurrentMetrics} out of ${MAX_METRICS}`);

                // --- Loop up to MAX_METRICS ---
                for (let i = 0; i < MAX_METRICS; i++) {
                    const metricIndex = i; // 0-based index
                    const metricNumber = i + 1; // 1-based number for keys
                    const ratingKey = `Rating${metricNumber}`;
                    const empCommentKey = `Employee Comments${metricNumber}`;
                    const hrCommentKey = `HR Comments${metricNumber}`;

                    if (metricIndex < numCurrentMetrics) {
                        // --- Collect data for metrics that exist in the current form ---
                         let foundValue = "";
                         const radioName = `rating-${currentFormType.replace(/\s+/g, '-')}-${metricIndex}`;
                         const commentId = `comments-${currentFormType.replace(/\s+/g, '-')}-${metricIndex}`;
                         const hrCommentId = `hr-comments-${currentFormType.replace(/\s+/g, '-')}-${metricIndex}`;

                         const selectedRadio = document.querySelector(`#evaluation-form-container input[name="${radioName}"]:checked`);
                         if (selectedRadio) {
                             foundValue = parseInt(selectedRadio.value);
                         }

                         formData[ratingKey] = foundValue;
                         formData[empCommentKey] = document.getElementById(commentId)?.value || '';
                         formData[hrCommentKey] = document.getElementById(hrCommentId)?.value || '';
                         // console.log(`Collected Metric ${metricNumber}: Rating=${formData[ratingKey]}, EmpComment=${formData[empCommentKey]}, HRComment=${formData[hrCommentKey]}`);
                    } else {
                        // --- Set blank values for metrics that DON'T exist in the current form ---
                         formData[ratingKey] = "";
                         formData[empCommentKey] = "";
                         formData[hrCommentKey] = "";
                         // *** ADDED DEBUG LOG ***
                         console.log(`DEBUG: Added blanks for Metric ${metricNumber}. Keys: ${ratingKey}, ${empCommentKey}, ${hrCommentKey}`);
                    }
                }
                console.log("Finished collecting/padding metrics.");

                // --- Collect Overall and Signatures (Remains the same) ---
                formData["Overall Performance"] = overallPerformanceText.textContent;
                 const overallRatingText = overallPerformanceText.textContent;
                 const match = overallRatingText.match(/Performance Rating: (.+)/);
                 formData["Overall Rating"] = match ? match[1] : "";
                formData["Overall Remarks / Comments"] = document.getElementById("remarks").value;
                // --- NO LONGER COLLECTING THESE - removed from headers in Apps Script ---
                // formData["Employee ID (Signature)"] = document.getElementById("employee-number-signature").value;
                // formData["Employee Name (Signature)"] = document.getElementById("employee-name-signature").value;
                // formData["Position Text (Signature)"] = document.getElementById("position-signature").value;
                // --- End Removal ---
                formData["First Witness Details"] = `ID: ${document.getElementById("employee-number-2").value}, Name: ${document.getElementById("employee-name-2").value}, Position: ${document.getElementById("position-2").value}`;
                formData["Second Witness Details"] = `ID: ${document.getElementById("employee-number-3").value}, Name: ${document.getElementById("employee-name-3").value}, Position: ${document.getElementById("position-3").value}`;
                formData["Reviewer Emp ID (Signature)"] = document.getElementById("reviewer-number-signature").value;
                formData["Reviewer Name (Signature)"] = document.getElementById("reviewer-name-signature").value;
                formData["Reviewer Position (Signature)"] = document.getElementById("reviewer-position-signature").value;
                formData["HOD Emp ID"] = document.getElementById("hod-number").value;
                formData["HOD Name"] = document.getElementById("hod-name").value;
                formData["HOD Position"] = document.getElementById("hod-position").value;
                console.log("Collected overall/signature fields.");

                // Log the final object structure keys
                console.log("--- Final Keys in formData: ---");
                console.log(Object.keys(formData).join(', '));
                console.log("--- End collectFormData ---");
                return formData;

            } catch (error) {
                console.error("Error during collectFormData:", error);
                 alert("An error occurred while collecting form data. Check the console.");
                 return null;
             }
        }


        // --- PDF Function: Corrected Border + Higher Scale ---
        function downloadPDF_noCallback(onComplete) {
             const element = document.getElementById("form-container");
             const suggestionsElements = document.querySelectorAll('.suggestions');
             const downloadButton = document.querySelector('.ac-download-button');
             const backButton1 = document.querySelector('#evaluation-form-container button[onclick="showEvaluationPage()"]'); // Use generic ID
             const signatureDatePlaceholders = element.querySelectorAll('.approval-signature-table input[placeholder="SIGNATURE / DATE"]');
             const originalDisplays = []; let originalButtonDisplay = ''; let originalBackButton1Display = ''; const originalSignatureValues = [];
             suggestionsElements.forEach((el, index) => { originalDisplays[index] = el.style.display; el.style.display = 'none'; });
             if (downloadButton) { originalButtonDisplay = downloadButton.style.display; downloadButton.style.display = 'none'; }
             if (backButton1) { originalBackButton1Display = backButton1.style.display; backButton1.style.display = 'none'; }
             // Clear signature/date placeholder VALUES only for PDF
             signatureDatePlaceholders.forEach((input, index) => {
                originalSignatureValues[index] = input.value;
                input.value = ''; // Clear value for PDF visual
             });
             const safeFormType = currentFormType ? currentFormType.replace(/[^a-zA-Z0-9]/g, '_') : 'Form'; // Make filename safe
             const opt = {
                 margin: [5, 5, 5, 5],
                 filename: `${safeFormType}_Eval_${document.getElementById('emp-number').value || 'Employee'}.pdf`, // Dynamic filename
                 image: { type: 'jpeg', quality: 0.98 },
                 html2canvas: { scale: 3, useCORS: true, dpi: 300, letterRendering: true, logging: false }, // Keep scale: 3 for clarity
                 jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
                 pagebreak: { mode: ['css', 'avoid-all', 'legacy'] }
             };
             console.log("Starting PDF generation with scale:", opt.html2canvas.scale);
             html2pdf().from(element).set(opt).save().then(() => {
                 console.log("PDF generation finished.");
                 suggestionsElements.forEach((el, index) => { el.style.display = originalDisplays[index] || ''; });
                 if (downloadButton) { downloadButton.style.display = originalButtonDisplay || ''; }
                 if (backButton1) { backButton1.style.display = originalBackButton1Display || ''; }
                 signatureDatePlaceholders.forEach((input, index) => { input.value = originalSignatureValues[index] || ''; }); // Restore value
                 if (onComplete && typeof onComplete === 'function') { setTimeout(onComplete, 100); }
             }).catch(err => {
                 console.error("Error during PDF generation:", err);
                 suggestionsElements.forEach((el, index) => { el.style.display = originalDisplays[index] || ''; });
                 if (downloadButton) { downloadButton.style.display = originalButtonDisplay || ''; }
                 if (backButton1) { backButton1.style.display = originalBackButton1Display || ''; }
                 signatureDatePlaceholders.forEach((input, index) => { input.value = originalSignatureValues[index] || ''; }); // Restore value on error
                 alert("Failed to generate PDF. Check console. Data saving will be attempted.");
                 if (onComplete && typeof onComplete === 'function') { setTimeout(onComplete, 100); }
             });
         }

         // --- UPDATED Saving Function with Logging ---
        function sendDataToSheet(formData) {
            if (!formData) { console.error("sendDataToSheet: No data provided. Aborting."); alert("Cannot save data - error collecting data."); return; }

            console.log("--- Preparing to send data ---");
            // Log the exact object being stringified and sent
            console.log("--- FINAL formData to be sent (Stringified Preview): ---");
            console.log(JSON.stringify(formData, null, 2)); // Pretty print for readability
            console.log("--- End Stringified Preview ---");

             fetch("https://script.google.com/macros/s/AKfycbwYBCAPSat5TL-OdKt91VEVypjC3Ki4Up09thKroTWYr9IFvaca-BvLN1WKkR1rvuGs/exec", { // YOUR SCRIPT URL
                 method: "POST",
                 headers: { "Content-Type": "text/plain" }, // Keep as text/plain
                 body: JSON.stringify(formData), // Send the stringified object
             })
            .then(response => {
                 console.log("Received response from server. Status:", response.status);
                 if (!response.ok) {
                     // Try to get text even on error for more info
                     return response.text().then(text => {
                         console.error("Server returned an error response text:", text);
                         throw new Error(`HTTP error ${response.status}: ${response.statusText}. Server Response: ${text}`);
                     }).catch(() => { // Fallback if text() fails
                         throw new Error(`HTTP error! Status: ${response.status} ${response.statusText}`);
                     });
                 }
                 return response.json(); // Assuming success response is JSON
            })
            .then(data => {
                 console.log("Parsed JSON response from server:", data);
                 if (data.status === 'success' || data.result === 'success') {
                     console.log("Data saved successfully!", data.message || 'No message provided.'); alert("PDF downloaded and data saved successfully!");
                     // Clear form (make sure clearAllFormInputs works correctly)
                     clearAllFormInputs();
                     resetHighlightedFields();
                     updateOverallPerformance(); // Recalculate overall performance display
                 } else {
                     // Handle cases where server responds 200 OK but reports an error in JSON
                     console.error("Server reported an issue in JSON response:", data);
                     throw new Error(`Server reported an issue: ${data.message || data.result || 'Unknown server response status.'}`);
                 }
            })
            .catch(error => {
                console.error("Error during fetch or processing:", error);
                alert(`Error saving data: ${error.message}. Please check the browser console and Apps Script logs for details.`);
            });
        }


        function clearEmployeeFields() { /* ... Function unchanged ... */
            document.getElementById("emp-name").value = ''; document.getElementById("position-text").value = ''; document.getElementById("emp-group").value = ''; document.getElementById("division-text").value = ''; document.getElementById("department-text").value = ''; document.getElementById("email").value = ''; document.getElementById("contact").value = ''; document.getElementById("employee-number-signature").value = ''; document.getElementById("employee-name-signature").value = ''; document.getElementById("position-signature").value = '';
            // --- ADDED: Clear Reviewer, Witness, and HOD fields when Employee# changes ---
            document.getElementById("reviewer-number").value = ''; // Clear reviewer ID input
            clearReviewerFields(); // Clear reviewer name/signature
             document.getElementById("employee-number-2").value = ''; // Clear witness 1 ID
             document.getElementById("employee-name-2").value = '';
             document.getElementById("position-2").value = '';
             document.getElementById("employee-number-3").value = ''; // Clear witness 2 ID
             document.getElementById("employee-name-3").value = '';
             document.getElementById("position-3").value = '';
             document.getElementById("hod-number").value = ''; // Clear HOD ID
             document.getElementById("hod-name").value = '';
             document.getElementById("hod-position").value = '';
             // --- END ADDED ---
         }
        function clearReviewerFields() { /* ... Function unchanged ... */
             document.getElementById("reviewer-name").value = ''; document.getElementById("reviewer-number-signature").value = ''; document.getElementById("reviewer-name-signature").value = ''; document.getElementById("reviewer-position-signature").value = '';
         }
        function clearSignatureFields() { /* ... Function unchanged ... */
            document.getElementById("employee-number-2").value = ''; document.getElementById("employee-name-2").value = ''; document.getElementById("position-2").value = ''; document.getElementById("employee-number-3").value = ''; document.getElementById("employee-name-3").value = ''; document.getElementById("position-3").value = ''; document.getElementById("hod-number").value = ''; document.getElementById("hod-name").value = ''; document.getElementById("hod-position").value = ''; const sigPlaceholders = document.querySelectorAll('.approval-signature-table input[placeholder="SIGNATURE / DATE"]'); sigPlaceholders.forEach(input => input.value = '');
         }

        // --- VALIDATION FUNCTIONS ---
        function validateForm() { /* ... Modified to use currentFormType ... */
            let isValid = true;
            resetHighlightedFields();

            const requiredInputs = document.querySelectorAll('#evaluation-form-container .required'); // Scope to the form container
            requiredInputs.forEach(input => {
                 if (input.id === 'review-date-header') {
                    if (!input.value) { isValid = false; highlightField(input.closest('.ac-review-date')); }
                 } else if (!input.value.trim()) { isValid = false; highlightField(input); }
            });

            // Validate ratings and employee comments for the current form type
            if (currentFormType && allMetricsData[currentFormType]) {
                const currentMetrics = allMetricsData[currentFormType];
                currentMetrics.forEach((metric, index) => {
                    const metricBox = metricsContainer.querySelector(`.performance-feedback:nth-of-type(${index + 1})`);
                    if (metricBox) {
                        const radioName = `rating-${currentFormType.replace(/\s+/g, '-')}-${index}`;
                        const commentId = `comments-${currentFormType.replace(/\s+/g, '-')}-${index}`;
                        const selectedRating = metricBox.querySelector(`input[name="${radioName}"]:checked`);
                        const employeeComments = metricBox.querySelector(`#${commentId}`);

                        if (!selectedRating) {
                            isValid = false;
                            const ratingContainer = metricBox.querySelector('.metric-rating-box');
                            if(ratingContainer) ratingContainer.classList.add("highlighted");
                        }
                        if (employeeComments && !employeeComments.value.trim()) {
                            isValid = false;
                            highlightField(employeeComments);
                        }
                    }
                });
            } else {
                 console.warn("Validation check skipped for metrics: No current form type or metrics defined.");
            }


             const remarks = document.getElementById("remarks");
             if (remarks && !remarks.value.trim()) { isValid = false; highlightField(remarks); }

             if (!isValid) {
                 alert("Please fill in all highlighted required fields (marked with *) and select a rating for each metric.");
                 const firstError = document.querySelector('#evaluation-form-container .highlighted');
                 if (firstError) { firstError.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
             }
            return isValid;
         }
        function highlightField(element) { if(!element) return; element.classList.add("highlighted"); }
        function resetHighlightedFields() { /* ... Function unchanged ... */
            const highlighted = document.querySelectorAll('#evaluation-form-container .highlighted'); // Scope to the correct container ID
            highlighted.forEach(element => {
                 element.classList.remove('highlighted');
                 // Reset specific border/box-shadow styles if they were specifically added by highlightField
                 // Since highlightField only adds the class, this class removal should be enough
                 // But if direct styles were added, they'd need resetting here.
                if (element.classList.contains('metric-rating-box')) {
                     element.style.borderColor = ''; // Let CSS default take over (or reapply purple if needed)
                 } else if (element.classList.contains('ac-review-date')) {
                     element.style.border = ''; // Let CSS default take over
                     element.style.boxShadow = '';
                 } else {
                      element.style.borderColor = ''; // Let CSS default take over
                 }
            });
         }

        // --- FETCH & POPULATE DATA ---
        let employeeData = []; let userData = [];
        const employeeNumberInput = document.getElementById("emp-number"); const employeeNameInput = document.getElementById("emp-name"); const positionTextInput = document.getElementById("position-text"); const employeeGroupInput = document.getElementById("emp-group"); const divisionTextInput = document.getElementById("division-text"); const departmentTextInput = document.getElementById("department-text"); const emailInput = document.getElementById("email"); const contactInput = document.getElementById("contact");
        const googleSheetsUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQdxa99pRN_wDel4uOm07GpSSi8YcHP4Q9z-7h7hD70gIeqyhY6QcWoxDjHKn8EGiUdnkNLDOdOY2Fu/pub?output=csv";
        const usersGoogleSheetsUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQbER5yTvms6Xt2DMLUeE3nTS2jhiO6c81vd3uSlKGqzM7qFHgxgNhP0Hho4AXo1dL0D53RqjYO3nK8/pub?output=csv";

        function fetchEmployeeData() { /* ... Function unchanged ... */
            console.log("Fetching Employee Data..."); return fetch(googleSheetsUrl) .then(response => { if (!response.ok) { throw new Error(`Network response was not ok for employee data: ${response.statusText}`); } return response.text(); }) .then(csvData => { employeeData = parseCSV(csvData); console.log(`Employee data loaded: ${employeeData.length} records.`); return employeeData; }) .catch(error => { console.error("Error fetching or parsing employee data:", error); alert("Failed to load employee data. Please check the console and ensure the Google Sheet URL is correct and published."); employeeData = []; });
        }
        function fetchUserData() { /* ... Function unchanged ... */
             console.log("Fetching User Data..."); return fetch(usersGoogleSheetsUrl) .then(response => { if (!response.ok) { throw new Error(`Network response was not ok for user data: ${response.statusText}`); } return response.text(); }) .then(csvData => { userData = parseUsersCSV(csvData); console.log(`User data loaded: ${userData.length} records.`); return userData; }) .catch(error => { console.error("Error fetching or parsing user data:", error); alert("Failed to load user authentication data. Please check the console and ensure the Google Sheet URL is correct and published."); userData = []; });
         }
        function parseCSV(csv) { /* ... Function unchanged ... */
            const lines = csv.split(/[\r\n]+/).filter(line => line.trim() !== ''); if (lines.length < 1) return []; const headers = lines[0].split(",").map(header => header.trim()); console.log("Parsed CSV Headers:", headers); const result = []; for (let i = 1; i < lines.length; i++) { const obj = {}; const currentLine = lines[i].split(","); if (currentLine.length >= headers.length) { for (let j = 0; j < headers.length; j++) { const headerKey = headers[j]; obj[headerKey] = currentLine[j] ? currentLine[j].trim() : ""; } result.push(obj); } else if (lines[i].trim()) { console.warn(`Skipping line ${i + 1} in Employee Data due to mismatched columns. Expected ${headers.length}, got ${currentLine.length}. Line: `, lines[i]); } } return result;
        }
        function parseUsersCSV(csv) { /* ... Function unchanged ... */
             const lines = csv.split(/[\r\n]+/).filter(line => line.trim() !== ''); if (lines.length < 1) return []; const headers = lines[0].split(',').map(header => header.trim()); const users = []; for (let i = 1; i < lines.length; i++) { const data = lines[i].split(','); if (data.length >= headers.length) { const user = {}; headers.forEach((header, j) => { user[header] = data[j] ? data[j].trim() : ''; }); users.push(user); } else if (lines[i].trim()){ console.warn(`Skipping line ${i+1} in User Data due to mismatched columns. Expected ${headers.length}, got ${data.length}. Line: `, lines[i]); } } return users;
         }

        // --- Population Function (Uses correct keys based on mapping) ---
        function populateEmployeeDetails(empNumber) {
             console.log("Populating details for:", empNumber);
             clearEmployeeFields(); // Clears all related fields now

             if (!empNumber) { console.log("Employee number cleared."); return; }
             if (!employeeData || employeeData.length === 0) { console.warn("Employee data not ready or empty."); return; }
             if (!currentFormType) { console.warn("Cannot check applicability: currentFormType not set."); return; }

             const employee = employeeData.find(emp => emp && emp["Employee Number"] === empNumber);

             if (employee) {
                 console.log("Employee object found:", employee);
                 const targetForm = currentFormType;

                 // Ensure applicability keys match CSV headers EXACTLY
                 const app1 = employee["Forms applicability 1"]?.trim() || "";
                 const app2 = employee["Forms applicability 2"]?.trim() || "";
                 const app3 = employee["Forms applicability 3"]?.trim() || "";
                 console.log("Applicability Check:", {app1, app2, app3}, "Target:", targetForm);

                 if (app1 === targetForm || app2 === targetForm || app3 === targetForm) {
                     console.log(`Employee IS applicable for ${targetForm} form.`);
                     employeeNameInput.value = employee["Employee Name"] || "";
                     positionTextInput.value = employee["Position Text"] || "";
                     employeeGroupInput.value = employee["Employee Group"] || "";
                     divisionTextInput.value = employee["Division"] || "";
                     departmentTextInput.value = employee["Department"] || "";
                     emailInput.value = employee["Email ID"] || "";
                     contactInput.value = employee["Contact Number"] || "";

                     console.log('Assigning Employee Group:', employee["Employee Group"]);
                     console.log('Assigning Position:', employee["Position Text"]);
                     console.log('Assigning Division:', employee["Division"]);
                     console.log('Assigning Department:', employee["Department"]);
                     console.log('Assigning Email ID:', employee["Email ID"]);
                     console.log('Assigning Contact Number:', employee["Contact Number"]);

                     document.getElementById("employee-number-signature").value = empNumber;
                     document.getElementById("employee-name-signature").value = employee["Employee Name"] || "";
                     document.getElementById("position-signature").value = employee["Position Text"] || "";
                 } else {
                     console.log(`Employee IS NOT applicable for ${targetForm} form.`);
                     alert(`Employee ${empNumber} (${employee["Employee Name"] || 'N/A'}) is not designated for the ${targetForm} evaluation form.`);
                 }
             } else {
                 console.log("Employee not found in data.");
                 alert(`Employee number ${empNumber} not found in the database.`);
             }
         }

        // UPDATED Signature functions to use "Position Text"
        function populateReviewerSignature(reviewer = null) { /* ... Function unchanged ... */
             const reviewerNumber = document.getElementById("reviewer-number").value; const reviewerName = document.getElementById("reviewer-name").value; document.getElementById("reviewer-number-signature").value = reviewerNumber; document.getElementById("reviewer-name-signature").value = reviewerName; let reviewerPosition = ""; if (reviewer) { reviewerPosition = reviewer["Position Text"] || ""; } else if (reviewerNumber && employeeData.length > 0 && !reviewerName) { const foundReviewer = employeeData.find(emp => emp && emp["Employee Number"] === reviewerNumber); if (foundReviewer) { reviewerPosition = foundReviewer["Position Text"] || ""; } } document.getElementById("reviewer-position-signature").value = reviewerPosition;
         }
        function populateSignatureDetails(witnessNumber, nameInputId, positionInputId) { /* ... Function unchanged ... */
            const nameInput = document.getElementById(nameInputId); const posInput = document.getElementById(positionInputId); if (!nameInput || !posInput) return false; nameInput.value = ""; posInput.value = ""; if (!witnessNumber) return true; if (!employeeData || employeeData.length === 0) { console.warn("Employee data not ready for witness lookup."); return true; } const mainEmpNo = document.getElementById("emp-number").value; const reviewerNo = document.getElementById("reviewer-number").value; const witness2NoInput = document.getElementById("employee-number-2"); const witness3NoInput = document.getElementById("employee-number-3"); const witness2No = witness2NoInput.value; const witness3No = witness3NoInput.value; let validationError = ""; if (witnessNumber === mainEmpNo && mainEmpNo) { validationError = "Witness cannot be the employee being evaluated."; } else if (witnessNumber === reviewerNo && reviewerNo) { validationError = "Witness cannot be the reviewer."; } else if (nameInputId === 'employee-name-2' && witnessNumber === witness3No && witness3No) { validationError = "Witnesses cannot be the same person."; } else if (nameInputId === 'employee-name-3' && witnessNumber === witness2No && witness2No) { validationError = "Witnesses cannot be the same person."; } if (validationError) { alert(validationError); if (nameInputId === 'employee-name-2') witness2NoInput.value = ''; else if (nameInputId === 'employee-name-3') witness3NoInput.value = ''; return false; } const employee = employeeData.find(emp => emp && emp["Employee Number"] === witnessNumber); if (employee) { nameInput.value = employee["Employee Name"] || ""; posInput.value = employee["Position Text"] || ""; } else { alert(`Witness Employee ID ${witnessNumber} not found.`); } return true;
        }
        function populateHODDetails(hodNumber) { /* ... Function unchanged ... */
             const hodNameInput = document.getElementById("hod-name"); const hodPosInput = document.getElementById("hod-position"); hodNameInput.value = ""; hodPosInput.value = ""; if (!hodNumber) return true; if (!employeeData || employeeData.length === 0) { console.warn("Employee data not ready for HOD lookup."); return true; } const mainEmpNo = document.getElementById("emp-number").value; const reviewerNo = document.getElementById("reviewer-number").value; const witness2No = document.getElementById("employee-number-2").value; const witness3No = document.getElementById("employee-number-3").value; let validationError = ""; if (hodNumber === mainEmpNo && mainEmpNo) { validationError = "HOD cannot be the employee being evaluated."; } else if (hodNumber === reviewerNo && reviewerNo) { validationError = "HOD cannot be the reviewer."; } else if (hodNumber === witness2No && witness2No) { validationError = "HOD cannot be Witness 1."; } else if (hodNumber === witness3No && witness3No) { validationError = "HOD cannot be Witness 2."; } if (validationError) { alert(validationError); document.getElementById("hod-number").value = ''; return false; } const employee = employeeData.find(emp => emp && emp["Employee Number"] === hodNumber); if (employee) { hodNameInput.value = employee["Employee Name"] || ""; hodPosInput.value = employee["Position Text"] || ""; } else { alert(`HOD Employee ID ${hodNumber} not found.`); } return true;
         }
        function populateReviewerDetails(reviewerNumber) { /* ... Function unchanged ... */
             const reviewerNameInput = document.getElementById("reviewer-name"); clearReviewerFields(); if (!reviewerNumber) return true; if (!employeeData || employeeData.length === 0) { console.warn("Employee data not ready for reviewer lookup."); return true; } const reviewer = employeeData.find(e => e && e["Employee Number"] === reviewerNumber); if (reviewer) { const empNo = document.getElementById("emp-number").value; if (reviewerNumber === empNo && empNo) { alert("Reviewer cannot be the same as the employee being evaluated."); document.getElementById("reviewer-number").value = ""; return false; } reviewerNameInput.value = reviewer["Employee Name"] || ""; populateReviewerSignature(reviewer); } else { alert(`Reviewer Employee ID ${reviewerNumber} not found.`); } return true;
         }

        // --- Event Listeners (Includes clearing of witness/hod on emp# change) ---
        employeeNumberInput.addEventListener("input", function() { const empNumber = this.value.trim(); this.value = empNumber.replace(/[^0-9]/g, ''); if (this.value.length === 6 || this.value.length === 0) { populateEmployeeDetails(this.value); } else { clearEmployeeFields(); } });
        document.getElementById("reviewer-number").addEventListener("input", function() { const reviewerEmpNumber = this.value.trim(); this.value = reviewerEmpNumber.replace(/[^0-9]/g, ''); if (this.value.length === 6 || this.value.length === 0) { populateReviewerDetails(this.value); } else { clearReviewerFields(); } });
        document.getElementById("employee-number-2").addEventListener("input", function() { const witnessEmpNumber = this.value.trim(); this.value = witnessEmpNumber.replace(/[^0-9]/g, ''); if(this.value.length === 6 || this.value.length === 0){ populateSignatureDetails(this.value, "employee-name-2", "position-2"); } else { document.getElementById("employee-name-2").value = ''; document.getElementById("position-2").value = ''; } });
        document.getElementById("employee-number-3").addEventListener("input", function() { const witnessEmpNumber = this.value.trim(); this.value = witnessEmpNumber.replace(/[^0-9]/g, ''); if(this.value.length === 6 || this.value.length === 0){ populateSignatureDetails(this.value, "employee-name-3", "position-3"); } else { document.getElementById("employee-name-3").value = ''; document.getElementById("position-3").value = ''; } });
        document.getElementById("hod-number").addEventListener("input", function() { const hodEmpNumber = this.value.trim(); this.value = hodEmpNumber.replace(/[^0-9]/g, ''); if(this.value.length === 6 || this.value.length === 0){ populateHODDetails(this.value); } else { document.getElementById("hod-name").value = ''; document.getElementById("hod-position").value = ''; } });
        document.addEventListener('click', function(event) { document.querySelectorAll('.suggestions').forEach(box => { if (box.style.display === 'block' && !box.contains(event.target) && !event.target.closest('td')?.contains(box)) { box.style.display = 'none'; } }); });

        // --- Initial data fetch & Login on Enter ---
        document.addEventListener('DOMContentLoaded', () => {
            Promise.all([fetchEmployeeData(), fetchUserData()])
                .then(() => { console.log("Initial data fetch complete on DOMContentLoaded."); })
                .catch(error => { console.error("Error during initial data fetch:", error); alert("Critical error loading initial data. Application might not function correctly. Please check console and refresh."); });

            // --- Add Login on Enter Key Listener ---
            const passwordInput = document.getElementById('password');
            const usernameInput = document.getElementById('username');
             const handleLoginEnter = (event) => { if (event.key === 'Enter' || event.keyCode === 13) { event.preventDefault(); console.log("Enter key pressed on login field, attempting login..."); authenticateUser(); } };
             if (passwordInput) { passwordInput.addEventListener('keydown', handleLoginEnter); }
             if (usernameInput) { usernameInput.addEventListener('keydown', handleLoginEnter); }
             // --- End Login on Enter Key Listener ---
        });

        // --- Authentication ---
        window.authenticateUser = function() { /* ... Function unchanged ... */ if (!userData || userData.length === 0) { alert("User authentication data not loaded. Please wait or try refreshing."); return; } const username = document.getElementById('username').value; const password = document.getElementById('password').value; const loginMessage = document.getElementById('login-message'); loginMessage.textContent = ''; if (!username.trim() || !password.trim()) { loginMessage.textContent = 'Please enter User Name and Password.'; loginMessage.className = 'error'; return; } const user = userData.find(u => u && u['User ID'] === username); if (!user) { console.warn(`Login attempt failed: User '${username}' not found.`); loginMessage.textContent = 'Authorization error. Contact Admin.'; loginMessage.className = 'error'; return; } if (user['Password'] === password) { console.log(`User '${username}' authenticated successfully.`); loginMessage.textContent = 'Login successful!'; loginMessage.className = 'success'; setTimeout(showWelcomeMessage, 500); } else { console.warn(`Login attempt failed: Incorrect password for User '${username}'.`); loginMessage.textContent = 'Password incorrect.'; loginMessage.className = 'error'; } }
        function showWelcomeMessage() { /* ... Function unchanged ... */ document.getElementById('login-container').style.display = 'none'; document.getElementById('welcome-message-container').style.display = 'flex'; document.querySelectorAll('.background-panel').forEach(p => p.style.display = 'none'); const loginMessage = document.getElementById('login-message'); loginMessage.textContent = ''; loginMessage.className = ''; }
    </script>

</body>
</html>
