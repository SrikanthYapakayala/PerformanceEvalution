<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Employee Performance Evaluation</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <style>
    body {
    font-family: Arial, sans-serif;
    background-color: #f8f9fa;
    margin: 12px;
    font-size: 12px;
}

.container {
    width: 794px;
    margin: 0 auto;
    background-color: white;
    padding: 5px;
    border: 3px solid black;
    box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);
    box-sizing: border-box;
}
    .header-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border: 5px solid black;
        padding: 10px;
        background-color: #004085;
        color: white;
        font-weight: bold;
        text-align: center;
    }
    .header-title {
        font-size: 21px;
        flex-grow: 1;
        text-align: center;
    }
    .review-date {
        font-size: 14px;
        padding: 5px 10px;
        border: 2px solid white;
        border-radius: 5px;
        text-align: center; /* Center the entire content */
    }
    .section-header {
      font-size: 12px;
      font-weight: bold;
      padding: 3px;
      margin-top: 1px;
      margin-bottom: 1px;
      background-color: #d98e4f;
      color: white;
      border: 2px solid black;
      text-align: center;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 2px;
    }
    table,
th,
td {
    border: 1px solid black;
    padding: 4px;
    font-size: 11px;
}
    th {
        background-color: #004085;
        color: white;
        font-weight: bold;
        text-align: left;
    }
    table input, table select, table textarea {
        width: calc(104% - 16px);
        padding: 9px;
        border: 1px solid black;
        border-radius: 5px;
        box-sizing: border-box;
    }
    input, select, textarea {
        width: 100%;
        padding: 5px;
        border: 2px solid black;
        border-radius: 5px;
        box-sizing: border-box;
        font-size: 12px; /* Reduced font size to 12px */
    }

    /* Reduce font size for input fields within the first table */
    table:first-of-type input {
      font-size: 10px;
    }

    textarea {
        resize: vertical;
        max-width: 100%; /* Limit textarea width */
    }
    .metric-title {
      background-color: #ffa700;
  color: white;
  padding: 2px;
  font-weight: bold;
  margin-top: 1px;
  border-radius: 1px;
  border: 2px solid black;
  font-size: 14px;
    }
    .flex-container {
        display: flex;
        justify-content: space-between;
        margin: 10px 0;
    }
    .flex-item {
        width: 48%;
    }
    label {
        font-weight: bold;
        color: #004085;
    }
    .section-title {
        font-weight: bold;
        color: red;
        text-transform: uppercase;
    }
    .bold-text {
        font-weight: bold;
    }
    .download-button {
        background-color: #4CAF50;
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 20px auto;
        cursor: pointer;
        border-radius: 5px;
        display: block;
    }
    .star-rating {
        cursor: pointer;
    }
    .star {
        font-size: 20px;
        color: gray;
        margin-right: 2px;
    }
    .comments-container {
      display: flex;
      justify-content: space-evenly;
    }
    .comments-container div {
      width: 48%;
    }
    /* Style for placeholder inputs */
    .placeholder-input::placeholder {
        color: #999; /* Light gray color for placeholders */
    }
    .placeholder-input {
        width: calc(100% - 12px); /* Adjust width to account for padding */
        padding: 6px;
        margin-bottom: 5px; /* Add some spacing between inputs */
        box-sizing: content-box; /* Include padding and border in the element's total width and height */
    }
    /* Style for table cells in the signature section */
    #approval-signatures-section td {
        vertical-align: top; /* Align inputs to the top of the cell */
    }
  /* Reduce spacing between metric details */
.performance-feedback > div {
  margin-bottom: 1px; /* Adjust this value as needed */
}

.review-date input[type="date"] {
    display: block;
    margin: 5px auto 0; /* Add top margin for spacing, center horizontally */
}
#suggestions {
    position: absolute;
    border: 1px solid #ccc;
    background-color: white;
    display: none;
    max-height: 200px;
    overflow-y: auto;
    width: 200px;
    z-index: 100;
}

#suggestions div:hover {
    background-color: #f0f0f0;
}
  </style>
</head>
<body>
  <div class="container" id="form-container">
    <div class="header-container">
      <h2 class="header-title">EMPLOYEE PERFORMANCE EVALUATION FORM</h2>
      <div class="review-date">Review Date: <input type="date" /></div>
    </div>

    <div class="section-header" id="personal-details">EMPLOYEE PERSONAL DETAILS</div>
    <table>
      <tr>
        <td class="bold-text">Employee Number</td>
        <td><input type="text" id="emp-number" /><div id="suggestions"></div></td>
        <td class="bold-text">Employee Name</td>
        <td><input type="text" id="emp-name" /></td>
      </tr>
      <tr>
        <td class="bold-text">Position Text</td>
        <td><input type="text" id="position-text" /></td>
        <td class="bold-text">Employee Group</td>
        <td><input type="text" id="emp-group" /></td>
      </tr>
      <tr>
        <td class="bold-text">Division Text</td>
        <td><input type="text" id="division-text" /></td>
        <td class="bold-text">Department Text</td>
        <td><input type="text" id="department-text" /></td>
      </tr>
      <tr>
        <td class="bold-text">Email ID</td>
        <td><input type="email" id="email" /></td>
        <td class="bold-text">Contact Number</td>
        <td><input type="text" id="contact" /></td>
      </tr>
      <tr>
        <td class="bold-text">Reviewed By</td>
        <td><input type="text" id="reviewed-by" /></td>
        <td class="bold-text">Review Date</td>
        <td><input type="date" id="review-date" /></td>
      </tr>
    </table>

    <div class="section-header" id="performance-metrics-header">PERFORMANCE METRICS</div>
    <div id="performance-metrics"></div>

    <div class="section-header" id="overall-performance-header">OVERALL EMPLOYEE PERFORMANCE</div>
    <p id="overall-performance">Not Rated</p>

    <div class="section-header">OVERALL REMARKS / COMMENTS</div>
    <textarea rows="4" id="remarks"></textarea>

    <div class="section-header">APPROVAL SIGNATURES</div>
    <table id="approval-signatures-section">
      <tr>
        <th>EMPLOYEE</th>
        <th>FIRST WITNESS</th>
        <th>SECOND WITNESS</th>
      </tr>
      <tr>
        <td>
          <input type="text" placeholder="NAME" class="placeholder-input" />
          <input type="text" placeholder="EMPLOYEE NUMBER" class="placeholder-input" />
          <input type="text" placeholder="POSITION / DESIGNATION" class="placeholder-input" />
          <input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" />
        </td>
        <td>
          <input type="text" placeholder="NAME" class="placeholder-input" />
          <input type="text" placeholder="EMPLOYEE NUMBER" class="placeholder-input" />
          <input type="text" placeholder="POSITION / DESIGNATION" class="placeholder-input" />
          <input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" />
        </td>
        <td>
          <input type="text" placeholder="NAME" class="placeholder-input" />
          <input type="text" placeholder="EMPLOYEE NUMBER" class="placeholder-input" />
          <input type="text" placeholder="POSITION / DESIGNATION" class="placeholder-input" />
          <input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" />
        </td>
      </tr>
    </table>

    <table>
      <tr>
        <th>REVIEWER</th>
        <th>EMPLOYEE</th>
      </tr>
      <tr>
        <td>
          <input type="text" placeholder="NAME" class="placeholder-input" />
          <input type="text" placeholder="EMPLOYEE NUMBER" class="placeholder-input" />
          <input type="text" placeholder="POSITION / DESIGNATION" class="placeholder-input" />
          <input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" />
        </td>
        <td>
          <input type="text" placeholder="NAME" class="placeholder-input" />
          <input type="text" placeholder="EMPLOYEE NUMBER" class="placeholder-input" />
          <input type="text" placeholder="POSITION / DESIGNATION" class="placeholder-input" />
          <input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" />
        </td>
      </tr>
    </table>
  </div>

  <button class="download-button" onclick="downloadPDF()">Download PDF</button>

  <script>
    // -----------------------------------------
    // 1) DEFINE METRICS & RENDER THEM IN DOM
    // -----------------------------------------
    const metrics = [
  {
    title: "1. TECHNICAL KNOWLEDGE",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>HVAC Systems Understanding:</b> Knowledge of various AC systems, including residential, commercial, and industrial units.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Diagnostics and Troubleshooting:</b> Ability to diagnose issues accurately using appropriate tools and techniques.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Electrical Knowledge:</b> Understanding of electrical components and wiring in HVAC systems, including capacitors, relays, and circuit boards.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Refrigeration Knowledge:</b> Familiarity with refrigeration cycles, refrigerants, and their proper handling and charging procedures.</div>
    `
  },
  {
    title: "2. HANDS-ON SKILLS",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Installation Skills:</b> Competence in installing AC units, including proper setup, connections, and system configuration.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Repair Skills:</b> Proficiency in repairing faulty components, including compressors, fans, coils, thermostats, and wiring.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Maintenance Skills:</b> Ability to perform routine maintenance tasks such as cleaning filters, coils, and condensers, checking refrigerant levels, and ensuring system efficiency.</div>
    `
  },
  {
    title: "3. PROBLEM-SOLVING ABILITY",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Diagnosing Complex Issues:</b> Ability to identify and troubleshoot complex mechanical or electrical problems.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Efficient Solutions:</b> Ability to devise practical, cost-effective solutions to fix problems or improve system performance.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Adaptability:</b> Adjusting solutions based on the specific needs of the environment (e.g., residential vs. commercial setups).</div>
    `
  },
  {
    title: "4. ATTENTION TO DETAIL",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Precision:</b> Ensuring all installations, repairs, and maintenance are completed accurately and to manufacturer specifications.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Safety Compliance:</b> Adhering to safety guidelines and protocols, such as handling refrigerants safely, working with electricity, and ensuring proper ventilation.</div>
    `
  },
  {
    title: "5. CUSTOMER SERVICE SKILLS",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Communication:</b> Explaining technical issues and solutions to customers in an understandable and professional manner.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Professionalism:</b> Maintaining a courteous, friendly, and respectful demeanor when interacting with customers, whether on-site or over the phone.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Customer Education:</b> Offering advice on system maintenance, energy-saving tips, and how to operate AC units properly.</div>
    `
  },
  {
    title: "6. TIME MANAGEMENT",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Efficiency:</b> Completing tasks within the expected time frame, ensuring minimal disruption to the customer’s daily activities.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Prioritization:</b> Managing multiple service calls, balancing urgent repairs with routine maintenance without compromising quality.</div>
    `
  },
  {
    title: "7. KNOWLEDGE OF CODES AND REGULATIONS",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Local Codes and Standards:</b> Knowledge of local, state, and federal regulations regarding HVAC systems, such as installation codes, refrigerant handling, and energy efficiency standards.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Permit Requirements:</b> Understanding when and how to obtain necessary permits for installation or repairs.</div>
    `
  },
  {
    title: "8. PHYSICAL AND MANUAL DEXTERITY",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Physical Stamina:</b> Ability to work in challenging physical environments (e.g., rooftops, basements, attics) and handle heavy equipment.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Precision Handling:</b> Skill in using tools such as wrenches, pressure gauges, thermometers, and soldering tools.</div>
    `
  },
  {
    title: "9. SAFETY AWARENESS",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Workplace Safety:</b> Consistently following safety protocols, such as wearing personal protective equipment (PPE), handling hazardous materials properly, and ensuring workspaces are safe.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Hazard Prevention:</b> Recognizing and mitigating potential safety hazards, such as electrical risks, refrigerant leaks, or improper ventilation.</div>
    `
  },
  {
    title: "10. TROUBLESHOOTING EFFICIENCY",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Speed:</b> The ability to identify problems and fix them quickly, minimizing downtime for the customer.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Comprehensive Troubleshooting:</b> Not only fixing the immediate issue but also identifying any other potential problems or areas for improvement.</div>
    `
  },
  {
    title: "11. QUALITY OF WORK",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Durability of Work:</b> Ensuring repairs and installations are durable, minimizing the need for repeat visits or fixes.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Attention to Detail:</b> Thoroughness in performing repairs and maintenance, ensuring all components are functioning properly.</div>
    `
  },
  {
    title: "12. ADAPTABILITY AND CONTINUED LEARNING",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Staying Current:</b> Keeping up to date with the latest AC technologies, refrigerants, and industry trends.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Certifications:</b> Having relevant certifications such as EPA 608 (for refrigerant handling), NATE (North American Technician Excellence), or HVACR certifications that demonstrate competence and knowledge.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Training and Development:</b> Willingness to participate in ongoing training or workshops to enhance skills and knowledge.</div>
    `
  },
  {
    title: "13. PERFORMANCE METRICS",
    details: `
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Customer Satisfaction:</b> Positive feedback from clients regarding service quality, communication, and reliability.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>First-Time Fix Rate:</b> The percentage of issues resolved on the first visit.</div>
      <div style="border: 1px solid #ddd; padding: 5px; margin: 0; margin-bottom: 3px;"><b>Work Completion Rate:</b> Successful completion of jobs without the need for rework.</div>
    `
  }
];

const metricsContainer = document.getElementById("performance-metrics");
const overallPerformanceText = document.getElementById("overall-performance");

// Dynamically insert each metric into the DOM
metrics.forEach((metric, index) => {
    const metricDiv = document.createElement("div");
    metricDiv.classList.add("performance-feedback");
    metricDiv.innerHTML = `
        <div class="metric-title"><b>${metric.title}</b></div>
        <p>${metric.details}</p>
        <div class="feedback-container" data-metric-index="${index}" data-rating="0">
            <div class="star-rating">
                <span class="star" data-value="1">★</span>
                <span class="star" data-value="2">★</span>
                <span class="star" data-value="3">★</span>
                <span class="star" data-value="4">★</span>
                <span class="star" data-value="5">★</span>
            </div>
            <span class="feedback-text" id="feedback-desc-${index}">Not Rated</span>
        </div>
        <div class="comments-container">
            <div>
                <label for="comments-${index}"><b>Employee Comments:</b></label>
                <textarea id="comments-${index}" rows="4" placeholder="Enter your comments here..."></textarea>
            </div>
            <div>
                <label for="hr-comments-${index}"><b>HR Comments:</b></label>
                <textarea id="hr-comments-${index}" rows="4" placeholder="Enter HR comments here..."></textarea>
            </div>
        </div>
    `;
    metricsContainer.appendChild(metricDiv);
});
// -----------------------------------------
// 2) STAR RATINGS LOGIC
// -----------------------------------------
metricsContainer.addEventListener("click", function (event) {
    if (event.target.classList.contains("star")) {
        const star = event.target;
        const starContainer = star.closest(".feedback-container");
        const metricIndex = starContainer.dataset.metricIndex;
        const selectedValue = star.dataset.value;
        highlightStars(starContainer, selectedValue);
        updateFeedback(metricIndex, selectedValue);
        starContainer.dataset.rating = selectedValue;
        updateOverallPerformance();
    }
});

function highlightStars(starContainer, selectedValue) {
    const stars = starContainer.querySelectorAll(".star");
    stars.forEach((star) => {
        const starValue = star.dataset.value;
        star.style.color = starValue <= selectedValue ? "gold" : "gray";
    });
}

function updateFeedback(index, value) {
    const feedbackDesc = document.getElementById(`feedback-desc-${index}`);
    const descriptions = {
        "1": "Poor Performance",
        "2": "Average Performance - Needs Improvement",
        "3": "Good Performance",
        "4": "Very Good Performance",
        "5": "Excellent Performance",
    };
    feedbackDesc.textContent = descriptions[value] || "Not Rated";
}

function updateOverallPerformance() {
    const starContainers = metricsContainer.querySelectorAll(".feedback-container");
    const ratings = Array.from(starContainers, (container) =>
        parseInt(container.dataset.rating) || 0
    ).filter((rating) => rating > 0);

    if (ratings.length === metrics.length) {
        const average = ratings.reduce((a, b) => a + b, 0) / ratings.length;
        const roundedAverage = Math.round(average);
        const descriptions = {
            1: "Poor Performance",
            2: "Average Performance - Needs Improvement",
            3: "Good Performance",
            4: "Very Good Performance",
            5: "Excellent Performance",
        };
        overallPerformanceText.textContent = descriptions[roundedAverage] || "Not Rated";
    } else {
        overallPerformanceText.textContent = "Please rate all metrics.";
    }
}

// -----------------------------------------
// 3) DOWNLOAD PDF USING html2pdf.js
// -----------------------------------------
function downloadPDF() {
    const element = document.getElementById("form-container");

    const opt = {
        margin: [0, 0, 0, 0], // Adjusted margins
        filename: 'Employee_Performance_Evaluation.pdf',
        image: { type: 'jpeg', quality: 1.0, scale: 2, useCORS: true, scrollX: 0, scrollY: 0, x: 0, y: 0 }, //Reduced scale to 2
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
        pagebreak: { mode: 'avoid-all'}
    };
    const body = document.querySelector('body');
    const originalMargin = body.style.margin;
    body.style.margin = '0';
    html2pdf().from(element).set(opt).save().then(()=>{
        body.style.margin = originalMargin;
    });
}
// -----------------------------------------
    // 4) FETCH & POPULATE EMPLOYEE DATA
    // -----------------------------------------
    let employeeData = [];

const employeeNumberInput = document.getElementById("emp-number");
const employeeNameInput = document.getElementById("emp-name");
const positionTextInput = document.getElementById("position-text");
const employeeGroupInput = document.getElementById("emp-group");
const divisionTextInput = document.getElementById("division-text");
const departmentTextInput = document.getElementById("department-text");
const emailInput = document.getElementById("email");
const contactInput = document.getElementById("contact");
const suggestionsDiv = document.getElementById("suggestions");

const googleSheetsUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQdxa99pRN_wDel4uOm07GpSSi8YcHP4Q9z-7h7hD70gIeqyhY6QcWoxDjHKn8EGiUdnkNLDOdOY2Fu/pub?output=csv";

function fetchEmployeeData() {
  return fetch(googleSheetsUrl)
    .then(response => response.text())
    .then(csvData => {
      employeeData = parseCSV(csvData);
      return employeeData;
    })
    .catch(error => console.error("Error fetching employee data:", error));
}

function parseCSV(csv) {
  const lines = csv.split("\n");
  const headers = lines[0].split(",");
  const result = [];

  for (let i = 1; i < lines.length; i++) {
    const obj = {};
    const currentLine = lines[i].split(",");

    for (let j = 0; j < headers.length; j++) {
      obj[headers[j].trim()] = currentLine[j] ? currentLine[j].trim() : "";
    }
    result.push(obj);
  }
  return result;
}

function populateEmployeeDetails(empNumber) {
  const employee = employeeData.find(emp => emp["Employee Number"] === empNumber);

  if (employee) {
    employeeNameInput.value = employee["Employee Name"];
    positionTextInput.value = employee["Position Text"];
    employeeGroupInput.value = employee["Employee Group"];
    divisionTextInput.value = employee["Division Text"];
    departmentTextInput.value = employee["Department Text"];
    emailInput.value = employee["Email ID"] || "";
    contactInput.value = employee["Contact Number"] || "";

    employeeNameInput.readOnly = true;
    positionTextInput.readOnly = true;
    employeeGroupInput.readOnly = true;
    divisionTextInput.readOnly = true;
    departmentTextInput.readOnly = true;
  } else {
    employeeNameInput.value = "";
    positionTextInput.value = "";
    employeeGroupInput.value = "";
    divisionTextInput.value = "";
    departmentTextInput.value = "";
    emailInput.value = "";
    contactInput.value = "";

    employeeNameInput.readOnly = false;
    positionTextInput.readOnly = false;
    employeeGroupInput.readOnly = false;
    divisionTextInput.readOnly = false;
    departmentTextInput.readOnly = false;
  }
}

employeeNumberInput.addEventListener("input", function () {
    const empNumber = this.value;

    if (empNumber.length > 6) {
        this.value = empNumber.slice(0, 6);
        alert("Employee number cannot exceed 6 digits.");
        return;
    }

    populateEmployeeDetails(empNumber);
    showSuggestions(empNumber);
});

function showSuggestions(input) {
    suggestionsDiv.innerHTML = "";

    if (input.trim() === "") {
        suggestionsDiv.style.display = "none";
        return;
    }

    const matchingEmployees = employeeData.filter(emp =>
        emp["Employee Number"].startsWith(input)
    );

    if (matchingEmployees.length > 0) {
        matchingEmployees.slice(0, 10).forEach(emp => {
            const suggestionItem = document.createElement("div");
            suggestionItem.textContent = emp["Employee Number"];
            suggestionItem.style.padding = "5px";
            suggestionItem.style.cursor = "pointer";

            suggestionItem.addEventListener("click", function () {
                employeeNumberInput.value = emp["Employee Number"];
                populateEmployeeDetails(emp["Employee Number"]);
                suggestionsDiv.style.display = "none";
            });

            suggestionsDiv.appendChild(suggestionItem);
        });

        suggestionsDiv.style.display = "block";
    } else {
        suggestionsDiv.style.display = "none";
    }
}

fetchEmployeeData().then(() => {
  // Data is fetched and parsed.
});
  </script>
</body>
</html>
