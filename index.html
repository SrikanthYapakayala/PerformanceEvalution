<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Performance Evaluation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
        integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* General styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            font-size: 10px; /* Base font size */
            overflow: auto;
            min-height: 100vh;
            background-color: #f0f2f5; /* Neutral fallback */
            transition: background 0.5s ease;
        }

        /* --- Animated Gradient Background --- */
        @keyframes gradientAnimation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body.gradient-background {
            background: linear-gradient(-45deg, #e0eafc, #cfdef3, #a7c5eb, #87a8d0); /* Softer blue/grey */
            background-size: 400% 400%;
            animation: gradientAnimation 25s ease infinite;
        }
        /* --- End Animated Gradient --- */

        /* --- Subtle Panel Breathing Animation --- */
        @keyframes panelBreathe {
            0%, 100% { transform: scale(1) rotate(var(--initial-rotate, 0deg)); }
            50% { transform: scale(1.015) rotate(var(--initial-rotate, 0deg)); }
        }
        /* --- End Panel Breathing --- */

        h1, h2, h3 { color: #343a40; text-align: center; }
        a { color: #007bff; text-decoration: none; transition: color 0.2s ease; }
        a:hover { text-decoration: underline; color: #0056b3; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #e9ecef; font-weight: bold; color: #495057; } /* Adjusted header bg */
        .button { background-color: #007bff; color: white; padding: 10px 16px; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease; }
        .button:hover { background-color: #0056b3; }
        input[type="text"], input[type="email"], input[type="date"], input[type="password"], textarea, select {
            width: 100%;
            padding: 9px; /* Slightly increased padding */
            margin-bottom: 10px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 12px;
            transition: border-color 0.2s ease, box-shadow 0.2s ease; /* Added transition */
        }
        input:focus, textarea:focus, select:focus {
            border-color: #86b7fe;
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25); /* Bootstrap focus color */
        }
        input[readonly], textarea[readonly] {
             background-color: #f8f9fa; /* Subtle grey for readonly */
             cursor: default; /* Default cursor */
             border-color: #dee2e6;
        }
        textarea { resize: vertical; min-height: 50px; } /* Set min-height */
        .container { /* General page container */
            width: 85%;
            max-width: 1200px;
            margin: 30px auto;
            background-color: white;
            padding: 30px; /* Increased padding */
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }

        /* Welcome Page Styles */
        #welcome-page {
            position: relative;
            width: 100%;
            min-height: 100vh;
            overflow: hidden;
            display: block;
        }

        #login-container {
            background-color: rgba(255, 255, 255, 0.88); /* Slightly more opaque */
            padding: 40px; /* Increased padding */
            border-radius: 15px; /* More rounding */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.28);
            width: 400px; /* Wider */
            text-align: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            backdrop-filter: blur(6px);
            -webkit-backdrop-filter: blur(6px);
            border: 1px solid rgba(255, 255, 255, 0.25);
        }
        .login-logo { margin-bottom: 30px; } .login-logo img { max-width: 350px; height: auto; }
        .login-input-group { margin-bottom: 22px; text-align: left; } .login-input-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #343a40; font-size: 15px; padding-left: 5px; }
        .login-input-group input[type="text"], .login-input-group input[type="password"] { width: 100%; padding: 13px; border: 1px solid #ced4da; border-radius: 6px; box-sizing: border-box; font-size: 14px; }
        .login-button {
            background-image: linear-gradient(to right, #007bff, #0056b3);
            color: white;
            padding: 14px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 17px;
            font-weight: 500;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 86, 179, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .login-button:hover {
            background-image: linear-gradient(to right, #0069d9, #004085);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 86, 179, 0.5);
        }
        .login-button:active { transform: translateY(0px); box-shadow: 0 1px 3px rgba(0, 86, 179, 0.3); }
        #login-message {
            margin-top: 18px; font-size: 14px; font-weight: 500; padding: 8px 12px; border-radius: 4px; display: none; /* Hidden initially, shown via JS */ align-items: center; gap: 8px; justify-content: center;
        }
        #login-message.error { display: flex; color: #721c24; background-color: #f8d7da; border: 1px solid #f5c6cb; }
        #login-message.success { display: flex; color: #155724; background-color: #d4edda; border: 1px solid #c3e6cb; }
        #login-message.error::before { content: "\f071"; font-family: "Font Awesome 6 Free"; font-weight: 900; }
        #login-message.success::before { content: "\f00c"; font-family: "Font Awesome 6 Free"; font-weight: 900; }


        /* Welcome Message Container (Post-Login) */
        @keyframes fadeInWelcome { from { opacity: 0; transform: translate(-50%, -45%); } to { opacity: 1; transform: translate(-50%, -50%); } } /* Adjusted transform */
        #welcome-message-container { /* Renamed class to avoid conflict */
            background-color: rgba(255, 255, 255, 0.75); /* Adjusted transparency */
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 45px;
            border-radius: 18px;
            text-align: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* Initial state for centering */
            z-index: 5;
            box-shadow: 0 10px 35px rgba(31, 38, 135, 0.25);
            display: none; /* Controlled by JS */
            flex-direction: column;
            align-items: center; /* Center content horizontally */
            justify-content: center; /* Center content vertically */
            height: auto;
            max-width: 600px; /* Added max-width */
            width: 90%; /* Responsive width */
            animation: fadeInWelcome 0.6s ease-out forwards;
        }
        .welcome-message { font-size: 2.7em; margin-bottom: 30px; color: #2c3e50; text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1); font-weight: 600;}
        .proceed-button {
            padding: 16px 40px;
            background-image: linear-gradient(to right, #28a745, #218838);
            color: white; border: none; border-radius: 8px; cursor: pointer; text-decoration: none; font-size: 1.3em; font-weight: 500; transition: all 0.3s ease; box-shadow: 0 2px 5px rgba(33, 136, 56, 0.4); display: inline-flex; align-items: center; gap: 10px;
        }
        .proceed-button:hover { background-image: linear-gradient(to right, #218838, #1e7e34); transform: translateY(-2px); box-shadow: 0 4px 8px rgba(33, 136, 56, 0.5); }
        .proceed-button a { color: white; text-decoration: none; }

        /* Background Panels - Added Breathing */
        .background-panel {
            position: absolute; width: 60%; height: 60%; overflow: hidden; transform-origin: center center; opacity: 0.65; border: none; box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2); display: block; z-index: 1; border-radius: 10px; transition: transform 0.4s ease-out, box-shadow 0.4s ease-out, opacity 0.4s ease; animation: panelBreathe 8s ease-in-out infinite alternate;
        }
        #panel1 { --initial-rotate: -6deg; animation-delay: 0s; top: -8%; left: -12%; width: 65%; height: 55%; transform: rotate(var(--initial-rotate)); }
        #panel2 { --initial-rotate: 5deg; animation-delay: -2s; top: -4%; right: -15%; width: 55%; height: 48%; transform: rotate(var(--initial-rotate)); }
        #panel3 { --initial-rotate: 4deg; animation-delay: -4s; bottom: -12%; left: -10%; width: 50%; height: 50%; transform: rotate(var(--initial-rotate)); }
        #panel4 { --initial-rotate: -4deg; animation-delay: -6s; bottom: -8%; right: -18%; width: 52%; height: 52%; transform: rotate(var(--initial-rotate)); }
        .background-panel img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s ease-out; }
        .background-panel:hover {
            opacity: 0.85; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3); transform: scale(1.03) rotate(calc(var(--initial-rotate) - 2deg)); animation-play-state: paused;
        }
        .background-panel:hover img { transform: scale(1.05); }


        /* Evaluation Form Container Styles */
        #evaluation-form-container {
            width: 794px; /* A4 width approx */
            margin: 30px auto; background-color: #ffffff; padding: 0; /* Remove padding, apply to inner */ border: 1px solid #ccc; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.18); box-sizing: border-box; display: none; outline: none; border-radius: 8px; position: relative; z-index: 10;
            border-top: 4px solid #004085; /* Added top border */
        }
        #form-container { padding: 5px 10px 10px 10px; /* Apply padding to inner container */ }
        .ac-header-container { display: flex; justify-content: space-between; align-items: center; border: none; /* Removed border */ border-bottom: 5px solid #343a40; padding: 8px 15px; /* Adjusted padding */ background-color: #004085; color: white; font-weight: bold; text-align: center; border-radius: 0; /* Remove rounding */ }
        #form-header-title { font-size: 17px; flex-grow: 1; text-align: center; color: white; letter-spacing: 0.5px;}
        .ac-review-date { font-size: 12px; padding: 5px 10px; border: 1px solid white; border-radius: 5px; text-align: center; background-color: rgba(255,255,255,0.1); margin-left: 10px; }
        .ac-review-date input[type="date"] { display: block; margin: 5px auto 0; border: 1px solid #ced4da; padding: 6px; font-size: 11px; border-radius: 3px; box-sizing: border-box; }
        .ac-section-header { font-size: 13px; font-weight: 600; padding: 6px 10px; margin-top: 18px; margin-bottom: 15px; /* Increased spacing */ background-color: #6c757d; /* Grey header */ color: white; border: 1px solid #5a6268; text-align: center; border-radius: 3px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .ac-table { width: 100%; border-collapse: collapse; margin-bottom: 8px; }
        .ac-table, .ac-table th, .ac-table td { border: 1px solid #dee2e6; /* Lighter border */ padding: 5px; /* Increased padding */ font-size: 11px; /* Slightly larger base */ }
        .ac-table th { background-color: #f8f9fa; color: #004085; font-weight: 600; text-align: left; padding: 6px; } /* Adjusted TH */
        .ac-table td { vertical-align: middle; word-break: break-word; position: relative; background-color: #fff; }
        /* Employee Detail Table */
        .ac-table:first-of-type { table-layout: fixed; width: 100%; border: 1px solid #adb5bd; /* Slightly darker border for this table */}
        .ac-table:first-of-type td { padding: 6px;}
        .ac-table:first-of-type td:nth-child(1), .ac-table:first-of-type td:nth-child(3) { width: 13%; font-weight: 600; color: #004085; padding-right: 8px; vertical-align: middle; font-size: 11px; background-color: #f8f9fa;} /* Label cells with subtle bg */
        .ac-table:first-of-type td:nth-child(2), .ac-table:first-of-type td:nth-child(4) { width: 32%; vertical-align: middle; }
        .ac-table:first-of-type td input[type="text"],
        .ac-table:first-of-type td input[type="email"] { width: 100%; box-sizing: border-box; margin-bottom: 0; padding: 7px; font-size: 11px; border: 1px solid #ced4da; border-radius: 3px;}
        .ac-table select, .ac-table textarea { width: 100%; padding: 7px; border: 1px solid #ced4da; border-radius: 4px; box-sizing: border-box; margin-bottom: 0; font-size: 11px;}
        /* Make readonly inputs in this table also have the bg */
         .ac-table:first-of-type td input[readonly] { background-color: #f8f9fa; cursor: default; }

        /* --- Rating Box & Metrics (Accordion Style) --- */
        .performance-feedback {
             border-bottom: 1px dashed #ccc; /* Separator */
             padding-bottom: 10px; /* Space below separator */
             margin-bottom: 10px; /* Space between metrics */
             overflow: hidden; /* Contain elements during transition */
        }
        .performance-feedback:last-child {
             border-bottom: none; /* No border for the last one */
             margin-bottom: 0;
             padding-bottom: 5px;
        }

        /* Metric Title as Toggle Button */
        .ac-metric-title.metric-toggle {
             background-color: #ff9800;
             color: white;
             padding: 6px 10px; /* Slightly more padding */
             font-weight: 600;
             margin-top: 5px;
             border-radius: 3px;
             border: 1px solid #e68a00;
             font-size: 12px;
             text-align: left; /* Align text left */
             margin-bottom: 0; /* Remove bottom margin, content handles spacing */
             cursor: pointer;
             display: flex; /* Use flexbox for alignment */
             justify-content: space-between; /* Space between title and icon */
             align-items: center; /* Center items vertically */
             transition: background-color 0.2s ease;
        }
        .ac-metric-title.metric-toggle:hover {
            background-color: #f57c00; /* Darker orange on hover */
        }
        .metric-indicator {
            font-size: 14px; /* Adjust icon size */
            margin-left: 10px; /* Space between text and icon */
            transition: transform 0.3s ease; /* Smooth rotation */
        }
        /* Rotate icon when expanded */
        .performance-feedback.expanded .metric-indicator {
             transform: rotate(180deg); /* Rotate chevron-down */
        }

        /* Collapsible Content Area */
        .metric-content {
             max-height: 0; /* Start collapsed */
             overflow: hidden;
             transition: max-height 0.4s ease-out, padding 0.4s ease-out; /* Smooth transition */
             padding: 0 10px; /* No padding when collapsed */
             background-color: #fdfdfe; /* Slightly off-white bg */
             border: 1px solid #eee;
             border-top: none; /* Avoid double border with title */
             border-radius: 0 0 4px 4px; /* Round bottom corners */
             margin-top: 0;
        }
        /* Expanded State */
        .performance-feedback.expanded .metric-content {
             max-height: 1000px; /* Allow it to grow (adjust if content is huge) */
             padding: 10px 10px 15px 10px; /* Add padding when expanded */
             transition: max-height 0.5s ease-in, padding 0.5s ease-in;
        }
        .metric-details-container { padding: 5px 0; font-size: 10px; margin-bottom: 10px; border-bottom: 1px dotted #ccc; } /* Keep details spacing */
        .metric-rating-box { border: 1px solid #d1c4e9; padding: 8px; margin: 0 0 12px 0; width: 100%; border-radius: 5px; box-sizing: border-box; background-color: #f8f9fa; }

        /* --- End Accordion Styles --- */

        /* Highlight Styles */
        input.highlighted, select.highlighted, textarea.highlighted, .metric-rating-box.highlighted, .ac-comments-container textarea.highlighted { border-color: #dc3545 !important; box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25); }
        .ac-review-date.highlighted { border: 2px solid #dc3545 !important; box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25); }
        /* Highlight for collapsed accordion title if content inside fails validation */
        .ac-metric-title.metric-toggle.highlighted {
            border-color: #dc3545 !important;
            box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
            background-color: #d9534f; /* Change background to indicate error */
        }

        /* Remove focus shadow from invalid required fields by default */
        input:required:invalid, textarea:required:invalid, select:required:invalid, input[type="date"]:required:invalid { box-shadow: none; }
        /* Set default border for required fields */
        input:required, textarea:required, select:required, input[type="date"]:required { border: 1px solid #ced4da; }
        /* Added: Specific style for email input (not required) */
        input#email { border: 1px solid #ced4da; }
        input#email:focus { border-color: #86b7fe; outline: 0; box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25); }


        /* label { font-weight: 600; color: #004085; font-size: 11px;} */ /* Moved below */
        .ac-bold-text { font-weight: 600; font-size: 11px; }
        .ac-download-button {
            background-image: linear-gradient(to right, #5cb85c, #4cae4c); border: none; color: white; padding: 12px 24px; text-align: center; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; gap: 8px; font-size: 15px; font-weight: 500; margin: 20px auto 10px auto; cursor: pointer; border-radius: 5px; display: block; transition: all 0.3s ease; box-shadow: 0 2px 5px rgba(76, 174, 76, 0.4);
        }
        .ac-download-button:hover { background-image: linear-gradient(to right, #4cae4c, #449d44); transform: translateY(-2px); box-shadow: 0 4px 8px rgba(76, 174, 76, 0.5); }
        .ac-comments-container { display: flex; justify-content: space-between; gap: 15px; margin-top: 10px; }
        .ac-comments-container div { width: calc(50% - 7.5px); }
        .placeholder-input::placeholder { color: #888; font-style: italic; } .placeholder-input { width: calc(100% - 16px); padding: 7px; margin-bottom: 7px; box-sizing: border-box; height: auto; border: 1px solid #ced4da; border-radius: 3px; font-size: 11px; }
        .approval-signature-table { width: 100%; table-layout: fixed; border-collapse: collapse; margin-bottom: 15px; margin-top: 5px; border: 1px solid #adb5bd; }
        .approval-signature-table th, .approval-signature-table td { border: 1px solid #adb5bd; padding: 8px; text-align: center; box-sizing: border-box; vertical-align: top; word-break: break-word; position: relative; }
        .approval-signature-table .placeholder-input { width: calc(100% - 16px); margin: 0 auto; text-align: center; padding: 8px; box-sizing: border-box; border: 1px solid #ccc; font-size: 11px; height: auto; white-space: normal; margin-bottom: 6px; background-color: #fff; }
        .approval-signature-table th { background-color: #fdcdab; /* Lighter salmon */ font-weight: 600; font-size: 11px; color: #5c3c20; }
        .approval-signature-table td { font-size: 10px; background-color: #fff; }
        #suggestions, .suggestions { display: none !important; } /* Keep suggestions hidden, managed by JS if needed */

        /* --- Rating Option Layout Refined --- */
        .rating-container { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .rating-scale { display: flex; justify-content: center; align-items: center; font-size: 10px; flex-wrap: wrap; gap: 8px; padding: 5px 0; }
        .rating-option { display: flex; flex-direction: row; align-items: center; justify-content: center; cursor: pointer; box-sizing: border-box; padding: 6px 10px; border-radius: 15px; transition: all 0.2s ease; width: auto; white-space: nowrap; margin: 0; border: 1px solid #ced4da; background-color: #fff; }
        .rating-option:hover { background-color: #e9ecef; border-color: #adb5bd; transform: translateY(-1px);}
        .rating-option.selected { background-color: #ffc107; color: #343a40; font-weight: 600; border-color: #ffb300; box-shadow: 0 2px 4px rgba(0,0,0,0.15); transform: translateY(-1px); }
        .rating-number { min-width: 22px; height: 22px; border: 1px solid #adb5bd; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 7px; background-color: #fff; font-weight: 600; transition: all 0.2s ease;}
        .rating-option.selected .rating-number { background-color: #343a40; color: #ffc107; border-color: #343a40; }
        .rating-option span.rating-text { font-size: 10px; color: #495057;}
        .rating-option.selected span.rating-text { color: #343a40; }
        input[type="radio"] { display: none; }
        /* --- End Rating Option Layout --- */

        .required-field::after { content: " *"; color: #dc3545; font-weight: bold; margin-left: 2px;}
        .suggestion-item { padding: 5px 8px; cursor: pointer; white-space: nowrap; font-size: 11px; }
        .suggestion-item:hover { background-color: #f0f0f0; }
        .approval-signature-table td { padding: 8px; }
        .approval-signature-table .placeholder-input { width: calc(100% - 16px); margin-bottom: 6px; padding: 8px;}
        .ac-comments-container div label { font-weight: 600; color: #004085; display: block; margin-bottom: 6px; font-size: 11px;} /* Slightly increased margin */
        .ac-comments-container textarea { width: 100%; padding: 8px; margin-bottom: 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; resize: vertical; font-size: 11px; min-height: 45px;} /* Slightly taller */


        /* Evaluation Page Grid Styles */
        #evaluation-page { padding: 40px 0; display:none; min-height: 100vh; }
        #evaluation-page .container {
            width: 90%; max-width: 1300px; margin: 30px auto; background-color: rgba(255, 255, 255, 0.80); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.25); padding: 40px; border-radius: 18px; box-shadow: 0 10px 40px rgba(31, 38, 135, 0.2); position: relative; overflow: hidden; z-index: 5;
        }
        #evaluation-page h1 { color: #2c3e50; text-align: center; margin-bottom: 40px; font-size: 2.8em; font-weight: 600; }
        .position-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(210px, 1fr)); gap: 25px; padding: 25px 0; }
        .position-card {
            display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: rgba(255, 255, 255, 0.95); border-radius: 12px; padding: 25px; text-align: center; text-decoration: none; color: #343a40; transition: transform 0.25s ease-in-out, box-shadow 0.25s ease-in-out, background-color 0.25s ease; box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1); min-height: 130px; border: 1px solid rgba(0, 0, 0, 0.1); font-weight: 500; font-size: 15px;
        }
        .position-card:hover { transform: translateY(-5px) scale(1.03); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.18); background-color: #ffffff; color: #0056b3; }
        .position-card:hover .position-icon { color: #007bff; }
        .position-icon { font-size: 30px; margin-bottom: 15px; color: #6c757d; transition: color 0.25s ease; }

        /* Back Buttons Styling (Shared) */
        #evaluation-page button[onclick="showWelcomeMessageFromEval()"],
        #evaluation-form-container button[onclick="showEvaluationPage()"] {
            display: inline-flex; align-items: center; justify-content: center; gap: 8px; margin: 25px auto 15px auto; padding: 12px 25px; background-color: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(108, 117, 125, 0.4);
        }
        #evaluation-page button[onclick="showWelcomeMessageFromEval()"]:hover,
        #evaluation-form-container button[onclick="showEvaluationPage()"]:hover { background-color: #5a6268; transform: translateY(-2px); box-shadow: 0 4px 6px rgba(108, 117, 125, 0.5); }
        #evaluation-page button[onclick="showWelcomeMessageFromEval()"]::before,
        #evaluation-form-container button[onclick="showEvaluationPage()"]::before { content: "\f060"; font-family: "Font Awesome 6 Free"; font-weight: 900; }

    </style>
</head>

<body class="gradient-background"> <!-- Start with gradient background -->

    <!-- WELCOME PAGE HTML -->
    <div id="welcome-page">
         <div id="login-container">
             <div class="login-logo"><img src="logo.png" alt="Al Tasnim Group Logo"></div>
             <div class="login-input-group"><label for="username">User Name</label><input type="text" id="username" name="username" required></div>
             <div class="login-input-group"><label for="password">Password</label><input type="password" id="password" name="password" required></div>
             <button type="button" class="login-button" onclick="authenticateUser()">
                 <i class="fas fa-sign-in-alt"></i> Login
             </button>
             <div id="login-message"></div> <!-- Messages shown via JS -->
         </div>
         <!-- Background Panels -->
         <div class="background-panel" id="panel1"><img src="Pannel1.jpg" alt="Construction Machinery"></div>
         <div class="background-panel" id="panel2"><img src="Pannel2.jpg" alt="Construction Workers"></div>
         <div class="background-panel" id="panel3"><img src="Pannel3.jpeg" alt="Worker Welding"></div>
         <div class="background-panel" id="panel4"><img src="https://images.unsplash.com/photo-1591639831738-c48204e0933c?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8MHx8fGVuffA%3D%3D" alt="Blueprints"></div>
         <!-- Welcome Message Container -->
         <div id="welcome-message-container"> <!-- Removed class="welcome-container" -->
             <h1 class="welcome-message">Welcome to Employee Performance Evaluation!</h1>
             <a href="#" class="proceed-button" onclick="showEvaluationPage()">
                 Proceed to Evaluation <i class="fas fa-arrow-right"></i>
             </a>
         </div>
    </div>

    <!-- EVALUATION PAGE HTML -->
     <div id="evaluation-page">
         <div class="container">
             <h1>Employee Performance Evaluation</h1>
             <div class="position-grid">
                 <!-- Position cards with icons -->
                 <a href="#" onclick="showEvaluationFormByType('AC Technician'); return false;" class="position-card"><i class="fas fa-wrench position-icon"></i>AC Technician</a>
                 <a href="#" onclick="showEvaluationFormByType('Dispatch Officer'); return false;" class="position-card"><i class="fas fa-headset position-icon"></i>Dispatch Officer</a>
                 <a href="#" onclick="showEvaluationFormByType('Electrical Engineer'); return false;" class="position-card"><i class="fas fa-bolt position-icon"></i>Electrical Engineer</a>
                 <a href="#" onclick="showEvaluationFormByType('Electrician Industrial'); return false;" class="position-card"><i class="fas fa-industry position-icon"></i>Electrician Industrial</a>
                 <a href="#" onclick="showEvaluationFormByType('HSE Advisor'); return false;" class="position-card"><i class="fas fa-shield-alt position-icon"></i>HSE Advisor</a>
                 <a href="#" onclick="showEvaluationFormByType('IT Support Executive'); return false;" class="position-card"><i class="fas fa-desktop position-icon"></i>IT Support Executive</a>
                 <a href="#" onclick="showEvaluationFormByType('Permit Applicant'); return false;" class="position-card"><i class="fas fa-file-alt position-icon"></i>Permit Applicant</a>
                 <a href="#" onclick="showEvaluationFormByType('Permit Holder'); return false;" class="position-card"><i class="fas fa-check-circle position-icon"></i>Permit Holder</a>
                 <a href="#" onclick="showEvaluationFormByType('Pipe Fitter'); return false;" class="position-card"><i class="fas fa-tools position-icon"></i>Pipe Fitter</a>
                 <a href="#" onclick="showEvaluationFormByType('Quality Control'); return false;" class="position-card"><i class="fas fa-check position-icon"></i>Quality Control</a>
                 <a href="#" onclick="showEvaluationFormByType('Quantity Surveyor'); return false;" class="position-card"><i class="fas fa-calculator position-icon"></i>Quantity Surveyor</a>
                 <a href="#" onclick="showEvaluationFormByType('Site Engineer - Electrical'); return false;" class="position-card"><i class="fas fa-plug position-icon"></i>Site Engineer - Electrical</a>
                 <a href="#" onclick="showEvaluationFormByType('Site Engineer'); return false;" class="position-card"><i class="fas fa-hard-hat position-icon"></i>Site Engineer</a>
                 <a href="#" onclick="showEvaluationFormByType('Stores Engineer - General'); return false;" class="position-card"><i class="fas fa-warehouse position-icon"></i>Stores Engineer - General</a>
                 <a href="#" onclick="showEvaluationFormByType('Supervisor - Security'); return false;" class="position-card"><i class="fas fa-user-shield position-icon"></i>Supervisor - Security</a>
             </div>
              <!-- Back button styled via CSS -->
              <button onclick="showWelcomeMessageFromEval()">Back to Welcome</button>
         </div>
     </div>

    <!-- GENERIC Evaluation Form Container -->
    <div id="evaluation-form-container">
        <div id="form-container">
            <div class="ac-header-container">
                <h2 id="form-header-title">EMPLOYEE PERFORMANCE EVALUATION FORM</h2>
                <div class="ac-review-date required-field">Review Date: <input type="date" id="review-date-header" class="required" /></div>
            </div>
            <div class="ac-section-header" id="personal-details">EMPLOYEE DETAILS</div>
            <table class="ac-table">
                <tr>
                    <td class="ac-bold-text required-field">Employee No</td><td><input type="text" id="emp-number" class="required" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '');"/></td>
                    <td class="ac-bold-text required-field">Employee Name</td><td><input type="text" id="emp-name" class="required" readonly /></td>
                </tr>
                <tr>
                    <td class="ac-bold-text">Position</td><td><input type="text" id="position-text" readonly /></td>
                    <td class="ac-bold-text">Employee Group</td><td><input type="text" id="emp-group" readonly /></td>
                </tr>
                <tr>
                    <td class="ac-bold-text">Division</td><td><input type="text" id="division-text" readonly /></td>
                    <td class="ac-bold-text">Department</td><td><input type="text" id="department-text" readonly /></td>
                </tr>
                <tr>
                    <!-- Email ID is NOT mandatory -->
                    <td class="ac-bold-text">Email ID</td><td><input type="text" id="email" maxlength="40" /></td>
                    <td class="ac-bold-text required-field">Contact No</td><td><input type="text" id="contact" class="required" maxlength="8" oninput="this.value = this.value.replace(/[^0-9NA]/g, '').toUpperCase();" /></td>
                </tr>
                <tr>
                    <td class="ac-bold-text required-field">Reviewer ID</td>
                    <td><input type="text" id="reviewer-number" class="required" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '');"/></td>
                    <td class="ac-bold-text required-field">Reviewer Name</td><td><input type="text" id="reviewer-name" class="required" readonly /></td>
                </tr>
            </table>

            <div class="ac-section-header" id="performance-metrics-header">PERFORMANCE METRICS (Click to Expand/Collapse)</div>
            <div id="performance-metrics"><!-- Metrics generated by JS --></div>

            <div class="ac-section-header" id="overall-performance-header">OVERALL PERFORMANCE</div>
            <p id="overall-performance" style="text-align: center; font-weight: 500; margin: 12px 0 15px 0; font-size: 12px;">Please rate all metrics.</p> <!-- Adjusted style -->

            <div class="ac-section-header required-field">OVERALL REMARKS</div>
            <textarea rows="4" id="remarks" class="required" style="width: calc(100% - 20px); margin: 10px auto; display: block; box-sizing: border-box;"></textarea> <!-- Centered textarea -->

            <div class="ac-section-header">APPROVAL SIGNATURES</div>
            <table class="approval-signature-table">
                <thead><tr><th>EMPLOYEE</th><th>FIRST WITNESS</th><th>SECOND WITNESS</th></tr></thead>
                <tbody><tr>
                    <td><input type="text" id="employee-number-signature" placeholder="EMPLOYEE NUMBER" class="placeholder-input" readonly /><input type="text" id="employee-name-signature" placeholder="EMPLOYEE NAME" class="placeholder-input" readonly /><input type="text" id="position-signature" placeholder="POSITION / DESIGNATION" class="placeholder-input" readonly /><input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" /></td>
                    <td><input type="text" id="employee-number-2" placeholder="EMPLOYEE NUMBER" class="placeholder-input" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '');"/><input type="text" id="employee-name-2" placeholder="EMPLOYEE NAME" class="placeholder-input" readonly /><input type="text" id="position-2" placeholder="POSITION / DESIGNATION" class="placeholder-input" readonly /><input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" /></td>
                    <td><input type="text" id="employee-number-3" placeholder="EMPLOYEE NUMBER" class="placeholder-input" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '');"/><input type="text" id="employee-name-3" placeholder="EMPLOYEE NAME" class="placeholder-input" readonly /><input type="text" id="position-3" placeholder="POSITION / DESIGNATION" class="placeholder-input" readonly /><input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" /></td>
                </tr></tbody>
            </table>
            <table class="approval-signature-table">
                <thead><tr><th>REVIEWER</th><th>HOD</th></tr></thead>
                <tbody><tr>
                    <td><input type="text" id="reviewer-number-signature" placeholder="EMPLOYEE NUMBER" class="placeholder-input" readonly /><input type="text" id="reviewer-name-signature" placeholder="EMPLOYEE NAME" class="placeholder-input" readonly /><input type="text" id="reviewer-position-signature" placeholder="POSITION / DESIGNATION" class="placeholder-input" readonly /><input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" /></td>
                    <td><input type="text" id="hod-number" placeholder="EMPLOYEE NUMBER" class="placeholder-input" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '');"/><input type="text" id="hod-name" placeholder="EMPLOYEE NAME" class="placeholder-input" readonly /><input type="text" id="hod-position" placeholder="POSITION / DESIGNATION" class="placeholder-input" readonly /><input type="text" placeholder="SIGNATURE / DATE" class="placeholder-input" /></td>
                </tr></tbody>
            </table>
            <!-- Download button with icon -->
            <button class="ac-download-button" onclick="downloadAndSave()">
                <i class="fas fa-file-pdf"></i> Download PDF & Save Data
            </button>
             <!-- Back button styled via CSS -->
             <button onclick="showEvaluationPage()">Back to Evaluation List</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
    <script>
        let currentFormType = null;
        // Variables to hold the timeout IDs for delayed lookups
        let empLookupTimeout = null;
        let reviewerLookupTimeout = null;
        let witness2LookupTimeout = null;
        let witness3LookupTimeout = null;
        let hodLookupTimeout = null;
        const LOOKUP_DELAY = 500; // milliseconds delay after typing stops

        // Global cache for fetched data
        let employeeData = [];
        let userData = [];

        // URLs for data fetching
        const googleSheetsUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQdxa99pRN_wDel4uOm07GpSSi8YcHP4Q9z-7h7hD70gIeqyhY6QcWoxDjHKn8EGiUdnkNLDOdOY2Fu/pub?output=csv";
        const usersGoogleSheetsUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQbER5yTvms6Xt2DMLUeE3nTS2jhiO6c81vd3uSlKGqzM7qFHgxgNhP0Hho4AXo1dL0D53RqjYO3nK8/pub?output=csv";
        const googleAppsScriptUrl = "https://script.google.com/macros/s/AKfycbwYBCAPSat5TL-OdKt91VEVypjC3Ki4Up09thKroTWYr9IFvaca-BvLN1WKkR1rvuGs/exec"; // For saving data

        // --- DOM Element References (Declare globally after DOM is ready or ensure they exist) ---
        let employeeNumberInput, employeeNameInput, positionTextInput, employeeGroupInput, divisionTextInput, departmentTextInput, emailInput, contactInput;
        let reviewerNumberInput, reviewerNameInput;
        let witness2NumberInput, witness2NameInput, witness2PosInput;
        let witness3NumberInput, witness3NameInput, witness3PosInput;
        let hodNumberInput, hodNameInput, hodPosInput;
        let metricsContainer, overallPerformanceText;
        let loginMessageElement, loginContainerElement, welcomeMessageContainerElement, passwordInputElement, usernameInputElement;
        let evaluationPageElement, evaluationFormContainerElement, welcomePageElement;


         // --- METRICS DATA STRUCTURE (Paste Complete Structure Here) ---
         const allMetricsData = {
              "AC Technician": [ { title: "1. TECHNICAL KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>HVAC Systems Understanding:</b> Knowledge of various AC systems, including residential, commercial, and industrial units.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Diagnostics and Troubleshooting:</b> Ability to diagnose issues accurately using appropriate tools and techniques.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Electrical Knowledge:</b> Understanding of electrical components and wiring in HVAC systems, including capacitors, relays, and circuit boards.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Refrigeration Knowledge:</b> Familiarity with refrigeration cycles, refrigerants, and their proper handling and charging procedures.</div>` }, { title: "2. HANDS-ON SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Installation Skills:</b> Competence in installing AC units, including proper setup, connections, and system configuration.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Repair Skills:</b> Proficiency in repairing faulty components, including compressors, fans, coils, thermostats, and wiring.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Maintenance Skills:</b> Ability to perform routine maintenance tasks such as cleaning filters, coils, and condensers, checking refrigerant levels, and ensuring system efficiency.</div>` }, { title: "3. PROBLEM-SOLVING ABILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Diagnosing Complex Issues:</b> Ability to identify and troubleshoot complex mechanical or electrical problems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficient Solutions:</b> Ability to devise practical, cost-effective solutions to fix problems or improve system performance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adaptability:</b> Adjusting solutions based on the specific needs of the environment (e.g., residential vs. commercial setups).</div>` }, { title: "4. ATTENTION TO DETAIL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Precision:</b> Ensuring all installations, repairs, and maintenance are completed accurately and to manufacturer specifications.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Compliance:</b> Adhering to safety guidelines and protocols, such as handling refrigerants safely, working with electricity, and ensuring proper ventilation.</div>` }, { title: "5. CUSTOMER SERVICE SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Communication:</b> Explaining technical issues and solutions to customers in an understandable and professional manner.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professionalism:</b> Maintaining a courteous, friendly, and respectful demeanor when interacting with customers, whether on site or over the phone.</div><div style="border: 1px solid #ddd; padding: 2px; margin:0; margin-bottom: 3px;"><b>Customer Education:</b> Offering advice on system maintenance, energy-saving tips, and how to operate AC units properly.</div>` }, { title: "6. TIME MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficiency:</b> Completing tasks within the expected time frame, ensuring minimal disruption to the customerâ€™s daily activities.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Prioritization:</b> Managing multiple service calls, balancing urgent repairs with routine maintenance without compromising quality.</div>` }, { title: "7. KNOWLEDGE OF CODES AND REGULATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Local Codes and Standards:</b> Knowledge of local, state, and federal regulations regarding HVAC systems, such as installation codes, refrigerant handling, and energy efficiency standards.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Permit Requirements:</b> Understanding when and how to obtain necessary permits for installation or repairs.</div>` }, { title: "8. PHYSICAL AND MANUAL DEXTERITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Physical Stamina:</b> Ability to work in challenging physical environments (e.g., rooftops, basements, attics) and handle heavy equipment.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Precision Handling:</b> Skill in using tools such as wrenches, pressure gauges, thermometers, and soldering tools.</div>` }, { title: "9. SAFETY AWARENESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Workplace Safety:</b> Consistently following safety protocols, such as wearing personal protective equipment (PPE), handling hazardous materials properly, and ensuring workspaces are safe.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Hazard Prevention:</b> Recognizing and mitigating potential safety hazards, such as electrical risks, refrigerant leaks, or improper ventilation.</div>` }, { title: "10. TROUBLESHOOTING EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Speed:</b> The ability to identify problems and fix them quickly, minimizing downtime for the customer.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Comprehensive Troubleshooting:</b> Not only fixing the immediate issue but also identifying any other potential problems or areas for improvement.</div>` }, { title: "11. QUALITY OF WORK", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Durability of Work:</b> Ensuring repairs and installations are durable, minimizing the need for repeat visits or fixes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Attention to Detail:</b> Thoroughness in performing repairs and maintenance, ensuring all components are functioning properly.</div>` }, { title: "12. ADAPTABILITY AND CONTINUED LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Staying Current:</b> Keeping up to date with the latest AC technologies, refrigerants, and industry trends.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Certifications:</b> Having relevant certifications such as EPA 608 (for refrigerant handling), NATE (North American Technician Excellence), or HVACR certifications that demonstrate competence and knowledge.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training and Development:</b> Willingness to participate in ongoing training or workshops to enhance skills and knowledge.</div>` }, { title: "13. PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Satisfaction:</b> Positive feedback from clients regarding service quality, communication, and reliability.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>First-Time Fix Rate:</b> The percentage of issues resolved on the first visit.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Work Completion Rate:</b> Successful completion of jobs without the need for rework.</div>` } ],
              "Dispatch Officer": [ { title: "1. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clarity and Efficiency:</b> Ability to provide clear, concise, and accurate information to drivers, clients, or team members.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Listening Skills:</b> Actively listens to instructions, requests, and information to ensure accurate understanding and response.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Multitasking in Communication:</b> Managing multiple communication channels (radio, phone, email) without errors.</div>`}, { title: "2. ORGANIZATIONAL SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Time Management:</b> Effectively prioritizing tasks to ensure timely deliveries or dispatches.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Documentation:</b> Accurately recording and maintaining logs, reports, and other relevant paperwork.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Scheduling:</b> Ability to create and adjust schedules efficiently to maximize resources and meet operational demands.</div>`}, { title: "3. PROBLEM-SOLVING ABILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quick Thinking:</b> Ability to handle unforeseen challenges (e.g., delays, accidents) with a calm and logical approach.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Decision Making:</b> Making informed and practical decisions quickly, especially under pressure.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adaptability:</b> Adjusting to changes or emergencies without compromising service or safety.</div>`}, { title: "4. ATTENTION TO DETAIL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy:</b> Ensuring dispatches are carried out correctly, including addresses, times, routes, and special instructions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Monitoring:</b> Keeping track of drivers, deliveries, and schedules, ensuring that everything is progressing as planned.</div>`}, { title: "5. TECHNOLOGICAL PROFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Software Use:</b> Familiarity with dispatching software and tools used for tracking shipments, vehicles, or deliveries.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>GPS and Routing Systems:</b> Ability to use navigation systems or route optimization tools to guide drivers effectively.</div>`}, { title: "6. KNOWLEDGE OF SAFETY REGULATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Ensuring that dispatches are made in accordance with safety and regulatory guidelines, especially regarding transport laws, driver hours, and vehicle maintenance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Management:</b> Identifying potential safety hazards and taking preventive measures.</div>`}, { title: "7. CUSTOMER SERVICE SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Interaction:</b> Professionalism in dealing with customers, addressing complaints, and providing updates.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Problem Resolution:</b> Handling customer service issues that may arise during dispatch, such as delays or route changes.</div>`}, { title: "8. TEAM COLLABORATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cooperation:</b> Working effectively with other team members, drivers, and departments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Leadership:</b> Guiding the dispatch team or taking charge when necessary, especially during busy times or emergencies.</div>`}, { title: "9. STRESS MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Composure Under Pressure:</b> Ability to stay calm and focused when handling multiple tasks or responding to emergencies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Managing conflicts within the team or with customers effectively.</div>`}, { title: "10. PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Timeliness:</b> Meeting deadlines for dispatch and deliveries consistently.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy:</b> Minimizing errors in dispatch and delivery details, including addresses, times, and special requirements.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Satisfaction:</b> Maintaining a high level of customer satisfaction, measured through feedback and service consistency.</div>`} ],
              "Electrical Engineer": [ { title: "1. TECHNICAL COMPETENCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Knowledge of Electrical Engineering Principles:</b> Proficiency in core concepts such as circuit theory, power systems, electromagnetism, and control systems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Application of Theory to Practice:</b> Ability to apply theoretical knowledge to solve practical engineering problems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Use of Engineering Software:</b> Competency in using simulation, design, and analysis software (e.g., AutoCAD, MATLAB, ETAP).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Design Skills:</b> Ability to design electrical systems according to specifications.</div>`}, { title: "2. PROBLEM-SOLVING ABILITIES", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Innovative Solutions:</b> Ability to propose innovative, cost-effective solutions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Troubleshooting and Diagnostics:</b> Skill in diagnosing and troubleshooting electrical systems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Root Cause Analysis:</b> Capacity to identify the root cause of electrical failures.</div>`}, { title: "3. PROJECT MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Planning and Execution:</b> Ability to plan, schedule, and manage projects.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Management:</b> Efficient management of resources.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quality Control:</b> Ensuring work meets required quality standards and regulatory compliance.</div>`}, { title: "4. SAFETY AND COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Safety Standards:</b> Knowledge and adherence to electrical safety standards (e.g., NEC, IEC).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Regulatory Compliance:</b> Understanding and compliance with local and national regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Assessment and Mitigation:</b> Ability to identify electrical hazards and implement mitigation measures.</div>`}, { title: "5. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Documentation:</b> Ability to prepare clear and accurate technical documentation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Collaboration:</b> Ability to work effectively in multidisciplinary teams.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Interaction:</b> Proficiency in presenting technical solutions to clients.</div>`}, { title: "6. LEADERSHIP AND TEAMWORK", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Leadership Skills:</b> Ability to lead and mentor junior engineers (if applicable).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration:</b> Effective collaboration with other departments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Ability to handle conflicts professionally.</div>`}, { title: "7. ADAPTABILITY AND LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Continuous Learning:</b> Willingness to stay updated with latest trends and technologies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Flexibility in Problem-Solving:</b> Ability to adapt to changing requirements.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professional Development:</b> Participation in training and workshops.</div>`}, { title: "8. EFFICIENCY AND PRODUCTIVITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Time Management:</b> Ability to prioritize tasks and meet deadlines.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Efficiency:</b> Ability to balance cost constraints with technical requirements.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Output and Results:</b> Ability to complete tasks and projects efficiently.</div>`}, { title: "9. INNOVATION AND INITIATIVE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Creative Problem-Solving:</b> Ability to think outside the box.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Initiative:</b> Proactiveness in identifying potential issues and suggesting improvements.</div>`}, { title: "10. CUSTOMER OR STAKEHOLDER SATISFACTION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Satisfaction:</b> Ability to meet client expectations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Internal Stakeholder Satisfaction:</b> Ensuring electrical solutions meet internal requirements.</div>`}, { title: "11. ETHICS AND PROFESSIONALISM", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Integrity:</b> Demonstrating honesty, transparency, and accountability.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professionalism:</b> Adhering to engineering ethics and maintaining confidentiality.</div>`}, { title: "12. PERFORMANCE METRICS AND KEY PERFORMANCE INDICATORS (KPIS)", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Completion:</b> On-time and within-budget delivery.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Error Rate:</b> Frequency of errors or rework.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Feedback:</b> Evaluating feedback from clients/stakeholders.</div>`} ],
              "Electrician Industrial": [ { title: "1. TECHNICAL KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Electrical Systems Understanding:</b> Proficiency in industrial electrical systems and equipment.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Wiring and Circuitry:</b> Ability to install, repair, and maintain wiring/circuits.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Blueprint Reading:</b> Ability to read technical drawings and wiring diagrams.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Power Distribution:</b> Knowledge of power distribution systems.</div>`}, { title: "2. INSTALLATION AND MAINTENANCE SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Electrical Installations:</b> Skill in installing systems and equipment.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Preventive Maintenance:</b> Ability to carry out routine maintenance and inspections.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Troubleshooting and Repairs:</b> Skill in diagnosing and repairing electrical issues quickly.</div>`}, { title: "3. SAFETY AND COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Protocols:</b> Adherence to safety regulations (LOTO, PPE).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance with Standards:</b> Knowledge of electrical codes (NEC, IEC).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Hazardous Environment Awareness:</b> Ability to identify and mitigate risks.</div>`}, { title: "4. TROUBLESHOOTING AND DIAGNOSTICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Systematic Approach:</b> Ability to use logical methods for troubleshooting.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Diagnostic Tools:</b> Proficiency with multimeters, thermal cameras, etc.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Root Cause Analysis:</b> Skill in identifying the root cause of failures.</div>`}, { title: "5. ELECTRICAL EQUIPMENT AND CONTROLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Motor Control Systems:</b> Expertise with MCCs, PLCs, VFDs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Control Systems:</b> Familiarity with manual/automated control systems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Calibration and Testing:</b> Ability to calibrate and test systems.</div>`}, { title: "6. PROBLEM-SOLVING AND EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quick Decision-Making:</b> Ability to make decisions under pressure.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Work Efficiency:</b> Completing tasks timely and efficiently.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Management:</b> Effective use of materials and tools.</div>`}, { title: "7. TIME MANAGEMENT AND TASK PRIORITIZATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Task Prioritization:</b> Ability to prioritize critical repairs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Meeting Deadlines:</b> Completing work within designated time frames.</div>`}, { title: "8. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting:</b> Ability to document work clearly.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Collaboration:</b> Working effectively with others.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Ability to explain technical issues clearly.</div>`}, { title: "9. EXPERIENCE AND KNOWLEDGE OF PLANT-SPECIFIC SYSTEMS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Plant-Specific Equipment:</b> Familiarity with plant equipment.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Industrial Electrical Maintenance:</b> Experience with plant-specific procedures.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Energy Efficiency:</b> Knowledge of energy-saving technologies.</div>`}, { title: "10. ADAPTABILITY AND CONTINUOUS LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adaptability to Change:</b> Ability to adapt to new technology/protocols.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ongoing Education:</b> Willingness to stay current.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Learning from Experience:</b> Applying lessons learned.</div>`}, { title: "11. LEADERSHIP AND SUPERVISION (IF APPLICABLE)", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Leadership:</b> Ability to manage/mentor junior staff.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Delegation:</b> Effectively delegating tasks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training:</b> Providing training and support.</div>`}, { title: "12. PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Downtime Reduction:</b> Effectiveness in minimizing equipment downtime.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Work Quality:</b> High standards of electrical work.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer (Internal) Satisfaction:</b> Delivering quality electrical support.</div>`}, { title: "13. ENERGY EFFICIENCY AND COST MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Energy Management:</b> Identifying areas for energy efficiency.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost-Effectiveness:</b> Ensuring work is carried out cost-effectively.</div>`} ],
              "HSE Advisor": [ { title: "1. KNOWLEDGE OF HSE REGULATIONS AND STANDARDS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Legal Compliance:</b> Understanding and application of HSE regulations (OSHA, EPA).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Industry Standards:</b> Knowledge of ISO 45001, ISO 14001.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Regulations:</b> Awareness of waste management, emissions control.</div>`}, { title: "2. RISK ASSESSMENT AND HAZARD IDENTIFICATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Analysis:</b> Ability to conduct thorough risk assessments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Mitigation Measures:</b> Expertise in recommending control measures (PPE, procedures).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Job Safety Analysis (JSA):</b> Ability to conduct and guide JSA.</div>`}, { title: "3. SAFETY TRAINING AND AWARENESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training Program Development:</b> Ability to develop and deliver safety training.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ongoing Education:</b> Organizing drills, campaigns, refreshers.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Tailored Training:</b> Customizing training for specific needs.</div>`}, { title: "4. SAFETY AUDITS AND INSPECTIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Site Inspections:</b> Regularly conducting audits/inspections.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Audit Readiness:</b> Maintaining records for external/internal audits.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Non-Compliance Tracking:</b> Monitoring and addressing non-compliance.</div>`}, { title: "5. INCIDENT INVESTIGATION AND REPORTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accident Investigation:</b> Leading/supporting investigations for root causes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Reporting:</b> Ensuring timely and accurate reporting.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Data Analysis:</b> Analyzing incident data for trends and prevention.</div>`}, { title: "6. EMERGENCY RESPONSE PLANNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Emergency Procedures:</b> Developing and maintaining response plans.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Crisis Management:</b> Leading/supporting emergency response.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Drills and Simulations:</b> Organizing regular drills.</div>`}, { title: "7. ENVIRONMENTAL PROTECTION AND SUSTAINABILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainability Initiatives:</b> Promoting responsible practices (waste, resources).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Risk Management:</b> Identifying/mitigating environmental risks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Green Certifications:</b> Promoting/working towards certifications (ISO 14001).</div>`}, { title: "8. COMMUNICATION AND COLLABORATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Communicating HSE policies clearly.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Stakeholder Engagement:</b> Collaborating with teams, regulators, clients.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting and Documentation:</b> Producing clear, detailed reports.</div>`}, { title: "9. LEADERSHIP AND INFLUENCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Promoting a Safety Culture:</b> Leading by example.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Influence and Advocacy:</b> Encouraging safe practices.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Handling safety conflicts professionally.</div>`}, { title: "10. TRAINING, CERTIFICATIONS, AND PROFESSIONAL DEVELOPMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Relevant Certifications:</b> Holding NEBOSH, IOSH, OSHA certs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Continuous Learning:</b> Engaging in ongoing professional development.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professional Affiliations:</b> Active membership in HSE organizations.</div>`}, { title: "11. TEAMWORK AND INTERPERSONAL SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration with Teams:</b> Working effectively with other departments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Interpersonal Skills:</b> Building strong relationships.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Motivating Others:</b> Inspiring safe work practices.</div>`}, { title: "12. PERFORMANCE TRACKING AND CONTINUOUS IMPROVEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Performance Metrics:</b> Monitoring KPIs (accident rates, near misses).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Continuous Improvement:</b> Identifying and implementing improvements.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Feedback Loops:</b> Using feedback to improve systems.</div>`}, { title: "13. ETHICS AND PROFESSIONALISM", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Integrity:</b> Acting with honesty and transparency.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Commitment to Compliance:</b> Demonstrating full compliance adherence.</div>`}, { title: "14. ADAPTABILITY AND CRISIS MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Dealing with Unforeseen Issues:</b> Adapting to changing conditions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Problem Solving in High-Pressure Situations:</b> Calmly managing emergencies.</div>`} ],
              "IT Support Executive": [ { title: "1. TECHNICAL KNOWLEDGE AND SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Hardware/Software Expertise:</b> Troubleshooting servers, network devices, endpoints.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Operating Systems:</b> Administering Windows, Linux, macOS.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Networking Knowledge:</b> Understanding IP, DNS, DHCP, VPN, firewalls.</div>`}, { title: "2. PROBLEM-SOLVING AND TROUBLESHOOTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Issue Resolution:</b> Diagnosing and resolving complex technical issues.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Root Cause Analysis:</b> Identifying underlying causes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Troubleshooting Methodology:</b> Using systematic methods.</div>`}, { title: "3. SYSTEM ADMINISTRATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Backup and Recovery:</b> Ensuring robust backup/restore strategies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Patch Management:</b> Regular updating and patching.</div>`}, { title: "4. SECURITY AND COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Security Practices:</b> Implementing firewalls, antivirus, encryption.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Access Control:</b> Managing user permissions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Adherence to security standards (GDPR, HIPAA).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Response:</b> Managing security breaches.</div>`}, { title: "5. INFRASTRUCTURE MONITORING AND OPTIMIZATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>System Monitoring:</b> Proactively monitoring infrastructure health.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Performance Tuning:</b> Optimizing system/network performance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Capacity Planning:</b> Assessing resource needs.</div>`}, { title: "6. SUPPORT AND SERVICE MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Management:</b> Handling service tickets efficiently.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>User Support:</b> Providing technical assistance to end users.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Documentation:</b> Creating/maintaining system documentation.</div>`}, { title: "7. PROJECT MANAGEMENT AND COORDINATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Implementation:</b> Assisting/leading IT infrastructure projects.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration:</b> Working with other teams.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Vendor Management:</b> Coordinating with third-party vendors.</div>`}, { title: "8. CUSTOMER SERVICE AND COMMUNICATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Explaining technical issues clearly.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Interaction:</b> Providing excellent customer service.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training and Knowledge Sharing:</b> Educating users/colleagues.</div>`}, { title: "9. TIME MANAGEMENT AND EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Task Prioritization:</b> Managing multiple requests effectively.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficiency:</b> Completing tasks without compromising quality.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Deadline Adherence:</b> Meeting project deadlines.</div>`}, { title: "10. ADAPTABILITY AND CONTINUOUS LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Learning Agility:</b> Staying updated with emerging tech.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Certification and Training:</b> Pursuing relevant certifications (CompTIA, MCSA, CCNA).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adaptability:</b> Adapting to new tools/technologies.</div>`}, { title: "11. VENDOR AND CONTRACT MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Vendor Relationships:</b> Managing vendor interactions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Contract Management:</b> Ensuring adherence to SLAs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Management:</b> Managing procurement/support costs.</div>`}, { title: "12. PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>System Uptime:</b> Maintaining high system availability.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Response Time:</b> Meeting support ticket response targets.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>End-User Satisfaction:</b> Monitoring user feedback.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Issue Resolution Time:</b> Average time to resolve issues.</div>`}, { title: "13. LEADERSHIP AND INITIATIVE (IF APPLICABLE)", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Leadership:</b> Guiding IT support staff.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Taking Initiative:</b> Proactively suggesting improvements.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Mentoring:</b> Helping junior team members.</div>`} ],
              "Permit Applicant": [ { title: "1. COMPLIANCE WITH REQUIREMENTS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Zoning/Land Use:</b> Ensuring project aligns with local laws.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Impact:</b> Compliance with environmental regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Health & Safety Standards:</b> Adherence to H&S regulations.</div>`}, { title: "2. FINANCIAL STABILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ability to Pay Fees:</b> Ensuring applicant can cover permit fees.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Financial Responsibility:</b> Verifying resources to complete the project.</div>`}, { title: "3. EXPERIENCE AND QUALIFICATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Technical Expertise:</b> Demonstrating necessary technical skills (if required).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Past Compliance Record:</b> History of compliance.</div>`}, { title: "4. PUBLIC SAFETY AND WELFARE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Impact on Public Safety:</b> Ensuring project poses no threat.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Community Impact:</b> Assessing effects on noise, traffic, etc.</div>`}, { title: "5. APPLICATION COMPLETENESS AND ACCURACY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Proper Documentation:</b> Submitting all required documents.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy of Information:</b> Verifying provided information.</div>`}, { title: "6. DURATION AND SCOPE OF THE PERMIT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Timeline:</b> Adherence to projected timeline.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance Monitoring:</b> Willingness to comply with monitoring.</div>`}, { title: "7. PUBLIC ENGAGEMENT (IF APPLICABLE)", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Community Consultation:</b> Engaging with the local community.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Public Comments:</b> Consideration of public feedback.</div>`}, { title: "8. ENVIRONMENTAL CONSIDERATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainability Practices:</b> Incorporating sustainable methods.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Permitting for Environmental Factors:</b> Compliance with specific environmental rules.</div>`}, { title: "9. RISK ASSESSMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk to Environment/Property:</b> Assessment of potential risks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Contingency Plans:</b> Providing plans for high-risk activities.</div>`} ],
              "Permit Holder": [ { title: "1. COMPLIANCE WITH REGULATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Knowledge of Laws:</b> Understanding relevant legal/safety/environmental rules.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Conditions:</b> Strictly following all permit conditions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Compliance:</b> Complying with environmental protection laws.</div>`}, { title: "2. SAFETY MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Protocols:</b> Implementing and enforcing safety measures.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Hazard ID & Risk Assessment:</b> Identifying hazards and mitigation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Emergency Procedures:</b> Ensuring proper emergency preparedness.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Reporting:</b> Prompt reporting and corrective actions.</div>`}, { title: "3. DOCUMENTATION AND RECORD KEEPING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accurate Documentation:</b> Maintaining records of permit activities.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Audit Readiness:</b> Keeping documents organized for inspection.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting Obligations:</b> Timely submission of required reports.</div>`}, { title: "4. OPERATIONAL COMPETENCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Technical Knowledge:</b> Understanding operations covered by the permit.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Supervision and Oversight:</b> Managing operations and contractors effectively.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Management:</b> Efficient use of materials, equipment, personnel.</div>`}, { title: "5. TRAINING AND COMPETENCE OF PERSONNEL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Qualified Workforce:</b> Ensuring personnel are trained/certified.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ongoing Training:</b> Providing continuous training.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Competency in Permit Requirements:</b> Ensuring understanding of permit conditions.</div>`}, { title: "6. PERFORMANCE MONITORING AND REPORTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Inspection and Monitoring:</b> Regularly checking work for compliance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Corrective Actions:</b> Taking timely action on deviations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Performance Reviews:</b> Ongoing evaluation against permit objectives.</div>`}, { title: "7. ENVIRONMENTAL AND SOCIAL RESPONSIBILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainability Efforts:</b> Implementing waste management, conservation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Community Impact:</b> Minimizing negative effects on communities/ecosystems.</div>`}, { title: "8. TIMELINESS AND PROJECT MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Deadlines:</b> Conducting activities within permit timeframes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Execution:</b> Effective management to complete projects on plan/budget.</div>`}, { title: "9. COMMUNICATION WITH AUTHORITIES", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Engagement with Regulators:</b> Maintaining professional relationship.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Transparency:</b> Being open about operations and issues.</div>`}, { title: "10. HISTORY OF COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Past Performance:</b> Track record of compliance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Violation History:</b> Low or non-existent history of violations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Corrective Actions Taken:</b> Demonstrated ability to fix past issues.</div>`}, { title: "11. ETHICS AND PROFESSIONALISM", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Integrity:</b> Operating in good faith and adhering to law.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professionalism in Operations:</b> Conducting activities ethically.</div>`} ],
              "Pipe Fitter": [ { title: "1. TECHNICAL SKILLS & KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Pipe Fitting Techniques:</b> Ability to read blueprints, schematics.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Welding Skills:</b> Proficiency in TIG, MIG, stick welding.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cutting and Bending:</b> Skill in cutting, threading, bending pipes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Pipe Sizing:</b> Understanding sizes, materials, design.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Installation Process:</b> Knowledge of alignment, leveling, securing.</div>`}, { title: "2. KNOWLEDGE OF STANDARDS & CODES", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Regulations Compliance:</b> Familiarity with ASME, API, ANSI.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Standards:</b> Adherence to safety protocols, PPE use.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Compliance:</b> Understanding environmental requirements.</div>`}, { title: "3. PROBLEM-SOLVING & TROUBLESHOOTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Identifying Issues:</b> Ability to find alignment problems, leaks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Corrective Action:</b> Quick and effective problem-solving.</div>`}, { title: "4. QUALITY OF WORK", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Precision and Accuracy:</b> High precision in cutting, fitting, assembly.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Leak-Free Installations:</b> Ensuring no leaks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Durability and Strength:</b> Ensuring installation meets pressure/temp needs.</div>`}, { title: "5. TIME MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficiency:</b> Completing tasks timely without compromising quality/safety.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Milestones:</b> Ability to meet deadlines.</div>`}, { title: "6. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Collaboration:</b> Working well with others.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting:</b> Providing clear work reports.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Instructional Ability:</b> Ability to mentor/train others.</div>`}, { title: "7. SAFETY RECORD", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Workplace Safety:</b> Proven track record of following safety protocols.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Inspections:</b> Participation in inspections/hazard assessments.</div>`}, { title: "8. EXPERIENCE AND CERTIFICATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Relevant Experience:</b> Years of experience with flowline/piping systems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Certifications:</b> Holding NCCER or similar qualifications.</div>`}, { title: "9. PHYSICAL CONDITION AND STAMINA", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Physical Fitness:</b> Strength/endurance for demanding tasks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Stamina and Dexterity:</b> Ability for repetitive tasks/extended hours.</div>`}, { title: "10. ADAPTABILITY AND LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adaptability to New Technologies:</b> Willingness to learn new methods.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Continuous Improvement:</b> Commitment to ongoing development.</div>`} ],
              "Quality Control": [ { title: "1. ACCURACY AND PRECISION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Consistency in results:</b> QC should consistently ensure that products or services meet defined specifications.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Error detection:</b> A good QC system is effective at identifying and addressing defects, inconsistencies, or non-conformities.</div>`}, { title: "2. ADHERENCE TO STANDARDS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Aligning with ISO, industry, gov regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Documentation:</b> Ensuring procedures are documented and followed.</div>`}, { title: "3. EFFICIENCY OF PROCESSES", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Timeliness:</b> QC process not causing delays.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource utilization:</b> Optimal use of manpower, tools, materials.</div>`}, { title: "4. DEFECT DETECTION & PREVENTION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Prevention focus:</b> Proactively identifying root causes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Types of defects caught:</b> Effectiveness in identifying various defects.</div>`}, { title: "5. TRAINING AND EXPERTISE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Skills of QC personnel:</b> Competency in applying QC measures.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ongoing development:</b> Support for learning and certification.</div>`}, { title: "6. DOCUMENTATION AND REPORTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy of records:</b> Clear records of inspections, tests, actions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Transparency & traceability:</b> Documentation allows traceability.</div>`}, { title: "7. CUSTOMER SATISFACTION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Feedback incorporation:</b> Tracking and using customer feedback.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Post-delivery performance:</b> Monitoring product/service performance.</div>`}, { title: "8. CORRECTIVE & PREVENTIVE ACTIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Root cause analysis:</b> Identifying underlying causes of defects.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Follow-up actions:</b> Taking steps to prevent recurrence.</div>`}, { title: "9. CONTINUOUS IMPROVEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Process improvement:</b> Regular review of QC process.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Metrics and KPIs:</b> Establishing and measuring quality KPIs.</div>`}, { title: "10. COST-EFFECTIVENESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost of quality:</b> Evaluating costs of prevention, detection, failure.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Return on investment (ROI):</b> QC showing positive ROI.</div>`} ],
              "Quantity Surveyor": [ { title: "1. TECHNICAL KNOWLEDGE & EXPERTISE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Estimation:</b> Accurate cost estimates from drawings/specs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Bill of Quantities (BOQ):</b> Preparing/managing BOQs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Construction Techniques:</b> Understanding methods and cost implications.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Contractual Knowledge:</b> Strong grasp of NEC, FIDIC, JCT.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Value Engineering:</b> Optimizing costs while maintaining quality.</div>`}, { title: "2. PROJECT MANAGEMENT & COORDINATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Budget Management:</b> Managing and controlling project budgets.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Monitoring & Reporting:</b> Tracking costs and reporting variances.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cash Flow Forecasting:</b> Managing project cash flow.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Tendering & Procurement:</b> Managing bids and contractor selection.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Management:</b> Identifying and managing financial risks.</div>`}, { title: "3. ANALYTICAL & PROBLEM-SOLVING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Analysis:</b> Analyzing cost reports for savings/discrepancies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Dispute Resolution:</b> Skill in resolving cost/contract disputes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Problem-Solving:</b> Addressing cost overruns, variations effectively.</div>`}, { title: "4. COMMUNICATION & INTERPERSONAL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration:</b> Working with architects, engineers, contractors.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Communication:</b> Clearly communicating cost info.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Negotiation Skills:</b> Managing variations and claims.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Presentation Skills:</b> Presenting cost reports.</div>`}, { title: "5. ATTENTION TO DETAIL & ACCURACY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy:</b> Meticulous measurement and calculation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Consistency & Precision:</b> Ensuring reports are precise.</div>`}, { title: "6. KNOWLEDGE OF STANDARDS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Building Codes:</b> Familiarity with relevant codes/regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Health & Safety:</b> Understanding H&S cost implications.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainability:</b> Knowledge of green practices and costs.</div>`}, { title: "7. EXPERIENCE & QUALIFICATIONS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Educational Background:</b> Relevant degree (QS, Civil Eng).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professional Experience:</b> Demonstrated history in QS roles.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>CPD:</b> Commitment to ongoing learning.</div>`}, { title: "8. SOFTWARE PROFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Estimation Software:</b> Familiarity with tools (CostX, Procore).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Excel & Data Management:</b> Advanced Excel skills.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>BIM:</b> Knowledge of using BIM for cost estimation.</div>`}, { title: "9. LEADERSHIP & MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Leadership:</b> Ability to manage/mentor junior staff.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Decision-Making:</b> Strong financial/contractual decisions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client-Focused Mindset:</b> Meeting client requirements.</div>`}, { title: "10. ETHICS & PROFESSIONAL INTEGRITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Transparency & Honesty:</b> Acting with integrity.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ethical Behavior:</b> Adherence to professional standards.</div>`}, { title: "11. TIME MANAGEMENT & EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Project Timelines:</b> Meeting deadlines for reports, tenders.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Multitasking:</b> Handling multiple projects effectively.</div>`}, { title: "12. ADAPTABILITY & CONTINUOUS IMPROVEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adapting to Changes:</b> Managing scope/budget changes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Innovation:</b> Seeking innovative cost management methods.</div>`} ],
              "Site Engineer - Electrical": [ { title: "1. TECHNICAL KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Electrical Systems Understanding:</b> Proficiency in designing, installing, testing, and maintaining electrical systems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Codes & Standards:</b> Knowledge of NEC, IEC.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Circuit Design & Analysis:</b> Ability to calculate load requirements, cable sizes.</div>`}, { title: "2. PROBLEM-SOLVING & TROUBLESHOOTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Diagnostics:</b> Capability to quickly diagnose electrical faults.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Practical Application:</b> Applying theory to real-world problems.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Troubleshooting Skills:</b> Efficiently identifying and resolving malfunctions.</div>`}, { title: "3. PROJECT MANAGEMENT & PLANNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Scheduling & Coordination:</b> Managing timelines, coordinating teams.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Allocation:</b> Ensuring resource availability.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Progress Monitoring:</b> Assessing progress and adjusting.</div>`}, { title: "4. QUALITY CONTROL AND SAFETY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Safety Standards:</b> Ensuring work follows safety protocols.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quality Assurance:</b> Ensuring installations meet high standards.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Inspection and Testing:</b> Verifying compliance.</div>`}, { title: "5. DESIGN AND TECHNICAL DRAWINGS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Interpretation of Drawings:</b> Ability to read electrical drawings/blueprints.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Design Modifications:</b> Making necessary adjustments on site.</div>`}, { title: "6. BUDGET AND COST CONTROL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Estimation:</b> Ability to estimate costs for electrical works.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Control:</b> Monitoring expenditures against budget.</div>`}, { title: "7. TEAM LEADERSHIP AND COLLABORATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Supervision:</b> Leading electrical teams on-site.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Collaboration:</b> Working closely with other engineers/contractors.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Handling site conflicts professionally.</div>`}, { title: "8. DOCUMENTATION AND REPORTING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Record Keeping:</b> Maintaining accurate work records.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting:</b> Providing regular progress reports.</div>`}, { title: "9. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Effectively communicating technical information.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting and Documentation:</b> Preparing clear reports/documents.</div>`}, { title: "10. REGULATORY AND COMPLIANCE KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Ensuring work meets local regulations/codes.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Permit and License Management:</b> Handling necessary permits.</div>`}, { title: "11. ADAPTABILITY AND FLEXIBILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Responding to Changes:</b> Adapting to changing conditions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Handling Unforeseen Issues:</b> Dealing with unexpected problems.</div>`}, { title: "12. CLIENT INTERACTION AND CUSTOMER FOCUS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Orientation:</b> Engaging professionally with clients.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Satisfaction:</b> Meeting client expectations.</div>`}, { title: "13. TIME MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficient Task Management:</b> Completing tasks on time.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Handling Deadlines:</b> Meeting project deadlines.</div>`}, { title: "14. SUSTAINABILITY AND ENERGY EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Energy-Efficient Solutions:</b> Knowledge of efficient solutions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainable Practices:</b> Incorporating green practices.</div>`}, { title: "15. CONTINUOUS LEARNING AND DEVELOPMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Technical Upgrades:</b> Staying updated on trends/tech.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professional Development:</b> Pursuing certifications/training.</div>`} ],
              "Site Engineer": [ { title: "1. TECHNICAL KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Understanding of Engineering Principles:</b> Strong knowledge (Civil, Mech, Elec).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Knowledge of Construction Methods:</b> Understanding techniques, materials.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Blueprint Interpretation:</b> Ability to read plans/specs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Problem-Solving:</b> Troubleshooting site issues.</div>`}, { title: "2. PROJECT MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Planning & Scheduling:</b> Managing daily operations, timelines.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Management:</b> Efficient use of labor, materials.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Budget Control:</b> Managing costs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quality Control:</b> Ensuring work meets standards.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Management:</b> Identifying/mitigating risks.</div>`}, { title: "3. SAFETY AND COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Safety Standards:</b> Adherence to safety regulations.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Assessment:</b> Conducting safety assessments.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Compliance:</b> Ensuring project meets codes/laws.</div>`}, { title: "4. LEADERSHIP & TEAM MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Coordination:</b> Leading workers and subcontractors.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Decision Making:</b> Making informed decisions quickly.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Managing site conflicts.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Delegation:</b> Delegating tasks effectively.</div>`}, { title: "5. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Communication:</b> Communicating with teams, clients, management.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting:</b> Providing accurate progress reports.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Stakeholder Interaction:</b> Interfacing with clients, suppliers.</div>`}, { title: "6. TECHNICAL TOOLS PROFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Engineering Software:</b> Proficiency in AutoCAD, MS Project, etc.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Data Management:</b> Organizing project documentation.</div>`}, { title: "7. ATTENTION TO DETAIL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Accuracy in Execution:</b> Ensuring work follows specs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Quality Assurance:</b> Regularly inspecting work.</div>`}, { title: "8. ADAPTABILITY & PROBLEM-SOLVING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Handling Challenges:</b> Adapting to changing conditions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Innovation:</b> Proposing efficiency improvements.</div>`}, { title: "9. TIME MANAGEMENT & EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Deadline Adherence:</b> Ensuring project completion on time.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Efficiency:</b> Maintaining productivity.</div>`}, { title: "10. ENVIRONMENTAL AWARENESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Sustainable Practices:</b> Awareness of eco-friendly methods.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Environmental Compliance:</b> Ensuring regulations are followed.</div>`}, { title: "11. CLIENT & STAKEHOLDER MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Requirements:</b> Ensuring needs are met.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Change Management:</b> Managing scope/cost changes.</div>`}, { title: "12. ETHICS AND PROFESSIONALISM", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Integrity:</b> Displaying honesty.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professionalism:</b> Maintaining professional demeanor.</div>`}, { title: "13. PREVIOUS EXPERIENCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Track Record:</b> Evaluation of past projects.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>References:</b> Positive feedback.</div>`}, { title: "14. CONTINUOUS LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ongoing Education:</b> Staying updated.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Certifications:</b> Holding relevant certs (PMP, LEED).</div>`} ],
              "Stores Engineer - General": [ { title: "1. TECHNICAL KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Inventory Management:</b> Knowledge of systems, procedures.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Materials/Equipment:</b> Familiarity with industry items.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Warehousing:</b> Understanding layout, storage methods.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Technology:</b> Proficiency with barcode/RFID/WMS.</div>`}, { title: "2. ORGANIZATIONAL SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Inventory Control:</b> Implementing accurate tracking.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Stock Replenishment:</b> Forecasting and managing stock levels.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Procurement Coordination:</b> Managing sourcing and purchasing.</div>`}, { title: "3. HSE & COMPLIANCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Safety Standards:</b> Ensuring work follows safety protocols for storage and handling.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Material Handling Safety:</b> Understanding correct procedures for lifting, storing hazardous materials.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Warehouse Safety:</b> Maintaining a safe storage environment.</div>`}, { title: "4. PROBLEM-SOLVING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Discrepancy Resolution:</b> Identifying and resolving stock count or quality issues.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Logistics Issues:</b> Addressing delays or problems in receiving/dispatch.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Space Optimization:</b> Finding solutions for storage constraints.</div>`}, { title: "5. QUALITY CONTROL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Receiving Inspections:</b> Checking incoming goods against orders and quality specs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Storage Conditions:</b> Ensuring items are stored correctly to prevent damage/degradation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Expiry Management:</b> Monitoring and managing shelf-life sensitive items.</div>`}, { title: "6. COMMUNICATION", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Interdepartmental Liaison:</b> Communicating effectively with procurement, projects, finance.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Supplier Communication:</b> Coordinating deliveries and resolving issues with suppliers.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting:</b> Providing clear stock level, discrepancy, and activity reports.</div>`}, { title: "7. PROJECT MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Stocktake Planning:</b> Organizing and executing inventory counts.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Logistics Coordination:</b> Planning material flow for projects.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Resource Management:</b> Managing stores personnel and equipment.</div>`}, { title: "8. TECH PROFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>WMS/ERP Systems:</b> Proficiency in using warehouse or inventory management software.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Data Entry Accuracy:</b> Ensuring precise data input for transactions.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Reporting Tools:</b> Ability to generate reports from the system.</div>`}, { title: "9. LEADERSHIP (If applicable)", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Supervision:</b> Leading and guiding stores staff.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Task Delegation:</b> Assigning duties effectively.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training:</b> Mentoring junior staff on procedures.</div>`}, { title: "10. EXPERIENCE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Industry Experience:</b> Relevant experience in stores/warehouse management within construction/engineering.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Knowledge of Materials:</b> Familiarity with construction materials and equipment.</div>`}, { title: "11. EFFICIENCY & COST CONTROL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Inventory Turnover:</b> Managing stock levels to optimize turnover.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Minimizing Waste:</b> Reducing stock obsolescence and damage.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Process Optimization:</b> Identifying ways to improve store operations efficiency.</div>`}, { title: "12. ADAPTABILITY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Handling Fluctuations:</b> Adapting to changes in demand or project needs.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>New Systems/Processes:</b> Willingness to learn and adapt to new technologies or procedures.</div>`}, { title: "13. STORES KPI", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>KNOWLEDGE IN STORES KPI TIMELINE ALONG WITH NECESSARY COMPLIANCE</b></div>`}, { title: "14. SCRAP MANAGEMENT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>KNOWLEDGE IN SCRAP MANAGEMENT , SCRAP SEGREGATION AND MAINTAINING THE INVENTORY BASED ON THE TYPE OF SCRAP</b></div>`} ],
              "Supervisor - Security": [ { title: "1. LEADERSHIP & TEAM MGMT", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Team Supervision:</b> Ability to manage and oversee a security team.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Motivation:</b> Ability to motivate security staff.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Training and Development:</b> Providing ongoing training.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict Resolution:</b> Handling interpersonal issues.</div>`}, { title: "2. SECURITY KNOWLEDGE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Security Procedures:</b> Knowledge of protocols (access control, surveillance).</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Assessment:</b> Assessing and mitigating security risks.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Emergency Response:</b> Managing and responding to emergencies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Systems Management:</b> Understanding CCTV, alarms, access control.</div>`}, { title: "3. DECISION-MAKING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Crisis Management:</b> Making sound decisions under pressure.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Problem-Solving:</b> Identifying and resolving security issues.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Judgment and Discretion:</b> Exercising sound judgment.</div>`}, { title: "4. COMMUNICATION SKILLS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Clear Reporting:</b> Providing detailed reports.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Briefing & Coordination:</b> Communicating with other dept/agencies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Interpersonal Communication:</b> Engaging professionally.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Conflict De-escalation:</b> Handling confrontations.</div>`}, { title: "5. SURVEILLANCE & MONITORING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Monitoring Systems:</b> Ensuring continuous monitoring.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Patrol Oversight:</b> Supervising patrols.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Documentation:</b> Ensuring proper recording.</div>`}, { title: "6. COMPLIANCE & LEGAL", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Regulatory Compliance:</b> Knowledge of relevant laws.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adherence to Policies:</b> Ensuring compliance with company policy.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Confidentiality:</b> Maintaining strict confidentiality.</div>`}, { title: "7. OPERATIONAL EFFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Scheduling:</b> Efficiently scheduling personnel.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Cost Control:</b> Operating within budget.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Process Improvement:</b> Identifying efficiency improvements.</div>`}, { title: "8. PHYSICAL FITNESS & READINESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Physical Fitness:</b> Ensuring team capability.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Equipment Handling:</b> Proficiency with security gear.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Health & Safety:</b> Focus on team safety.</div>`}, { title: "9. CUSTOMER SERVICE", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Client Interaction:</b> Professional interaction.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Proactive Measures:</b> Engaging clients on concerns.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Customer Satisfaction:</b> Monitoring stakeholder satisfaction.</div>`}, { title: "10. PERFORMANCE MONITORING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>KPIs:</b> Tracking security metrics.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Reporting:</b> Ensuring prompt reporting/investigation.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Security Audits:</b> Conducting regular audits.</div>`}, { title: "11. ADAPTABILITY & LEARNING", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Adapting Environments:</b> Adjusting strategies.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Continuous Learning:</b> Staying updated.</div>`}, { title: "12. TECHNOLOGY PROFICIENCY", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Tech Management:</b> Operating/troubleshooting security tech.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Tech Integration:</b> Understanding new tech benefits.</div>`}, { title: "13. EMERGENCY PREPAREDNESS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Emergency Drills:</b> Overseeing effective drills.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Command:</b> Leading emergency response.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Risk Assessment:</b> Assessing emergency risks.</div>`}, { title: "14. INTEGRITY & PROFESSIONALISM", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Ethics & Accountability:</b> High integrity.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Trustworthiness:</b> Demonstrating honesty/discretion.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Professional Development:</b> Continuing self-improvement.</div>`}, { title: "15. KEY PERFORMANCE METRICS", details: `<div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Response Time:</b> Speed of incident handling.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Incident Frequency:</b> Monitoring/reducing incidents.</div><div style="border: 1px solid #ddd; padding: 2px; margin: 0; margin-bottom: 3px;"><b>Staff Retention:</b> Retaining qualified staff.</div>`} ]
              // ... Add ALL other roles and their full metric details here ...
          };
        const ratingDescriptions = { 1: "Poor", 2: "Average", 3: "Good", 4: "Very Good", 5: "Excellent" };

        // --- Show/Hide page functions ---
        function showWelcomeMessageFromEval() {
            if (evaluationPageElement) evaluationPageElement.style.display = 'none';
            if (evaluationFormContainerElement) evaluationFormContainerElement.style.display = 'none';
            if (welcomePageElement) welcomePageElement.style.display = 'block';
            if (loginContainerElement) loginContainerElement.style.display = 'block';
            if (welcomeMessageContainerElement) welcomeMessageContainerElement.style.display = 'none';
            document.querySelectorAll('.background-panel').forEach(p => p.style.display = 'block');
            document.body.classList.add('gradient-background');
            window.scrollTo(0, 0);
        }

        function showEvaluationPage() {
            if (welcomePageElement) welcomePageElement.style.display = 'none';
            if (evaluationFormContainerElement) evaluationFormContainerElement.style.display = 'none';
            if (evaluationPageElement) evaluationPageElement.style.display = 'block';
            document.body.classList.add('gradient-background');
            window.scrollTo(0, 0);
        }

        function showEvaluationFormByType(formType) {
            console.log("Showing form for:", formType);
            currentFormType = formType;
            if (evaluationPageElement) evaluationPageElement.style.display = 'none';
            if (welcomePageElement) welcomePageElement.style.display = 'none';

            const titleElement = document.getElementById('form-header-title');
            if(titleElement) { titleElement.textContent = `EMPLOYEE PERFORMANCE EVALUATION FORM - ${formType.toUpperCase()}`; }

            clearAllFormInputs(); // Clear inputs when switching form type
            renderMetrics(formType); // Render new metrics

            if (overallPerformanceText) {
                 overallPerformanceText.textContent = "Please rate all metrics.";
            } else {
                console.error("Element with ID 'overall-performance' not found.");
            }

            if (evaluationFormContainerElement) evaluationFormContainerElement.style.display = 'block';
            document.body.classList.remove('gradient-background');
            window.scrollTo(0, 0);
        }

        // --- Clear Functions ---
        function clearAllFormInputs() {
             // Clear specific input fields only if they exist
             if (employeeNumberInput) employeeNumberInput.value = '';
             clearEmployeeFields(); // Clear related employee detail fields

             if (reviewerNumberInput) reviewerNumberInput.value = '';
             clearReviewerFields(); // Clear related reviewer detail fields

             if (witness2NumberInput) witness2NumberInput.value = '';
             clearWitness2Fields();

             if (witness3NumberInput) witness3NumberInput.value = '';
             clearWitness3Fields();

             if (hodNumberInput) hodNumberInput.value = '';
             clearHODFields();

             const reviewDateHeader = document.getElementById("review-date-header");
             if (reviewDateHeader) reviewDateHeader.value = '';

             const remarksTextArea = document.getElementById("remarks");
             if (remarksTextArea) remarksTextArea.value = '';

             // Clear metrics ratings and comments, and collapse accordions
             if (metricsContainer) {
                 metricsContainer.querySelectorAll('input[type="radio"]').forEach(radio => radio.checked = false);
                 metricsContainer.querySelectorAll('.rating-option.selected').forEach(opt => opt.classList.remove('selected'));
                 metricsContainer.querySelectorAll('textarea').forEach(textarea => textarea.value = '');
                 // Collapse all accordion items
                 metricsContainer.querySelectorAll('.performance-feedback.expanded').forEach(item => {
                     item.classList.remove('expanded');
                     const indicator = item.querySelector('.metric-indicator');
                     if (indicator) {
                         indicator.classList.remove('fa-chevron-up');
                         indicator.classList.add('fa-chevron-down');
                     }
                 });
             } else {
                console.warn("Metrics container not found during clear.")
             }

             // Reset highlights and overall performance text
             resetHighlightedFields();
             updateOverallPerformance(); // Update display after clearing
             console.log("Attempted to clear all form inputs.");
         }

        function clearEmployeeFields() {
            console.log("Clearing Employee detail fields.");
            if (employeeNameInput) employeeNameInput.value = '';
            if (positionTextInput) positionTextInput.value = '';
            if (employeeGroupInput) employeeGroupInput.value = '';
            if (divisionTextInput) divisionTextInput.value = '';
            if (departmentTextInput) departmentTextInput.value = '';
            if (emailInput) emailInput.value = ''; // Email is now optional
            if (contactInput) contactInput.value = '';
            // Clear corresponding signature fields
            const empNumSig = document.getElementById("employee-number-signature");
            const empNameSig = document.getElementById("employee-name-signature");
            const empPosSig = document.getElementById("position-signature");
            if(empNumSig) empNumSig.value = '';
            if(empNameSig) empNameSig.value = '';
            if(empPosSig) empPosSig.value = '';
        }

        function clearReviewerFields() {
             console.log("Clearing Reviewer detail fields.");
             if (reviewerNameInput) reviewerNameInput.value = '';
             // Clear corresponding signature fields
             const revNumSig = document.getElementById("reviewer-number-signature");
             const revNameSig = document.getElementById("reviewer-name-signature");
             const revPosSig = document.getElementById("reviewer-position-signature");
             if(revNumSig) revNumSig.value = '';
             if(revNameSig) revNameSig.value = '';
             if(revPosSig) revPosSig.value = '';
         }

        function clearWitness2Fields() {
            console.log("Clearing Witness 1 detail fields.");
            if (witness2NameInput) witness2NameInput.value = '';
            if (witness2PosInput) witness2PosInput.value = '';
        }

        function clearWitness3Fields() {
            console.log("Clearing Witness 2 detail fields.");
            if (witness3NameInput) witness3NameInput.value = '';
            if (witness3PosInput) witness3PosInput.value = '';
        }

        function clearHODFields() {
            console.log("Clearing HOD detail fields.");
            if (hodNameInput) hodNameInput.value = '';
            if (hodPosInput) hodPosInput.value = '';
        }

        // --- Metrics Rendering (Accordion Style) ---
        function renderMetrics(formType) {
            if (!metricsContainer) {
                console.error("Cannot render metrics: Container element not found.");
                return;
            }
            metricsContainer.innerHTML = ''; // Clear previous metrics
            const currentMetrics = allMetricsData[formType] || [];

            if (currentMetrics.length === 0 && formType) {
                metricsContainer.innerHTML = "<p style='color: #dc3545; text-align: center; padding: 15px;'>Metrics definition not found for this position.</p>";
                return;
            }

            currentMetrics.forEach((metric, index) => {
                const metricDiv = document.createElement("div");
                metricDiv.classList.add("performance-feedback"); // Keep this class, add 'expanded' later on click

                let ratingOptionsHTML = "";
                for (let i = 1; i <= 5; i++) {
                    const radioId = `rating-${formType.replace(/\s+/g, '-')}-${index}-${i}`;
                    const radioName = `rating-${formType.replace(/\s+/g, '-')}-${index}`;
                    const description = ratingDescriptions[i] || `Rating ${i}`;
                    ratingOptionsHTML += `<label class="rating-option" for="${radioId}"><input type="radio" name="${radioName}" value="${i}" id="${radioId}"><div class="rating-number">${i}</div><span class="rating-text">${description}</span></label>`;
                }

                const commentId = `comments-${formType.replace(/\s+/g, '-')}-${index}`;
                const hrCommentId = `hr-comments-${formType.replace(/\s+/g, '-')}-${index}`;

                metricDiv.innerHTML = `
                    <div class="ac-metric-title metric-toggle">
                         <span><b>${metric.title || `Metric ${index + 1}`}</b></span>
                         <span class="metric-indicator fas fa-chevron-down"></span>
                    </div>
                    <div class="metric-content">
                        <div class="metric-details-container">${metric.details || "No details provided."}</div>
                        <div class="metric-rating-box"><div class="rating-scale">${ratingOptionsHTML}</div></div>
                        <div class="ac-comments-container">
                            <div><label for="${commentId}" class="required-field">Employee Comments:</label><textarea id="${commentId}" rows="3" placeholder="Enter comments..." class="required"></textarea></div>
                            <div><label for="${hrCommentId}">HR Comments:</label><textarea id="${hrCommentId}" rows="3" placeholder="Enter HR comments..."></textarea></div>
                        </div>
                    </div>`;
                metricsContainer.appendChild(metricDiv);
            });

            // Re-attach event listeners after rendering new metrics
            metricsContainer.removeEventListener("change", handleRatingChange);
            metricsContainer.addEventListener("change", handleRatingChange);

            // Add Accordion Toggle Listener (using event delegation)
            metricsContainer.removeEventListener("click", handleAccordionToggle); // Remove previous if exists
            metricsContainer.addEventListener("click", handleAccordionToggle);
        }

        // --- Accordion Toggle Handler ---
        function handleAccordionToggle(event) {
            const toggleButton = event.target.closest('.metric-toggle');
            if (!toggleButton) return; // Click wasn't on a toggle button or its children

            event.preventDefault(); // Prevent any default action
            const metricItem = toggleButton.closest('.performance-feedback');
            const indicator = toggleButton.querySelector('.metric-indicator');

            if (metricItem && indicator) {
                metricItem.classList.toggle('expanded');
                // Toggle icon class
                if (metricItem.classList.contains('expanded')) {
                    indicator.classList.remove('fa-chevron-down');
                    indicator.classList.add('fa-chevron-up');
                    // Remove highlight from title when expanded (if it was highlighted due to validation)
                    toggleButton.classList.remove('highlighted');
                } else {
                    indicator.classList.remove('fa-chevron-up');
                    indicator.classList.add('fa-chevron-down');
                }
            }
        }


        // --- Rating Click & Overall Performance Update ---
        function handleRatingChange(event) {
             // Handles clicks on the radio buttons within the rating options
            if (event.target.type === 'radio' && event.target.closest('.rating-option')) {
                 const clickedLabel = event.target.closest('.rating-option');
                 const ratingScale = clickedLabel.closest('.rating-scale');
                 if (ratingScale) {
                     // Update visual selection for the clicked scale
                     ratingScale.querySelectorAll('.rating-option').forEach(label => {
                         label.classList.toggle('selected', label.querySelector('input[type="radio"]').checked);
                     });
                 }
                 // Recalculate overall performance
                 updateOverallPerformance();
            }
        }

        function updateOverallPerformance() {
            if (!overallPerformanceText) {
                console.error("Cannot update overall performance: Text element not found.");
                return;
            }
            if (!currentFormType || !allMetricsData[currentFormType]) {
                 overallPerformanceText.textContent = "Please select a form type."; return;
            }

            const currentMetrics = allMetricsData[currentFormType];
            const ratings = [];
            let allRated = true; // Assume all are rated initially

            currentMetrics.forEach((metric, index) => {
                const radioName = `rating-${currentFormType.replace(/\s+/g, '-')}-${index}`;
                const selectedRating = metricsContainer ? metricsContainer.querySelector(`input[name="${radioName}"]:checked`) : null;
                if (selectedRating) {
                    ratings.push(parseInt(selectedRating.value));
                } else {
                    allRated = false; // Mark as not fully rated if any metric is missing a rating
                }
            });

            if (currentMetrics.length === 0) {
                 overallPerformanceText.textContent = "No metrics defined for this form.";
            } else if (allRated) { // Only calculate average if all metrics are rated
                 const average = ratings.reduce((a, b) => a + b, 0) / ratings.length;
                 const roundedAverage = Math.round(average);
                 // Ensure rating description exists for the rounded average
                 const description = ratingDescriptions[roundedAverage] || "Unknown";
                 overallPerformanceText.textContent = `Overall Performance Rating: ${description} (${average.toFixed(1)})`;
             } else {
                 overallPerformanceText.textContent = "Please rate all metrics.";
             }
         }

        // --- SAVE PROCESS FUNCTIONS ---
        function downloadAndSave() {
            console.log("Initiating download and save process...");
            if (!validateForm()) {
                console.log("Validation failed. Aborting save.");
                return;
            }
            const formData = collectFormData();
            if (!formData) {
                alert("Error collecting form data. Cannot proceed.");
                return;
            }
            console.log("Form data collected successfully.");
            // Call PDF download first, then send data in its completion callback (or parallel if desired)
            downloadPDF_noCallback(() => {
                console.log("PDF generation process initiated/completed. Proceeding to send data...");
                sendDataToSheet(formData);
            });
        }

        function collectFormData() {
            console.log("--- Starting collectFormData ---");
            if (!currentFormType) { console.error("Cannot collect data: currentFormType is not set."); alert("Error: Form type is not selected."); return null; }
            const MAX_METRICS = 15; // Max number of metrics to potentially collect
            console.log("Current Form Type:", currentFormType);

            try {
                // Helper to safely get element value or return empty string
                const getVal = (id) => document.getElementById(id)?.value || '';

                const formData = {
                    "Form Name": `${currentFormType} Performance Evaluation`,
                    "Review Date": getVal("review-date-header"),
                    "Employee ID": getVal("emp-number"),
                    "Employee Name": getVal("emp-name"),
                    "Position Text": getVal("position-text"),
                    "Employee Group": getVal("emp-group"),
                    "Division Text": getVal("division-text"),
                    "Department Text": getVal("department-text"),
                    "Email ID": getVal("email"), // Email is optional now
                    "Contact Number": getVal("contact"),
                    "Reviewer Emp ID": getVal("reviewer-number"),
                    "Reviewer Name": getVal("reviewer-name"),
                    "Overall Remarks / Comments": getVal("remarks"),
                    // Signature fields
                    "First Witness Details": `ID: ${getVal("employee-number-2")}, Name: ${getVal("employee-name-2")}, Position: ${getVal("position-2")}`,
                    "Second Witness Details": `ID: ${getVal("employee-number-3")}, Name: ${getVal("employee-name-3")}, Position: ${getVal("position-3")}`,
                    "Reviewer Emp ID (Signature)": getVal("reviewer-number-signature"),
                    "Reviewer Name (Signature)": getVal("reviewer-name-signature"),
                    "Reviewer Position (Signature)": getVal("reviewer-position-signature"),
                    "HOD Emp ID": getVal("hod-number"),
                    "HOD Name": getVal("hod-name"),
                    "HOD Position": getVal("hod-position")
                };

                // Collect Metrics Data
                const currentMetrics = allMetricsData[currentFormType] || [];
                const numCurrentMetrics = currentMetrics.length;

                for (let i = 0; i < MAX_METRICS; i++) {
                    const metricIndex = i;
                    const metricNumber = i + 1;
                    const ratingKey = `Rating${metricNumber}`;
                    const empCommentKey = `Employee Comments${metricNumber}`;
                    const hrCommentKey = `HR Comments${metricNumber}`;

                    if (metricIndex < numCurrentMetrics && metricsContainer) {
                        let foundValue = "";
                        const radioName = `rating-${currentFormType.replace(/\s+/g, '-')}-${metricIndex}`;
                        const commentId = `comments-${currentFormType.replace(/\s+/g, '-')}-${metricIndex}`;
                        const hrCommentId = `hr-comments-${currentFormType.replace(/\s+/g, '-')}-${metricIndex}`;

                        const selectedRadio = metricsContainer.querySelector(`input[name="${radioName}"]:checked`);
                        if (selectedRadio) {
                            foundValue = parseInt(selectedRadio.value);
                        }
                        formData[ratingKey] = foundValue;
                        formData[empCommentKey] = document.getElementById(commentId)?.value || '';
                        formData[hrCommentKey] = document.getElementById(hrCommentId)?.value || '';
                    } else {
                        // Fill blanks for non-existent metrics up to MAX_METRICS
                        formData[ratingKey] = "";
                        formData[empCommentKey] = "";
                        formData[hrCommentKey] = "";
                    }
                }

                 // Collect Overall Performance Text and Rating
                 if (overallPerformanceText) {
                    formData["Overall Performance"] = overallPerformanceText.textContent;
                    const overallRatingTextContent = overallPerformanceText.textContent;
                    const match = overallRatingTextContent.match(/Rating: (.+?)(?: \()/);
                    formData["Overall Rating"] = match ? match[1].trim() : (overallRatingTextContent.includes("Please rate") ? "" : overallRatingTextContent); // Handle cases
                 } else {
                    formData["Overall Performance"] = "";
                    formData["Overall Rating"] = "";
                 }


                console.log("--- Final Keys in formData: ---", Object.keys(formData).length); // Log count of keys
                // console.log("--- formData Content: ---", formData); // Uncomment to see full data if needed
                console.log("--- End collectFormData ---");
                return formData;

            } catch (error) {
                console.error("Error during collectFormData:", error);
                alert("An error occurred while collecting form data. Please check console.");
                return null;
            }
        }

        function downloadPDF_noCallback(onComplete) {
            console.log("Preparing PDF download...");
            const element = document.getElementById("form-container");
            if (!element) {
                console.error("PDF generation failed: form-container not found.");
                alert("Error generating PDF: Form container missing.");
                if (onComplete) onComplete(); // Still call callback if PDF fails? Decide based on requirement.
                return;
            }

            const downloadButton = element.querySelector('.ac-download-button');
            const backButtonEvalList = element.querySelector('button[onclick="showEvaluationPage()"]');
            const signatureDatePlaceholders = element.querySelectorAll('.approval-signature-table input[placeholder="SIGNATURE / DATE"]');

            // Store original states and temporarily expand all metrics for PDF
            let originalButtonDisplay = downloadButton ? downloadButton.style.display : '';
            let originalBackButtonDisplay = backButtonEvalList ? backButtonEvalList.style.display : '';
            const originalSignatureValues = [];
            signatureDatePlaceholders.forEach((input, index) => { originalSignatureValues[index] = input.value; });
            const originallyCollapsedMetrics = [];
             if (metricsContainer) {
                 metricsContainer.querySelectorAll('.performance-feedback:not(.expanded)').forEach(item => {
                     originallyCollapsedMetrics.push(item);
                     item.classList.add('expanded'); // Expand for PDF
                     const indicator = item.querySelector('.metric-indicator');
                     if (indicator) {
                         indicator.classList.remove('fa-chevron-down');
                         indicator.classList.add('fa-chevron-up');
                     }
                 });
             }

            // Hide elements for PDF
            if (downloadButton) downloadButton.style.display = 'none';
            if (backButtonEvalList) backButtonEvalList.style.display = 'none';
            signatureDatePlaceholders.forEach(input => { input.value = ''; }); // Clear signature/date for PDF

            const safeFormType = currentFormType ? currentFormType.replace(/[^a-zA-Z0-9]/g, '_') : 'Form';
            const empIdForFilename = document.getElementById('emp-number')?.value || 'Employee';
            const filename = `${safeFormType}_Eval_${empIdForFilename}.pdf`;

            const opt = {
                 margin: [5, 5, 5, 5], // mm [top, left, bottom, right]
                 filename: filename,
                 image: { type: 'jpeg', quality: 0.98 },
                 html2canvas: {
                     scale: 2,
                     useCORS: true,
                     dpi: 192,
                     letterRendering: true,
                     logging: false,
                     // Ensure it waits for images/transitions if any, though less likely here
                     // allowTaint: true // Use if CORS issues persist with images, but can reduce quality
                 },
                 jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
                 pagebreak: { mode: ['css', 'avoid-all', 'legacy'] } // Avoid breaking elements where possible
             };


            console.log("Generating PDF with options:", opt);

            // Add a small delay before generating PDF to allow DOM changes (expanding) to render
             setTimeout(() => {
                 html2pdf().from(element).set(opt).save().then(() => {
                     console.log("PDF generation finished.");
                     // Restore elements and collapse metrics after PDF generation
                     restoreElementsAndMetrics(downloadButton, backButtonEvalList, signatureDatePlaceholders, originalButtonDisplay, originalBackButtonDisplay, originalSignatureValues, originallyCollapsedMetrics);
                     // Call the completion callback
                     if (onComplete) setTimeout(onComplete, 50);
                 }).catch(err => {
                     console.error("Error during PDF generation:", err);
                     alert("Failed to generate PDF. Please check console. Data saving will still be attempted.");
                     // Restore elements and collapse metrics even if PDF fails
                     restoreElementsAndMetrics(downloadButton, backButtonEvalList, signatureDatePlaceholders, originalButtonDisplay, originalBackButtonDisplay, originalSignatureValues, originallyCollapsedMetrics);
                     // Call the completion callback even on PDF error
                     if (onComplete) setTimeout(onComplete, 50);
                 });
             }, 200); // 200ms delay - adjust if needed
        }

        // Helper function to restore elements and collapse metrics after PDF generation
        function restoreElementsAndMetrics(dlBtn, backBtn, sigInputs, origDlDisp, origBackDisp, origSigVals, collapsedMetrics) {
             if (dlBtn) dlBtn.style.display = origDlDisp;
             if (backBtn) backBtn.style.display = origBackDisp;
             sigInputs.forEach((input, index) => { input.value = origSigVals[index] || ''; });
             // Collapse the metrics that were originally collapsed
             collapsedMetrics.forEach(item => {
                 item.classList.remove('expanded');
                 const indicator = item.querySelector('.metric-indicator');
                 if (indicator) {
                     indicator.classList.remove('fa-chevron-up');
                     indicator.classList.add('fa-chevron-down');
                 }
             });
        }


        function sendDataToSheet(formData) {
            if (!formData) {
                alert("Cannot save data - Form data is missing.");
                return;
            }
            console.log("--- Sending data to Google Apps Script ---");
            // console.log("Data being sent:", JSON.stringify(formData)); // Uncomment to verify payload

            fetch(googleAppsScriptUrl, {
                method: "POST",
                // Use text/plain for simple POST to Apps Script doGet/doPost
                // If your Apps Script expects JSON, use 'application/json'
                headers: {
                    "Content-Type": "text/plain",
                },
                body: JSON.stringify(formData), // Stringify the data
                mode: 'no-cors' // Necessary for simple POST across origins to Apps Script
            })
            .then(response => {
                // With no-cors, response is opaque, status is 0, ok is false.
                // We can't reliably check success here, so assume initiation was ok.
                console.log("Data send request initiated (no-cors). Form will be cleared.");
                alert("PDF downloaded (or attempted) and data saving initiated!");
                clearAllFormInputs(); // Clear form after initiating save
            })
            .catch(error => {
                console.error("Fetch Error sending data:", error);
                alert(`Network Error sending data: ${error.message}. Please check your connection or contact support. The form has not been cleared.`);
                // Do NOT clear the form if the fetch itself fails
            });
        }


        // --- VALIDATION FUNCTIONS ---
        function validateForm() {
            let isValid = true;
            let firstErrorElement = null; // Keep track of the first error element
            resetHighlightedFields(); // Clear previous highlights
            console.log("Starting form validation...");

            // Check required text/date inputs
            const requiredInputs = document.querySelectorAll('#evaluation-form-container .required');
            requiredInputs.forEach(input => {
                if (input.id === 'email') return; // Skip optional email

                let isFieldValid = true;
                if (input.type === 'date') {
                    if (!input.value) isFieldValid = false;
                } else if (input.tagName === 'TEXTAREA') {
                    if (!input.value.trim()) isFieldValid = false;
                } else { // General input fields
                    if (!input.value.trim()) isFieldValid = false;
                }

                if (!isFieldValid) {
                    isValid = false;
                    const fieldToHighlight = (input.type === 'date') ? input.closest('.ac-review-date') : input;
                    highlightField(fieldToHighlight);
                    if (!firstErrorElement) firstErrorElement = fieldToHighlight; // Store first error
                    console.warn(`Validation failed: Input '${input.id || input.name || 'Date'}' is empty.`);
                }
            });

            // Validate metrics (ratings and required comments)
            if (currentFormType && allMetricsData[currentFormType] && metricsContainer) {
                const currentMetrics = allMetricsData[currentFormType];
                currentMetrics.forEach((metric, index) => {
                    const metricItem = metricsContainer.querySelector(`.performance-feedback:nth-of-type(${index + 1})`);
                    if (metricItem) {
                        const radioName = `rating-${currentFormType.replace(/\s+/g, '-')}-${index}`;
                        const commentId = `comments-${currentFormType.replace(/\s+/g, '-')}-${index}`;
                        const metricTitleToggle = metricItem.querySelector('.metric-toggle');

                        const selectedRating = metricItem.querySelector(`input[name="${radioName}"]:checked`);
                        const employeeComments = metricItem.querySelector(`#${commentId}`); // Employee comment textarea is required
                        const ratingContainer = metricItem.querySelector('.metric-rating-box');

                        let metricValid = true;

                        // Check if rating is selected
                        if (!selectedRating) {
                            isValid = false;
                            metricValid = false;
                            if (ratingContainer) highlightField(ratingContainer);
                            if (!firstErrorElement) firstErrorElement = ratingContainer || metricTitleToggle;
                            console.warn(`Validation failed: Rating missing for metric ${index + 1}`);
                        }

                        // Check if required employee comment is filled
                        if (employeeComments && !employeeComments.value.trim()) {
                            isValid = false;
                            metricValid = false;
                            highlightField(employeeComments);
                             if (!firstErrorElement) firstErrorElement = employeeComments;
                            console.warn(`Validation failed: Employee Comment missing for metric ${index + 1}`);
                        }

                         // If metric is invalid AND collapsed, expand it and highlight title
                         if (!metricValid && !metricItem.classList.contains('expanded')) {
                            metricItem.classList.add('expanded');
                            const indicator = metricTitleToggle?.querySelector('.metric-indicator');
                             if (indicator) {
                                indicator.classList.remove('fa-chevron-down');
                                indicator.classList.add('fa-chevron-up');
                             }
                             if (metricTitleToggle) {
                                 highlightField(metricTitleToggle); // Highlight title too if collapsed
                                 if (!firstErrorElement) firstErrorElement = metricTitleToggle; // Prioritize title if collapsed
                             }
                         }


                    } else {
                       console.warn(`Metric box ${index+1} not found for validation.`);
                    }
                });
            } else {
                console.warn("Validation skipped for metrics: No form type/metrics defined or container missing.");
            }

            // Final check, alert, and scroll to first error
            if (!isValid) {
                console.log("Validation failed. Alerting user.");
                alert("Please fill in all highlighted required fields (*), including ratings and employee comments for each metric.");
                if (firstErrorElement) {
                    try {
                        // Special handling for metric title highlight
                        const targetElement = firstErrorElement.classList.contains('metric-toggle') ? firstErrorElement : firstErrorElement;

                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'center' });

                        // Try focusing the element if it's focusable (input, textarea)
                        // Don't focus the rating box or title div directly
                        if (['INPUT', 'TEXTAREA'].includes(targetElement.tagName)) {
                           setTimeout(() => {
                              try { targetElement.focus({ preventScroll: true }); } // preventScroll avoids conflict with scrollIntoView
                              catch (e) { console.warn("Focus failed on element:", targetElement, e); }
                           }, 150); // Delay focus slightly after scroll
                        }
                    } catch (e) {
                        console.error("Error scrolling/focusing on validation error:", e);
                    }
                }
            } else {
               console.log("Validation passed.");
            }
            return isValid;
        }


        function highlightField(element) {
            if(!element) {
                console.warn("Attempted to highlight a null element.");
                return;
            }
            element.classList.add("highlighted");
        }

        function resetHighlightedFields() {
            const highlighted = document.querySelectorAll('#evaluation-form-container .highlighted');
            highlighted.forEach(element => {
                element.classList.remove('highlighted');
            });
             // console.log("Reset highlighted fields.");
        }

        // --- FETCH & PARSE DATA ---
        function fetchEmployeeData() {
            console.log("Fetching Employee Data...");
            return fetch(googleSheetsUrl)
                .then(response => {
                    if (!response.ok) throw new Error(`Network response error (Employee): ${response.statusText} (${response.status})`);
                    return response.text();
                })
                .then(csvData => {
                    employeeData = parseCSV(csvData);
                    console.log(`Employee data loaded: ${employeeData.length} records.`);
                    return employeeData; // Return data for chaining if needed
                })
                .catch(error => {
                    console.error("Fetch Employee Error:", error);
                    alert(`Failed to load employee data: ${error.message}`);
                    employeeData = []; // Ensure it's empty on error
                });
        }

        function fetchUserData() {
            console.log("Fetching User Data...");
            return fetch(usersGoogleSheetsUrl)
                .then(response => {
                    if (!response.ok) throw new Error(`Network response error (User): ${response.statusText} (${response.status})`);
                    return response.text();
                })
                .then(csvData => {
                    userData = parseUsersCSV(csvData);
                    console.log(`User data loaded: ${userData.length} records.`);
                    return userData; // Return data for chaining if needed
                })
                .catch(error => {
                    console.error("Fetch User Error:", error);
                    alert(`Failed to load user auth data: ${error.message}`);
                    userData = []; // Ensure it's empty on error
                });
        }

        function parseCSV(csv) {
            const lines = csv.split(/[\r\n]+/).filter(line => line.trim() !== '');
            if (lines.length < 1) return [];
            const headers = lines[0].split(",").map(h => h.trim());
            const result = [];
            // console.log("CSV Headers (Employee):", headers.join(', ')); // Log headers

            for (let i = 1; i < lines.length; i++) {
                const obj = {};
                // Basic CSV split, doesn't handle quotes/commas within fields well
                const currentLine = lines[i].split(",");
                if (currentLine && currentLine.length >= headers.length) {
                    headers.forEach((h, j) => obj[h] = currentLine[j]?.trim() ?? "");
                    result.push(obj);
                } else if (lines[i] && lines[i].trim()) {
                    console.warn(`Skipping Employee line ${i + 1}: Mismatched columns. Expected ${headers.length}, got ${currentLine?.length ?? 0}. Line: "${lines[i]}"`);
                }
            }
            return result;
        }

        function parseUsersCSV(csv) {
            const lines = csv.split(/[\r\n]+/).filter(line => line.trim() !== '');
            if (lines.length < 1) return [];
            const headers = lines[0].split(',').map(h => h.trim());
            const users = [];
            // console.log("CSV Headers (Users):", headers.join(', ')); // Log headers

            for (let i = 1; i < lines.length; i++) {
                 // Basic CSV split
                const data = lines[i].split(',');
                if (data && data.length >= headers.length) {
                    const user = {};
                    headers.forEach((h, j) => user[h] = data[j]?.trim() ?? '');
                    users.push(user);
                } else if (lines[i] && lines[i].trim()) {
                    console.warn(`Skipping User line ${i + 1}: Mismatched columns. Expected ${headers.length}, got ${data?.length ?? 0}. Line: "${lines[i]}"`);
                }
            }
            return users;
        }


        // --- Populate Functions (Revised Logic) ---

        function populateEmployeeDetails(empNumber) {
             console.log(`Attempting to populate details for Employee No: ${empNumber}`);
             clearEmployeeFields(); // Clear previous details first

             if (!employeeData || employeeData.length === 0) { console.warn("Employee data not ready for lookup."); return; }
             if (!currentFormType) { console.warn("Cannot check applicability: currentFormType not set."); return; }

             const length = empNumber.length;

             // Only proceed with lookup if length is 3 or 6
             if (length !== 3 && length !== 6) {
                 console.log(`Employee number ${empNumber} has invalid length (${length}). Lookup skipped.`);
                 return; // Don't search if length is not 3 or 6
             }

             const employee = employeeData.find(emp => emp && emp["Employee Number"] === empNumber);

             if (employee) {
                 // Employee found, proceed with applicability check
                 const targetForm = currentFormType;
                 // Ensure property names match EXACTLY with CSV headers
                 const app1 = employee["Forms applicability 1"]?.trim() || "";
                 const app2 = employee["Forms applicability 2"]?.trim() || "";
                 const app3 = employee["Forms applicability 3"]?.trim() || "";
                 console.log(`Applicability Check for ${empNumber}: [${app1}, ${app2}, ${app3}] vs Target: ${targetForm}`);

                 if (app1 === targetForm || app2 === targetForm || app3 === targetForm) {
                     console.log(`Employee ${empNumber} IS applicable for ${targetForm}. Populating fields...`);
                     if(employeeNameInput) employeeNameInput.value = employee["Employee Name"] || "";
                     if(positionTextInput) positionTextInput.value = employee["Position Text"] || "";
                     if(employeeGroupInput) employeeGroupInput.value = employee["Employee Group"] || "";
                     if(divisionTextInput) divisionTextInput.value = employee["Division"] || "";
                     if(departmentTextInput) departmentTextInput.value = employee["Department"] || "";
                     if(emailInput) emailInput.value = employee["Email ID"] || ""; // Populate even if optional
                     if(contactInput) contactInput.value = employee["Contact Number"] || "";
                     // Populate signature section
                     const empNumSig = document.getElementById("employee-number-signature");
                     const empNameSig = document.getElementById("employee-name-signature");
                     const empPosSig = document.getElementById("position-signature");
                     if(empNumSig) empNumSig.value = empNumber;
                     if(empNameSig) empNameSig.value = employee["Employee Name"] || "";
                     if(empPosSig) empPosSig.value = employee["Position Text"] || "";
                 } else {
                     console.log(`Employee ${empNumber} IS NOT applicable for ${targetForm}.`);
                     alert(`Employee ${empNumber} (${employee["Employee Name"] || 'N/A'}) is not designated for the ${targetForm} evaluation form.`);
                     if (employeeNumberInput) employeeNumberInput.value = ''; // Clear the input field as it's not applicable
                     clearEmployeeFields(); // Clear associated fields
                 }
             } else {
                 // Employee not found
                 console.log(`Employee number ${empNumber} (length ${length}) not found in data.`);
                 // âœ¨ Only show "not found" alert if it was a 6-digit search âœ¨
                 if (length === 6) {
                     alert(`Employee number ${empNumber} not found.`);
                     // Don't clear the input field (employeeNumberInput.value) - user might want to correct it
                     clearEmployeeFields(); // Clear associated fields
                 } else {
                     // If it was a 3-digit search and not found, do nothing, user might still be typing
                     console.log("3-digit employee number not found, waiting for more input or blur.");
                 }
             }
         }

         function populateReviewerDetails(reviewerNumber) {
            console.log(`Attempting to populate details for Reviewer ID: ${reviewerNumber}`);
            clearReviewerFields(); // Clear previous details

            if (!reviewerNumber || reviewerNumber.length !== 6) {
                console.log(`Reviewer ID ${reviewerNumber} has invalid length or is empty. Skipping lookup.`);
                return false; // Indicate failure or skip
            }
            if (!employeeData || employeeData.length === 0) { console.warn("Employee data not ready for reviewer lookup."); return false; }
            if (!reviewerNumberInput || !reviewerNameInput) { console.error("Reviewer input elements not found."); return false;}


            const reviewer = employeeData.find(e => e && e["Employee Number"] === reviewerNumber);

            if (reviewer) {
                const empNo = employeeNumberInput ? employeeNumberInput.value : '';
                if (reviewerNumber === empNo && empNo) {
                    alert("Reviewer cannot be the same as the employee.");
                    reviewerNumberInput.value = ""; // Clear the input
                    clearReviewerFields();
                    return false; // Indicate conflict
                }
                console.log(`Reviewer ${reviewerNumber} found. Populating...`);
                reviewerNameInput.value = reviewer["Employee Name"] || "";
                // Populate signature section for reviewer
                 const revNumSig = document.getElementById("reviewer-number-signature");
                 const revNameSig = document.getElementById("reviewer-name-signature");
                 const revPosSig = document.getElementById("reviewer-position-signature");
                 if(revNumSig) revNumSig.value = reviewerNumber;
                 if(revNameSig) revNameSig.value = reviewer["Employee Name"] || "";
                 if(revPosSig) revPosSig.value = reviewer["Position Text"] || "";
                return true; // Indicate success
            } else {
                console.log(`Reviewer ID ${reviewerNumber} not found in data.`);
                alert(`Reviewer ID ${reviewerNumber} not found.`);
                // Don't clear reviewerNumberInput, allow correction
                clearReviewerFields(); // Clear name/sig fields
                return false; // Indicate not found
            }
        }

        function populateSignatureDetails(witnessNumber, witnessNumberInputId, nameInputId, positionInputId) {
            const nameInput = document.getElementById(nameInputId);
            const posInput = document.getElementById(positionInputId);
            const witnessInput = document.getElementById(witnessNumberInputId); // Get the input element itself

            // Determine if this is Witness 2 or Witness 3 for console logging
            const witnessLabel = nameInputId.includes("2") ? "Witness 1" : "Witness 2";
            console.log(`Attempting to populate details for ${witnessLabel} ID: ${witnessNumber}`);

            // Ensure elements exist before proceeding
             if (!nameInput || !posInput || !witnessInput) {
                 console.error(`Error populating ${witnessLabel}: One or more elements (${witnessNumberInputId}, ${nameInputId}, ${positionInputId}) not found.`);
                 return false;
             }

            // Always clear the name and position first
            nameInput.value = "";
            posInput.value = "";

            if (!witnessNumber || witnessNumber.length !== 6) {
                console.log(`${witnessLabel} ID ${witnessNumber} has invalid length or is empty. Skipping lookup.`);
                return false; // Invalid length
            }

            if (!employeeData || employeeData.length === 0) { console.warn(`Employee data not ready for ${witnessLabel} lookup.`); return false; }

            // --- Conflict Checks ---
            const mainEmpNo = employeeNumberInput?.value || '';
            const reviewerNo = reviewerNumberInput?.value || '';
            const witness2No = witness2NumberInput?.value || '';
            const witness3No = witness3NumberInput?.value || '';
            let validationError = "";

            if (witnessNumber === mainEmpNo && mainEmpNo) validationError = `${witnessLabel} cannot be the employee.`;
            else if (witnessNumber === reviewerNo && reviewerNo) validationError = `${witnessLabel} cannot be the reviewer.`;
            else if (witnessLabel === "Witness 1" && witnessNumber === witness3No && witness3No) validationError = "Witnesses cannot be the same.";
            else if (witnessLabel === "Witness 2" && witnessNumber === witness2No && witness2No) validationError = "Witnesses cannot be the same.";

            if (validationError) {
                alert(validationError);
                witnessInput.value = ''; // Clear the conflicting input ID
                nameInput.value = '';
                posInput.value = '';
                return false; // Conflict detected
            }
            // --- End Conflict Checks ---

            const employee = employeeData.find(emp => emp && emp["Employee Number"] === witnessNumber);

            if (employee) {
                console.log(`${witnessLabel} ${witnessNumber} found. Populating...`);
                nameInput.value = employee["Employee Name"] || "";
                posInput.value = employee["Position Text"] || "";
                return true; // Found and populated
            } else {
                console.log(`${witnessLabel} ID ${witnessNumber} not found in data.`);
                alert(`${witnessLabel} ID ${witnessNumber} not found.`);
                // Don't clear the witnessNumber input field itself, allow correction
                nameInput.value = ''; // Clear name
                posInput.value = '';   // Clear position
                return false; // Not found
            }
        }

        function populateHODDetails(hodNumber) {
             console.log(`Attempting to populate details for HOD ID: ${hodNumber}`);
             clearHODFields(); // Clear previous details

              if (!hodNameInput || !hodPosInput || !hodNumberInput) {
                 console.error("Error populating HOD: One or more HOD elements not found.");
                 return false;
             }


             if (!hodNumber || hodNumber.length !== 6) {
                 console.log(`HOD ID ${hodNumber} has invalid length or is empty. Skipping lookup.`);
                 return false;
             }

             if (!employeeData || employeeData.length === 0) { console.warn("Employee data not ready for HOD lookup."); return false; }

             // --- Conflict Checks ---
             const mainEmpNo = employeeNumberInput?.value || '';
             const reviewerNo = reviewerNumberInput?.value || '';
             const witness2No = witness2NumberInput?.value || '';
             const witness3No = witness3NumberInput?.value || '';
             let validationError = "";

             if (hodNumber === mainEmpNo && mainEmpNo) validationError = "HOD cannot be the employee.";
             else if (hodNumber === reviewerNo && reviewerNo) validationError = "HOD cannot be the reviewer.";
             else if (hodNumber === witness2No && witness2No) validationError = "HOD cannot be Witness 1.";
             else if (hodNumber === witness3No && witness3No) validationError = "HOD cannot be Witness 2.";

             if (validationError) {
                 alert(validationError);
                 hodNumberInput.value = ''; // Clear the conflicting input ID
                 clearHODFields();
                 return false; // Conflict detected
             }
             // --- End Conflict Checks ---

             const employee = employeeData.find(emp => emp && emp["Employee Number"] === hodNumber);

             if (employee) {
                 console.log(`HOD ${hodNumber} found. Populating...`);
                 hodNameInput.value = employee["Employee Name"] || "";
                 hodPosInput.value = employee["Position Text"] || "";
                 return true;
             } else {
                 console.log(`HOD ID ${hodNumber} not found in data.`);
                 alert(`HOD ID ${hodNumber} not found.`);
                 // Don't clear hodNumberInput, allow correction
                 clearHODFields(); // Clear name/pos fields
                 return false;
             }
         }


        // --- Event Listeners (Revised with Delayed Lookup) ---
        function setupEventListeners() {
            console.log("Setting up event listeners...");

            // --- DOM Element References Initialization ---
             employeeNumberInput = document.getElementById("emp-number");
             employeeNameInput = document.getElementById("emp-name");
             positionTextInput = document.getElementById("position-text");
             employeeGroupInput = document.getElementById("emp-group");
             divisionTextInput = document.getElementById("division-text");
             departmentTextInput = document.getElementById("department-text");
             emailInput = document.getElementById("email");
             contactInput = document.getElementById("contact");
             reviewerNumberInput = document.getElementById("reviewer-number");
             reviewerNameInput = document.getElementById("reviewer-name");
             witness2NumberInput = document.getElementById("employee-number-2");
             witness2NameInput = document.getElementById("employee-name-2");
             witness2PosInput = document.getElementById("position-2");
             witness3NumberInput = document.getElementById("employee-number-3");
             witness3NameInput = document.getElementById("employee-name-3");
             witness3PosInput = document.getElementById("position-3");
             hodNumberInput = document.getElementById("hod-number");
             hodNameInput = document.getElementById("hod-name");
             hodPosInput = document.getElementById("hod-position");
             metricsContainer = document.getElementById("performance-metrics");
             overallPerformanceText = document.getElementById("overall-performance");
             loginMessageElement = document.getElementById('login-message');
             loginContainerElement = document.getElementById('login-container');
             welcomeMessageContainerElement = document.getElementById('welcome-message-container');
             passwordInputElement = document.getElementById('password');
             usernameInputElement = document.getElementById('username');
             evaluationPageElement = document.getElementById('evaluation-page');
             evaluationFormContainerElement = document.getElementById('evaluation-form-container');
             welcomePageElement = document.getElementById('welcome-page');


             // Check if essential elements exist before adding listeners
             if (!employeeNumberInput || !reviewerNumberInput || !witness2NumberInput || !witness3NumberInput || !hodNumberInput || !passwordInputElement || !usernameInputElement || !metricsContainer) {
                console.error("CRITICAL ERROR: One or more essential input elements not found. Event listeners cannot be attached.");
                alert("Initialization Error: Could not find essential form elements. Please check the HTML structure.");
                return; // Prevent adding listeners to null elements
             }


            // Employee Number Input Handling
            employeeNumberInput.addEventListener("input", function() {
                this.value = this.value.replace(/[^0-9]/g, ''); // Filter non-digits
                clearTimeout(empLookupTimeout); // Clear pending lookup on new input
                if (this.value.length === 0) {
                    clearEmployeeFields(); // Clear details if input is emptied
                }
                // DO NOT trigger lookup here, wait for keyup/blur
            });

            employeeNumberInput.addEventListener("keyup", function(event) {
                clearTimeout(empLookupTimeout); // Clear previous timeout
                const empNumber = this.value.trim();
                const length = empNumber.length;

                if (length === 3 || length === 6) {
                    // Set timeout to perform lookup after user pauses typing
                    console.log(`Setting ${LOOKUP_DELAY}ms timeout for Employee lookup: ${empNumber}`);
                    empLookupTimeout = setTimeout(() => {
                        populateEmployeeDetails(empNumber);
                    }, LOOKUP_DELAY);
                }
            });

            employeeNumberInput.addEventListener("blur", function() {
                clearTimeout(empLookupTimeout); // Clear any pending timeout from keyup
                const empNumber = this.value.trim();
                const length = empNumber.length;

                if (length === 3 || length === 6) {
                    console.log(`Performing immediate Employee lookup on blur: ${empNumber}`);
                    populateEmployeeDetails(empNumber); // Perform lookup immediately on blur
                } else if (length > 0) {
                    console.log(`Invalid Employee No length (${length}) on blur.`);
                    alert("Employee number must be 3 or 6 digits.");
                    clearEmployeeFields(); // Clear associated fields
                } else {
                    clearEmployeeFields(); // Ensure fields are clear if empty on blur
                }
            });

            // Reviewer Input Handling
            reviewerNumberInput.addEventListener("input", function() {
                 this.value = this.value.replace(/[^0-9]/g, '');
                 clearTimeout(reviewerLookupTimeout);
                 if (this.value.length === 0 || this.value.length < 6) { clearReviewerFields(); }
             });
            reviewerNumberInput.addEventListener("keyup", function(event) {
                 clearTimeout(reviewerLookupTimeout);
                 const reviewerNumber = this.value.trim();
                 if (reviewerNumber.length === 6) {
                     console.log(`Setting ${LOOKUP_DELAY}ms timeout for Reviewer lookup: ${reviewerNumber}`);
                     reviewerLookupTimeout = setTimeout(() => {
                         populateReviewerDetails(reviewerNumber);
                     }, LOOKUP_DELAY);
                 }
             });
            reviewerNumberInput.addEventListener("blur", function() {
                 clearTimeout(reviewerLookupTimeout);
                 const reviewerNumber = this.value.trim();
                 if (reviewerNumber.length === 6) {
                     console.log(`Performing immediate Reviewer lookup on blur: ${reviewerNumber}`);
                     populateReviewerDetails(reviewerNumber);
                 } else if (reviewerNumber.length > 0) {
                     alert("Reviewer ID must be 6 digits.");
                     clearReviewerFields();
                 } else {
                     clearReviewerFields();
                 }
             });

            // Witness 1 Input Handling
            witness2NumberInput.addEventListener("input", function() {
                 this.value = this.value.replace(/[^0-9]/g, '');
                 clearTimeout(witness2LookupTimeout);
                  if (this.value.length === 0 || this.value.length < 6) { clearWitness2Fields(); }
             });
            witness2NumberInput.addEventListener("keyup", function(event) {
                 clearTimeout(witness2LookupTimeout);
                 const witnessNumber = this.value.trim();
                 if (witnessNumber.length === 6) {
                     console.log(`Setting ${LOOKUP_DELAY}ms timeout for Witness 1 lookup: ${witnessNumber}`);
                     witness2LookupTimeout = setTimeout(() => {
                         populateSignatureDetails(witnessNumber, 'employee-number-2', "employee-name-2", "position-2");
                     }, LOOKUP_DELAY);
                 }
             });
            witness2NumberInput.addEventListener("blur", function() {
                 clearTimeout(witness2LookupTimeout);
                 const witnessNumber = this.value.trim();
                 if (witnessNumber.length === 6) {
                     console.log(`Performing immediate Witness 1 lookup on blur: ${witnessNumber}`);
                     populateSignatureDetails(witnessNumber, 'employee-number-2', "employee-name-2", "position-2");
                 } else if (witnessNumber.length > 0) {
                     alert("Witness 1 ID must be 6 digits.");
                     clearWitness2Fields();
                 } else {
                     clearWitness2Fields();
                 }
             });

            // Witness 2 Input Handling
            witness3NumberInput.addEventListener("input", function() {
                 this.value = this.value.replace(/[^0-9]/g, '');
                 clearTimeout(witness3LookupTimeout);
                  if (this.value.length === 0 || this.value.length < 6) { clearWitness3Fields(); }
             });
            witness3NumberInput.addEventListener("keyup", function(event) {
                 clearTimeout(witness3LookupTimeout);
                 const witnessNumber = this.value.trim();
                 if (witnessNumber.length === 6) {
                    console.log(`Setting ${LOOKUP_DELAY}ms timeout for Witness 2 lookup: ${witnessNumber}`);
                     witness3LookupTimeout = setTimeout(() => {
                         populateSignatureDetails(witnessNumber, 'employee-number-3', "employee-name-3", "position-3");
                     }, LOOKUP_DELAY);
                 }
             });
            witness3NumberInput.addEventListener("blur", function() {
                 clearTimeout(witness3LookupTimeout);
                 const witnessNumber = this.value.trim();
                 if (witnessNumber.length === 6) {
                     console.log(`Performing immediate Witness 2 lookup on blur: ${witnessNumber}`);
                     populateSignatureDetails(witnessNumber, 'employee-number-3', "employee-name-3", "position-3");
                 } else if (witnessNumber.length > 0) {
                     alert("Witness 2 ID must be 6 digits.");
                     clearWitness3Fields();
                 } else {
                     clearWitness3Fields();
                 }
             });

            // HOD Input Handling
            hodNumberInput.addEventListener("input", function() {
                 this.value = this.value.replace(/[^0-9]/g, '');
                 clearTimeout(hodLookupTimeout);
                  if (this.value.length === 0 || this.value.length < 6) { clearHODFields(); }
             });
            hodNumberInput.addEventListener("keyup", function(event) {
                 clearTimeout(hodLookupTimeout);
                 const hodNumber = this.value.trim();
                 if (hodNumber.length === 6) {
                     console.log(`Setting ${LOOKUP_DELAY}ms timeout for HOD lookup: ${hodNumber}`);
                     hodLookupTimeout = setTimeout(() => {
                         populateHODDetails(hodNumber);
                     }, LOOKUP_DELAY);
                 }
             });
            hodNumberInput.addEventListener("blur", function() {
                 clearTimeout(hodLookupTimeout);
                 const hodNumber = this.value.trim();
                 if (hodNumber.length === 6) {
                     console.log(`Performing immediate HOD lookup on blur: ${hodNumber}`);
                     populateHODDetails(hodNumber);
                 } else if (hodNumber.length > 0) {
                     alert("HOD ID must be 6 digits.");
                     clearHODFields();
                 } else {
                     clearHODFields();
                 }
             });

             // Login on Enter Key
             const handleLoginEnter = (event) => { if (event.key === 'Enter') { event.preventDefault(); authenticateUser(); } };
             passwordInputElement.addEventListener('keydown', handleLoginEnter);
             usernameInputElement.addEventListener('keydown', handleLoginEnter);

             console.log("Event listeners setup complete.");
        }


        // --- Initial data fetch & DOM Ready ---
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM fully loaded and parsed.");

            // Setup essential event listeners first
            setupEventListeners();

            // Then fetch data
            Promise.all([fetchEmployeeData(), fetchUserData()])
                .then(() => {
                    console.log("Initial data fetch complete (Employee & User).");
                    // Any actions dependent on data being loaded can go here
                })
                .catch(error => {
                    console.error("CRITICAL ERROR during initial data fetch:", error);
                    alert("Critical error loading initial data. Some features might not work. Please refresh.");
                });

            document.body.classList.add('gradient-background'); // Ensure initial background
        });

        // --- Authentication ---
        window.authenticateUser = function() { // Make function globally accessible
             if (!loginMessageElement || !loginContainerElement || !welcomeMessageContainerElement || !usernameInputElement || !passwordInputElement) {
                 console.error("Login elements not found. Cannot authenticate.");
                 alert("Login interface error. Please refresh.");
                 return;
             }

             loginMessageElement.textContent = ''; loginMessageElement.className = '';
             loginMessageElement.style.display = 'none'; // Hide message initially

             if (!userData || userData.length === 0) {
                 loginMessageElement.textContent = "Authentication data unavailable. Please wait or refresh.";
                 loginMessageElement.className = 'error';
                 loginMessageElement.style.display = 'flex'; // Show message
                 // Attempt to fetch user data again if it's missing?
                 fetchUserData().then(() => {
                    if (!userData || userData.length === 0) {
                        loginMessageElement.textContent = "Still unable to load authentication data.";
                    } else {
                         loginMessageElement.textContent = "Auth data loaded. Please try logging in again.";
                         loginMessageElement.className = 'success'; // Or just remove error class
                    }
                 });
                 return;
             }

             const username = usernameInputElement.value;
             const password = passwordInputElement.value;

             if (!username.trim() || !password.trim()) {
                 loginMessageElement.textContent = 'User Name and Password required.';
                 loginMessageElement.className = 'error';
                 loginMessageElement.style.display = 'flex'; // Show message
                 return;
             }

             // Find user - case-sensitive match for User ID
             const user = userData.find(u => u && u['User ID'] === username);

             if (!user) {
                 console.warn(`Login failed: User ID '${username}' not found.`);
                 loginMessageElement.textContent = 'Authorization failed: User not found.';
                 loginMessageElement.className = 'error';
                 loginMessageElement.style.display = 'flex'; // Show message
                 return;
             }

             // Basic password check (replace with hashing in a real application!)
             // Ensure the 'Password' property name matches your CSV header exactly
             if (user['Password'] === password) {
                 console.log(`Login successful for user: ${username}`);
                 loginMessageElement.textContent = 'Login successful!';
                 loginMessageElement.className = 'success';
                 loginMessageElement.style.display = 'flex'; // Show message
                 setTimeout(showWelcomeMessage, 600); // Proceed after showing success
             } else {
                 console.warn(`Login failed: Incorrect password for user: ${username}`);
                 loginMessageElement.textContent = 'Password incorrect.';
                 loginMessageElement.className = 'error';
                 loginMessageElement.style.display = 'flex'; // Show message
             }
         }

        function showWelcomeMessage() {
            if (loginContainerElement) loginContainerElement.style.display = 'none';
            if (loginMessageElement) loginMessageElement.style.display = 'none'; // Hide login message
            if (welcomeMessageContainerElement) welcomeMessageContainerElement.style.display = 'flex';
            document.querySelectorAll('.background-panel').forEach(p => p.style.display = 'none');
            document.body.classList.add('gradient-background');
            window.scrollTo(0, 0);
        }

    </script>

</body>
</html>
